Loaded module: cuda/12.0
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:  17%|█▋        | 2887/17100 [00:00<00:00, 28861.63it/s]Loading Data:  35%|███▌      | 6019/17100 [00:00<00:00, 30304.69it/s]Loading Data:  53%|█████▎    | 9139/17100 [00:00<00:00, 30712.07it/s]Loading Data:  72%|███████▏  | 12237/17100 [00:00<00:00, 30816.51it/s]Loading Data:  90%|████████▉ | 15337/17100 [00:00<00:00, 30879.05it/s]Loading Data: 100%|██████████| 17100/17100 [00:00<00:00, 30702.42it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 30487.07it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3055/17098 [00:00<00:00, 30541.15it/s]Loading Data:  36%|███▌      | 6110/17098 [00:00<00:00, 30518.08it/s]Loading Data:  54%|█████▍    | 9197/17098 [00:00<00:00, 30674.73it/s]Loading Data:  72%|███████▏  | 12280/17098 [00:00<00:00, 30734.33it/s]Loading Data:  90%|████████▉ | 15354/17098 [00:00<00:00, 30676.22it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30676.84it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:17,  2.45it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:06,  6.10it/s]Test-loop:  11%|█         | 5/45 [00:00<00:04,  8.49it/s]Test-loop:  16%|█▌        | 7/45 [00:00<00:03, 10.22it/s]Test-loop:  20%|██        | 9/45 [00:00<00:03, 11.39it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:02, 12.50it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 13.32it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 13.90it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:01, 14.32it/s]Test-loop:  42%|████▏     | 19/45 [00:01<00:01, 14.43it/s]Test-loop:  47%|████▋     | 21/45 [00:01<00:01, 14.33it/s]Test-loop:  51%|█████     | 23/45 [00:01<00:01, 14.13it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 13.93it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 13.84it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 13.84it/s]Test-loop:  69%|██████▉   | 31/45 [00:02<00:01, 13.86it/s]Test-loop:  73%|███████▎  | 33/45 [00:02<00:00, 13.90it/s]Test-loop:  78%|███████▊  | 35/45 [00:02<00:00, 13.99it/s]Test-loop:  82%|████████▏ | 37/45 [00:02<00:00, 14.05it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 14.18it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 13.98it/s]Test-loop:  96%|█████████▌| 43/45 [00:03<00:00, 14.07it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 14.60it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 12.69it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<01:48,  2.46it/s]Test-loop:   1%|          | 3/268 [00:00<00:42,  6.20it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:30,  8.54it/s]Test-loop:   3%|▎         | 7/268 [00:00<00:26,  9.86it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:24, 10.69it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:22, 11.48it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:21, 12.10it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:20, 12.48it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:19, 12.75it/s]Test-loop:   7%|▋         | 19/268 [00:01<00:19, 12.97it/s]Test-loop:   8%|▊         | 21/268 [00:01<00:18, 13.05it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:18, 13.23it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:18, 13.43it/s]Test-loop:  10%|█         | 27/268 [00:02<00:17, 13.44it/s]Test-loop:  11%|█         | 29/268 [00:02<00:17, 13.59it/s]Test-loop:  12%|█▏        | 31/268 [00:02<00:17, 13.69it/s]Test-loop:  12%|█▏        | 33/268 [00:02<00:17, 13.76it/s]Test-loop:  13%|█▎        | 35/268 [00:02<00:17, 13.63it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:16, 13.61it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:16, 13.62it/s]Test-loop:  15%|█▌        | 41/268 [00:03<00:16, 13.82it/s]Test-loop:  16%|█▌        | 43/268 [00:03<00:16, 14.01it/s]Test-loop:  17%|█▋        | 45/268 [00:03<00:15, 13.96it/s]Test-loop:  18%|█▊        | 47/268 [00:03<00:15, 13.87it/s]Test-loop:  18%|█▊        | 49/268 [00:03<00:15, 13.97it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:15, 13.96it/s]Test-loop:  20%|█▉        | 53/268 [00:04<00:15, 14.13it/s]Test-loop:  21%|██        | 55/268 [00:04<00:15, 14.01it/s]Test-loop:  21%|██▏       | 57/268 [00:04<00:15, 14.00it/s]Test-loop:  22%|██▏       | 59/268 [00:04<00:15, 13.89it/s]Test-loop:  23%|██▎       | 61/268 [00:04<00:14, 13.82it/s]Test-loop:  24%|██▎       | 63/268 [00:04<00:14, 13.70it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:14, 13.81it/s]Test-loop:  25%|██▌       | 67/268 [00:05<00:14, 13.59it/s]Test-loop:  26%|██▌       | 69/268 [00:05<00:14, 13.53it/s]Test-loop:  26%|██▋       | 71/268 [00:05<00:14, 13.62it/s]Test-loop:  27%|██▋       | 73/268 [00:05<00:14, 13.83it/s]Test-loop:  28%|██▊       | 75/268 [00:05<00:13, 13.90it/s]Test-loop:  29%|██▊       | 77/268 [00:05<00:14, 13.62it/s]Test-loop:  29%|██▉       | 79/268 [00:06<00:13, 13.79it/s]Test-loop:  30%|███       | 81/268 [00:06<00:13, 13.71it/s]Test-loop:  31%|███       | 83/268 [00:06<00:13, 13.45it/s]Test-loop:  32%|███▏      | 85/268 [00:06<00:13, 13.44it/s]Test-loop:  32%|███▏      | 87/268 [00:06<00:13, 13.30it/s]Test-loop:  33%|███▎      | 89/268 [00:06<00:13, 13.26it/s]Test-loop:  34%|███▍      | 91/268 [00:07<00:13, 13.19it/s]Test-loop:  35%|███▍      | 93/268 [00:07<00:12, 13.68it/s]Test-loop:  35%|███▌      | 95/268 [00:07<00:12, 14.13it/s]Test-loop:  36%|███▌      | 97/268 [00:07<00:11, 14.45it/s]Test-loop:  37%|███▋      | 99/268 [00:07<00:11, 14.69it/s]Test-loop:  38%|███▊      | 101/268 [00:07<00:11, 14.86it/s]Test-loop:  38%|███▊      | 103/268 [00:07<00:11, 14.98it/s]Test-loop:  39%|███▉      | 105/268 [00:07<00:10, 15.07it/s]Test-loop:  40%|███▉      | 107/268 [00:08<00:10, 15.13it/s]Test-loop:  41%|████      | 109/268 [00:08<00:10, 15.19it/s]Test-loop:  41%|████▏     | 111/268 [00:08<00:10, 15.22it/s]Test-loop:  42%|████▏     | 113/268 [00:08<00:10, 15.22it/s]Test-loop:  43%|████▎     | 115/268 [00:08<00:10, 15.25it/s]Test-loop:  44%|████▎     | 117/268 [00:08<00:09, 15.24it/s]Test-loop:  44%|████▍     | 119/268 [00:08<00:09, 15.25it/s]Test-loop:  45%|████▌     | 121/268 [00:09<00:09, 15.26it/s]Test-loop:  46%|████▌     | 123/268 [00:09<00:09, 15.25it/s]Test-loop:  47%|████▋     | 125/268 [00:09<00:09, 15.26it/s]Test-loop:  47%|████▋     | 127/268 [00:09<00:09, 15.26it/s]Test-loop:  48%|████▊     | 129/268 [00:09<00:09, 15.27it/s]Test-loop:  49%|████▉     | 131/268 [00:09<00:08, 15.28it/s]Test-loop:  50%|████▉     | 133/268 [00:09<00:08, 15.28it/s]Test-loop:  50%|█████     | 135/268 [00:09<00:08, 15.27it/s]Test-loop:  51%|█████     | 137/268 [00:10<00:08, 15.27it/s]Test-loop:  52%|█████▏    | 139/268 [00:10<00:08, 15.27it/s]Test-loop:  53%|█████▎    | 141/268 [00:10<00:08, 15.27it/s]Test-loop:  53%|█████▎    | 143/268 [00:10<00:08, 15.26it/s]Test-loop:  54%|█████▍    | 145/268 [00:10<00:08, 15.26it/s]Test-loop:  55%|█████▍    | 147/268 [00:10<00:07, 15.25it/s]Test-loop:  56%|█████▌    | 149/268 [00:10<00:07, 15.25it/s]Test-loop:  56%|█████▋    | 151/268 [00:10<00:07, 15.26it/s]Test-loop:  57%|█████▋    | 153/268 [00:11<00:07, 15.26it/s]Test-loop:  58%|█████▊    | 155/268 [00:11<00:07, 15.27it/s]Test-loop:  59%|█████▊    | 157/268 [00:11<00:07, 15.16it/s]Test-loop:  59%|█████▉    | 159/268 [00:11<00:07, 14.87it/s]Test-loop:  60%|██████    | 161/268 [00:11<00:07, 14.56it/s]Test-loop:  61%|██████    | 163/268 [00:11<00:07, 14.22it/s]Test-loop:  62%|██████▏   | 165/268 [00:11<00:07, 13.93it/s]Test-loop:  62%|██████▏   | 167/268 [00:12<00:07, 13.68it/s]Test-loop:  63%|██████▎   | 169/268 [00:12<00:07, 13.67it/s]Test-loop:  64%|██████▍   | 171/268 [00:12<00:07, 13.59it/s]Test-loop:  65%|██████▍   | 173/268 [00:12<00:06, 13.74it/s]Test-loop:  65%|██████▌   | 175/268 [00:12<00:06, 13.64it/s]Test-loop:  66%|██████▌   | 177/268 [00:12<00:06, 13.69it/s]Test-loop:  67%|██████▋   | 179/268 [00:12<00:06, 13.64it/s]Test-loop:  68%|██████▊   | 181/268 [00:13<00:06, 13.61it/s]Test-loop:  68%|██████▊   | 183/268 [00:13<00:06, 13.84it/s]Test-loop:  69%|██████▉   | 185/268 [00:13<00:06, 13.66it/s]Test-loop:  70%|██████▉   | 187/268 [00:13<00:05, 13.53it/s]Test-loop:  71%|███████   | 189/268 [00:13<00:05, 13.33it/s]Test-loop:  71%|███████▏  | 191/268 [00:13<00:05, 13.24it/s]Test-loop:  72%|███████▏  | 193/268 [00:14<00:05, 13.15it/s]Test-loop:  73%|███████▎  | 195/268 [00:14<00:05, 13.12it/s]Test-loop:  74%|███████▎  | 197/268 [00:14<00:05, 13.37it/s]Test-loop:  74%|███████▍  | 199/268 [00:14<00:05, 13.29it/s]Test-loop:  75%|███████▌  | 201/268 [00:14<00:05, 13.20it/s]Test-loop:  76%|███████▌  | 203/268 [00:14<00:04, 13.33it/s]Test-loop:  76%|███████▋  | 205/268 [00:14<00:04, 13.26it/s]Test-loop:  77%|███████▋  | 207/268 [00:15<00:04, 13.29it/s]Test-loop:  78%|███████▊  | 209/268 [00:15<00:04, 13.23it/s]Test-loop:  79%|███████▊  | 211/268 [00:15<00:04, 13.20it/s]Test-loop:  79%|███████▉  | 213/268 [00:15<00:04, 13.10it/s]Test-loop:  80%|████████  | 215/268 [00:15<00:04, 12.96it/s]Test-loop:  81%|████████  | 217/268 [00:15<00:03, 12.95it/s]Test-loop:  82%|████████▏ | 219/268 [00:16<00:03, 12.87it/s]Test-loop:  82%|████████▏ | 221/268 [00:16<00:03, 12.83it/s]Test-loop:  83%|████████▎ | 223/268 [00:16<00:03, 12.87it/s]Test-loop:  84%|████████▍ | 225/268 [00:16<00:03, 12.80it/s]Test-loop:  85%|████████▍ | 227/268 [00:16<00:03, 13.09it/s]Test-loop:  85%|████████▌ | 229/268 [00:16<00:03, 12.87it/s]Test-loop:  86%|████████▌ | 231/268 [00:16<00:02, 13.05it/s]Test-loop:  87%|████████▋ | 233/268 [00:17<00:02, 13.10it/s]Test-loop:  88%|████████▊ | 235/268 [00:17<00:02, 13.39it/s]Test-loop:  88%|████████▊ | 237/268 [00:17<00:02, 13.89it/s]Test-loop:  89%|████████▉ | 239/268 [00:17<00:02, 14.05it/s]Test-loop:  90%|████████▉ | 241/268 [00:17<00:01, 14.18it/s]Test-loop:  91%|█████████ | 243/268 [00:17<00:01, 14.43it/s]Test-loop:  91%|█████████▏| 245/268 [00:17<00:01, 14.26it/s]Test-loop:  92%|█████████▏| 247/268 [00:18<00:01, 14.03it/s]Test-loop:  93%|█████████▎| 249/268 [00:18<00:01, 13.80it/s]Test-loop:  94%|█████████▎| 251/268 [00:18<00:01, 13.97it/s]Test-loop:  94%|█████████▍| 253/268 [00:18<00:01, 13.94it/s]Test-loop:  95%|█████████▌| 255/268 [00:18<00:00, 13.98it/s]Test-loop:  96%|█████████▌| 257/268 [00:18<00:00, 13.81it/s]Test-loop:  97%|█████████▋| 259/268 [00:18<00:00, 13.88it/s]Test-loop:  97%|█████████▋| 261/268 [00:19<00:00, 14.11it/s]Test-loop:  98%|█████████▊| 263/268 [00:19<00:00, 13.82it/s]Test-loop:  99%|█████████▉| 265/268 [00:19<00:00, 13.64it/s]Test-loop: 100%|█████████▉| 267/268 [00:19<00:00, 13.43it/s]Test-loop: 100%|██████████| 268/268 [00:19<00:00, 13.65it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:12,  2.02it/s]Test-loop:   1%|          | 3/268 [00:00<00:54,  4.87it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:42,  6.22it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:37,  6.94it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:34,  7.59it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:32,  7.99it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:30,  8.43it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:29,  8.71it/s]Test-loop:   6%|▌         | 16/268 [00:02<00:29,  8.50it/s]Test-loop:   7%|▋         | 18/268 [00:02<00:29,  8.52it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:29,  8.49it/s]Test-loop:   7%|▋         | 20/268 [00:02<00:29,  8.48it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:28,  8.61it/s]Test-loop:   8%|▊         | 22/268 [00:02<00:29,  8.41it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:29,  8.38it/s]Test-loop:   9%|▉         | 24/268 [00:03<00:28,  8.43it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:30,  8.07it/s]Test-loop:  10%|▉         | 26/268 [00:03<00:28,  8.42it/s]Test-loop:  10%|█         | 27/268 [00:03<00:29,  8.18it/s]Test-loop:  11%|█         | 29/268 [00:03<00:28,  8.40it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:27,  8.77it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:26,  8.79it/s]Test-loop:  13%|█▎        | 34/268 [00:04<00:26,  8.94it/s]Test-loop:  13%|█▎        | 35/268 [00:04<00:25,  9.10it/s]Test-loop:  13%|█▎        | 36/268 [00:04<00:25,  9.13it/s]Test-loop:  14%|█▍        | 37/268 [00:04<00:25,  9.05it/s]Test-loop:  14%|█▍        | 38/268 [00:04<00:25,  8.86it/s]Test-loop:  15%|█▍        | 39/268 [00:04<00:26,  8.63it/s]Test-loop:  15%|█▍        | 40/268 [00:04<00:25,  8.79it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:27,  8.39it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:26,  8.40it/s]Test-loop:  16%|█▋        | 44/268 [00:05<00:25,  8.63it/s]Test-loop:  17%|█▋        | 45/268 [00:05<00:26,  8.26it/s]Test-loop:  18%|█▊        | 47/268 [00:05<00:25,  8.53it/s]Test-loop:  18%|█▊        | 48/268 [00:05<00:26,  8.38it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:25,  8.70it/s]Test-loop:  19%|█▊        | 50/268 [00:06<00:26,  8.09it/s]Test-loop:  19%|█▉        | 52/268 [00:06<00:26,  8.26it/s]Test-loop:  20%|█▉        | 53/268 [00:06<00:24,  8.61it/s]Test-loop:  20%|██        | 54/268 [00:06<00:26,  8.23it/s]Test-loop:  21%|██        | 55/268 [00:06<00:25,  8.21it/s]Test-loop:  21%|██        | 56/268 [00:06<00:24,  8.60it/s]Test-loop:  21%|██▏       | 57/268 [00:06<00:24,  8.48it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:23,  8.80it/s]Test-loop:  22%|██▏       | 60/268 [00:07<00:23,  8.80it/s]Test-loop:  23%|██▎       | 61/268 [00:07<00:23,  9.00it/s]Test-loop:  23%|██▎       | 62/268 [00:07<00:24,  8.53it/s]Test-loop:  24%|██▍       | 64/268 [00:07<00:23,  8.50it/s]Test-loop:  25%|██▍       | 66/268 [00:08<00:23,  8.63it/s]Test-loop:  25%|██▌       | 68/268 [00:08<00:23,  8.69it/s]Test-loop:  26%|██▌       | 70/268 [00:08<00:22,  8.65it/s]Test-loop:  27%|██▋       | 72/268 [00:08<00:21,  9.00it/s]Test-loop:  27%|██▋       | 73/268 [00:08<00:21,  8.87it/s]Test-loop:  28%|██▊       | 74/268 [00:08<00:21,  9.00it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:21,  8.90it/s]Test-loop:  28%|██▊       | 76/268 [00:09<00:21,  9.01it/s]Test-loop:  29%|██▊       | 77/268 [00:09<00:22,  8.49it/s]Test-loop:  29%|██▉       | 78/268 [00:09<00:21,  8.73it/s]Test-loop:  29%|██▉       | 79/268 [00:09<00:22,  8.25it/s]Test-loop:  30%|███       | 81/268 [00:09<00:21,  8.57it/s]Test-loop:  31%|███       | 83/268 [00:09<00:21,  8.50it/s]Test-loop:  32%|███▏      | 85/268 [00:10<00:20,  8.79it/s]Test-loop:  32%|███▏      | 87/268 [00:10<00:20,  8.89it/s]Test-loop:  33%|███▎      | 89/268 [00:10<00:20,  8.84it/s]Test-loop:  34%|███▍      | 91/268 [00:10<00:20,  8.85it/s]Test-loop:  35%|███▍      | 93/268 [00:11<00:19,  8.96it/s]Test-loop:  35%|███▌      | 95/268 [00:11<00:19,  8.87it/s]Test-loop:  36%|███▌      | 97/268 [00:11<00:20,  8.49it/s]Test-loop:  37%|███▋      | 99/268 [00:11<00:19,  8.65it/s]Test-loop:  38%|███▊      | 101/268 [00:11<00:18,  8.92it/s]Test-loop:  38%|███▊      | 103/268 [00:12<00:18,  8.92it/s]Test-loop:  39%|███▉      | 105/268 [00:12<00:18,  8.73it/s]Test-loop:  40%|███▉      | 107/268 [00:12<00:18,  8.92it/s]Test-loop:  41%|████      | 109/268 [00:12<00:17,  8.89it/s]Test-loop:  41%|████▏     | 111/268 [00:13<00:18,  8.69it/s]Test-loop:  42%|████▏     | 113/268 [00:13<00:17,  8.82it/s]Test-loop:  43%|████▎     | 115/268 [00:13<00:17,  8.75it/s]Test-loop:  44%|████▎     | 117/268 [00:13<00:17,  8.72it/s]Test-loop:  44%|████▍     | 119/268 [00:14<00:17,  8.66it/s]Test-loop:  45%|████▌     | 121/268 [00:14<00:16,  9.08it/s]Test-loop:  46%|████▌     | 123/268 [00:14<00:15,  9.38it/s]Test-loop:  47%|████▋     | 125/268 [00:14<00:15,  9.13it/s]Test-loop:  47%|████▋     | 127/268 [00:14<00:15,  9.00it/s]Test-loop:  48%|████▊     | 129/268 [00:15<00:15,  9.19it/s]Test-loop:  49%|████▉     | 131/268 [00:15<00:15,  8.91it/s]Test-loop:  50%|████▉     | 133/268 [00:15<00:15,  8.77it/s]Test-loop:  50%|█████     | 135/268 [00:15<00:14,  8.96it/s]Test-loop:  51%|█████     | 137/268 [00:16<00:14,  8.81it/s]Test-loop:  52%|█████▏    | 139/268 [00:16<00:14,  8.84it/s]Test-loop:  53%|█████▎    | 141/268 [00:16<00:14,  8.85it/s]Test-loop:  53%|█████▎    | 143/268 [00:16<00:14,  8.92it/s]Test-loop:  54%|█████▍    | 145/268 [00:16<00:13,  9.12it/s]Test-loop:  55%|█████▍    | 147/268 [00:17<00:13,  9.10it/s]Test-loop:  56%|█████▌    | 149/268 [00:17<00:13,  8.98it/s]Test-loop:  56%|█████▋    | 151/268 [00:17<00:13,  8.99it/s]Test-loop:  57%|█████▋    | 153/268 [00:17<00:12,  9.27it/s]Test-loop:  57%|█████▋    | 154/268 [00:17<00:12,  9.25it/s]Test-loop:  58%|█████▊    | 155/268 [00:18<00:12,  9.19it/s]Test-loop:  58%|█████▊    | 156/268 [00:18<00:12,  8.93it/s]Test-loop:  59%|█████▊    | 157/268 [00:18<00:12,  8.80it/s]Test-loop:  59%|█████▉    | 158/268 [00:18<00:12,  8.86it/s]Test-loop:  59%|█████▉    | 159/268 [00:18<00:12,  9.06it/s]Test-loop:  60%|█████▉    | 160/268 [00:18<00:12,  8.97it/s]Test-loop:  60%|██████    | 161/268 [00:18<00:11,  9.04it/s]Test-loop:  60%|██████    | 162/268 [00:18<00:11,  8.86it/s]Test-loop:  61%|██████    | 163/268 [00:18<00:11,  8.84it/s]Test-loop:  61%|██████    | 164/268 [00:19<00:12,  8.57it/s]Test-loop:  62%|██████▏   | 166/268 [00:19<00:11,  8.85it/s]Test-loop:  62%|██████▏   | 167/268 [00:19<00:11,  8.88it/s]Test-loop:  63%|██████▎   | 168/268 [00:19<00:11,  9.03it/s]Test-loop:  63%|██████▎   | 169/268 [00:19<00:11,  8.62it/s]Test-loop:  64%|██████▍   | 171/268 [00:19<00:11,  8.54it/s]Test-loop:  65%|██████▍   | 173/268 [00:20<00:11,  8.52it/s]Test-loop:  65%|██████▌   | 175/268 [00:20<00:10,  8.56it/s]Test-loop:  66%|██████▌   | 177/268 [00:20<00:10,  8.66it/s]Test-loop:  67%|██████▋   | 179/268 [00:20<00:10,  8.57it/s]Test-loop:  68%|██████▊   | 181/268 [00:20<00:09,  8.85it/s]Test-loop:  68%|██████▊   | 183/268 [00:21<00:10,  8.50it/s]Test-loop:  69%|██████▉   | 185/268 [00:21<00:09,  8.69it/s]Test-loop:  70%|██████▉   | 187/268 [00:21<00:09,  8.65it/s]Test-loop:  71%|███████   | 189/268 [00:21<00:08,  8.79it/s]Test-loop:  71%|███████▏  | 191/268 [00:22<00:08,  8.78it/s]Test-loop:  72%|███████▏  | 192/268 [00:22<00:08,  8.97it/s]Test-loop:  72%|███████▏  | 193/268 [00:22<00:08,  8.74it/s]Test-loop:  72%|███████▏  | 194/268 [00:22<00:08,  8.96it/s]Test-loop:  73%|███████▎  | 195/268 [00:22<00:08,  8.83it/s]Test-loop:  73%|███████▎  | 196/268 [00:22<00:08,  8.65it/s]Test-loop:  74%|███████▎  | 197/268 [00:22<00:07,  8.94it/s]Test-loop:  74%|███████▍  | 198/268 [00:22<00:08,  8.49it/s]Test-loop:  75%|███████▍  | 200/268 [00:23<00:07,  8.76it/s]Test-loop:  75%|███████▌  | 201/268 [00:23<00:07,  9.01it/s]Test-loop:  75%|███████▌  | 202/268 [00:23<00:07,  8.83it/s]Test-loop:  76%|███████▌  | 203/268 [00:23<00:07,  9.07it/s]Test-loop:  76%|███████▌  | 204/268 [00:23<00:07,  8.75it/s]Test-loop:  77%|███████▋  | 206/268 [00:23<00:06,  9.19it/s]Test-loop:  78%|███████▊  | 208/268 [00:24<00:06,  9.28it/s]Test-loop:  78%|███████▊  | 210/268 [00:24<00:06,  9.27it/s]Test-loop:  79%|███████▉  | 212/268 [00:24<00:05,  9.48it/s]Test-loop:  80%|███████▉  | 214/268 [00:24<00:05,  9.39it/s]Test-loop:  81%|████████  | 216/268 [00:24<00:05,  9.30it/s]Test-loop:  81%|████████▏ | 218/268 [00:25<00:05,  9.08it/s]Test-loop:  82%|████████▏ | 220/268 [00:25<00:05,  9.22it/s]Test-loop:  83%|████████▎ | 222/268 [00:25<00:05,  8.91it/s]Test-loop:  84%|████████▎ | 224/268 [00:25<00:04,  8.91it/s]Test-loop:  84%|████████▍ | 226/268 [00:26<00:04,  9.12it/s]Test-loop:  85%|████████▌ | 228/268 [00:26<00:04,  9.07it/s]Test-loop:  86%|████████▌ | 230/268 [00:26<00:04,  9.04it/s]Test-loop:  86%|████████▌ | 231/268 [00:26<00:04,  9.01it/s]Test-loop:  87%|████████▋ | 232/268 [00:26<00:04,  8.88it/s]Test-loop:  87%|████████▋ | 233/268 [00:26<00:03,  8.88it/s]Test-loop:  87%|████████▋ | 234/268 [00:26<00:03,  8.90it/s]Test-loop:  88%|████████▊ | 235/268 [00:27<00:03,  8.95it/s]Test-loop:  88%|████████▊ | 236/268 [00:27<00:03,  9.08it/s]Test-loop:  88%|████████▊ | 237/268 [00:27<00:03,  9.11it/s]Test-loop:  89%|████████▉ | 238/268 [00:27<00:03,  9.08it/s]Test-loop:  89%|████████▉ | 239/268 [00:27<00:03,  9.05it/s]Test-loop:  90%|████████▉ | 240/268 [00:27<00:03,  9.19it/s]Test-loop:  90%|████████▉ | 241/268 [00:27<00:03,  8.93it/s]Test-loop:  91%|█████████ | 243/268 [00:27<00:02,  8.97it/s]Test-loop:  91%|█████████▏| 245/268 [00:28<00:02,  9.00it/s]Test-loop:  92%|█████████▏| 247/268 [00:28<00:02,  8.90it/s]Test-loop:  93%|█████████▎| 249/268 [00:28<00:02,  9.04it/s]Test-loop:  94%|█████████▎| 251/268 [00:28<00:01,  8.94it/s]Test-loop:  94%|█████████▍| 253/268 [00:29<00:01,  8.72it/s]Test-loop:  95%|█████████▌| 255/268 [00:29<00:01,  8.76it/s]Test-loop:  96%|█████████▌| 257/268 [00:29<00:01,  8.61it/s]Test-loop:  97%|█████████▋| 259/268 [00:29<00:01,  8.61it/s]Test-loop:  97%|█████████▋| 261/268 [00:29<00:00,  8.69it/s]Test-loop:  98%|█████████▊| 263/268 [00:30<00:00,  8.72it/s]Test-loop:  99%|█████████▉| 265/268 [00:30<00:00,  8.78it/s]Test-loop: 100%|█████████▉| 267/268 [00:30<00:00,  8.84it/s]Test-loop: 100%|██████████| 268/268 [00:30<00:00,  8.72it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:  17%|█▋        | 2937/17100 [00:00<00:00, 29357.50it/s]Loading Data:  35%|███▍      | 5916/17100 [00:00<00:00, 29608.56it/s]Loading Data:  52%|█████▏    | 8894/17100 [00:00<00:00, 29685.97it/s]Loading Data:  69%|██████▉   | 11863/17100 [00:00<00:00, 29667.19it/s]Loading Data:  87%|████████▋ | 14855/17100 [00:00<00:00, 29757.63it/s]Loading Data: 100%|██████████| 17100/17100 [00:00<00:00, 29730.72it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 29658.86it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  17%|█▋        | 2957/17098 [00:00<00:00, 29563.05it/s]Loading Data:  35%|███▍      | 5965/17098 [00:00<00:00, 29863.48it/s]Loading Data:  53%|█████▎    | 8981/17098 [00:00<00:00, 29998.22it/s]Loading Data:  70%|███████   | 12005/17098 [00:00<00:00, 30091.67it/s]Loading Data:  88%|████████▊ | 15015/17098 [00:00<00:00, 30060.13it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30036.04it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:22,  1.96it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:08,  5.10it/s]Test-loop:  11%|█         | 5/45 [00:00<00:05,  7.19it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.89it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03, 10.00it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.76it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 11.30it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.70it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 12.04it/s]Test-loop:  42%|████▏     | 19/45 [00:01<00:02, 12.15it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 12.18it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 12.46it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.70it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 12.86it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 12.75it/s]Test-loop:  69%|██████▉   | 31/45 [00:02<00:01, 12.76it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.80it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.77it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 12.96it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 13.07it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 13.17it/s]Test-loop:  96%|█████████▌| 43/45 [00:03<00:00, 12.96it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 13.74it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 11.28it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:11,  2.03it/s]Test-loop:   1%|          | 3/268 [00:00<00:50,  5.24it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:35,  7.33it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:29,  8.71it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:26,  9.66it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:24, 10.44it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:23, 11.05it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:21, 11.52it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:21, 11.72it/s]Test-loop:   7%|▋         | 19/268 [00:01<00:20, 11.90it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:20, 12.12it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:19, 12.50it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:18, 13.11it/s]Test-loop:  10%|█         | 27/268 [00:02<00:17, 13.54it/s]Test-loop:  11%|█         | 29/268 [00:02<00:17, 13.85it/s]Test-loop:  12%|█▏        | 31/268 [00:02<00:17, 13.57it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:17, 13.19it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:17, 13.00it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:17, 12.93it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:17, 12.96it/s]Test-loop:  15%|█▌        | 41/268 [00:03<00:17, 12.99it/s]Test-loop:  16%|█▌        | 43/268 [00:03<00:17, 13.09it/s]Test-loop:  17%|█▋        | 45/268 [00:03<00:16, 13.14it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:16, 13.30it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:16, 13.19it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:16, 13.33it/s]Test-loop:  20%|█▉        | 53/268 [00:04<00:16, 13.41it/s]Test-loop:  21%|██        | 55/268 [00:04<00:15, 13.82it/s]Test-loop:  21%|██▏       | 57/268 [00:04<00:15, 13.83it/s]Test-loop:  22%|██▏       | 59/268 [00:04<00:15, 13.66it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:15, 13.58it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:15, 13.48it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:15, 13.31it/s]Test-loop:  25%|██▌       | 67/268 [00:05<00:15, 13.28it/s]Test-loop:  26%|██▌       | 69/268 [00:05<00:15, 13.10it/s]Test-loop:  26%|██▋       | 71/268 [00:05<00:15, 12.90it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:15, 12.70it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:15, 12.67it/s]Test-loop:  29%|██▊       | 77/268 [00:06<00:15, 12.71it/s]Test-loop:  29%|██▉       | 79/268 [00:06<00:14, 12.61it/s]Test-loop:  30%|███       | 81/268 [00:06<00:14, 12.68it/s]Test-loop:  31%|███       | 83/268 [00:06<00:14, 12.52it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:14, 12.47it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:14, 12.40it/s]Test-loop:  33%|███▎      | 89/268 [00:07<00:14, 12.57it/s]Test-loop:  34%|███▍      | 91/268 [00:07<00:14, 12.63it/s]Test-loop:  35%|███▍      | 93/268 [00:07<00:13, 12.83it/s]Test-loop:  35%|███▌      | 95/268 [00:07<00:13, 12.86it/s]Test-loop:  36%|███▌      | 97/268 [00:07<00:13, 12.71it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:13, 12.73it/s]Test-loop:  38%|███▊      | 101/268 [00:08<00:13, 12.84it/s]Test-loop:  38%|███▊      | 103/268 [00:08<00:12, 13.02it/s]Test-loop:  39%|███▉      | 105/268 [00:08<00:12, 13.09it/s]Test-loop:  40%|███▉      | 107/268 [00:08<00:12, 13.17it/s]Test-loop:  41%|████      | 109/268 [00:08<00:11, 13.40it/s]Test-loop:  41%|████▏     | 111/268 [00:08<00:11, 13.55it/s]Test-loop:  42%|████▏     | 113/268 [00:09<00:11, 13.35it/s]Test-loop:  43%|████▎     | 115/268 [00:09<00:11, 13.28it/s]Test-loop:  44%|████▎     | 117/268 [00:09<00:11, 13.24it/s]Test-loop:  44%|████▍     | 119/268 [00:09<00:11, 13.30it/s]Test-loop:  45%|████▌     | 121/268 [00:09<00:11, 13.32it/s]Test-loop:  46%|████▌     | 123/268 [00:09<00:10, 13.37it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:10, 13.42it/s]Test-loop:  47%|████▋     | 127/268 [00:10<00:10, 13.41it/s]Test-loop:  48%|████▊     | 129/268 [00:10<00:10, 13.51it/s]Test-loop:  49%|████▉     | 131/268 [00:10<00:10, 13.32it/s]Test-loop:  50%|████▉     | 133/268 [00:10<00:10, 13.22it/s]Test-loop:  50%|█████     | 135/268 [00:10<00:10, 12.95it/s]Test-loop:  51%|█████     | 137/268 [00:10<00:10, 12.91it/s]Test-loop:  52%|█████▏    | 139/268 [00:11<00:09, 12.97it/s]Test-loop:  53%|█████▎    | 141/268 [00:11<00:09, 12.71it/s]Test-loop:  53%|█████▎    | 143/268 [00:11<00:09, 12.57it/s]Test-loop:  54%|█████▍    | 145/268 [00:11<00:09, 12.45it/s]Test-loop:  55%|█████▍    | 147/268 [00:11<00:09, 12.41it/s]Test-loop:  56%|█████▌    | 149/268 [00:11<00:09, 12.36it/s]Test-loop:  56%|█████▋    | 151/268 [00:12<00:09, 12.40it/s]Test-loop:  57%|█████▋    | 153/268 [00:12<00:09, 12.43it/s]Test-loop:  58%|█████▊    | 155/268 [00:12<00:08, 12.71it/s]Test-loop:  59%|█████▊    | 157/268 [00:12<00:08, 12.79it/s]Test-loop:  59%|█████▉    | 159/268 [00:12<00:08, 13.04it/s]Test-loop:  60%|██████    | 161/268 [00:12<00:08, 13.34it/s]Test-loop:  61%|██████    | 163/268 [00:12<00:07, 13.76it/s]Test-loop:  62%|██████▏   | 165/268 [00:13<00:07, 14.08it/s]Test-loop:  62%|██████▏   | 167/268 [00:13<00:07, 13.88it/s]Test-loop:  63%|██████▎   | 169/268 [00:13<00:07, 13.80it/s]Test-loop:  64%|██████▍   | 171/268 [00:13<00:07, 13.56it/s]Test-loop:  65%|██████▍   | 173/268 [00:13<00:07, 13.38it/s]Test-loop:  65%|██████▌   | 175/268 [00:13<00:06, 13.29it/s]Test-loop:  66%|██████▌   | 177/268 [00:14<00:06, 13.62it/s]Test-loop:  67%|██████▋   | 179/268 [00:14<00:06, 13.88it/s]Test-loop:  68%|██████▊   | 181/268 [00:14<00:06, 14.09it/s]Test-loop:  68%|██████▊   | 183/268 [00:14<00:05, 14.40it/s]Test-loop:  69%|██████▉   | 185/268 [00:14<00:05, 14.35it/s]Test-loop:  70%|██████▉   | 187/268 [00:14<00:05, 14.53it/s]Test-loop:  71%|███████   | 189/268 [00:14<00:05, 14.45it/s]Test-loop:  71%|███████▏  | 191/268 [00:14<00:05, 14.16it/s]Test-loop:  72%|███████▏  | 193/268 [00:15<00:05, 13.92it/s]Test-loop:  73%|███████▎  | 195/268 [00:15<00:05, 13.82it/s]Test-loop:  74%|███████▎  | 197/268 [00:15<00:05, 13.69it/s]Test-loop:  74%|███████▍  | 199/268 [00:15<00:05, 13.55it/s]Test-loop:  75%|███████▌  | 201/268 [00:15<00:05, 13.09it/s]Test-loop:  76%|███████▌  | 203/268 [00:15<00:05, 12.98it/s]Test-loop:  76%|███████▋  | 205/268 [00:16<00:04, 12.99it/s]Test-loop:  77%|███████▋  | 207/268 [00:16<00:04, 12.90it/s]Test-loop:  78%|███████▊  | 209/268 [00:16<00:04, 13.20it/s]Test-loop:  79%|███████▊  | 211/268 [00:16<00:04, 12.96it/s]Test-loop:  79%|███████▉  | 213/268 [00:16<00:04, 12.90it/s]Test-loop:  80%|████████  | 215/268 [00:16<00:04, 12.90it/s]Test-loop:  81%|████████  | 217/268 [00:16<00:03, 12.99it/s]Test-loop:  82%|████████▏ | 219/268 [00:17<00:03, 13.06it/s]Test-loop:  82%|████████▏ | 221/268 [00:17<00:03, 13.10it/s]Test-loop:  83%|████████▎ | 223/268 [00:17<00:03, 13.13it/s]Test-loop:  84%|████████▍ | 225/268 [00:17<00:03, 13.21it/s]Test-loop:  85%|████████▍ | 227/268 [00:17<00:03, 13.20it/s]Test-loop:  85%|████████▌ | 229/268 [00:17<00:02, 13.15it/s]Test-loop:  86%|████████▌ | 231/268 [00:18<00:02, 13.14it/s]Test-loop:  87%|████████▋ | 233/268 [00:18<00:02, 13.11it/s]Test-loop:  88%|████████▊ | 235/268 [00:18<00:02, 12.83it/s]Test-loop:  88%|████████▊ | 237/268 [00:18<00:02, 12.97it/s]Test-loop:  89%|████████▉ | 239/268 [00:18<00:02, 13.09it/s]Test-loop:  90%|████████▉ | 241/268 [00:18<00:02, 13.09it/s]Test-loop:  91%|█████████ | 243/268 [00:18<00:01, 13.15it/s]Test-loop:  91%|█████████▏| 245/268 [00:19<00:01, 13.01it/s]Test-loop:  92%|█████████▏| 247/268 [00:19<00:01, 12.91it/s]Test-loop:  93%|█████████▎| 249/268 [00:19<00:01, 12.70it/s]Test-loop:  94%|█████████▎| 251/268 [00:19<00:01, 12.60it/s]Test-loop:  94%|█████████▍| 253/268 [00:19<00:01, 12.61it/s]Test-loop:  95%|█████████▌| 255/268 [00:19<00:01, 12.59it/s]Test-loop:  96%|█████████▌| 257/268 [00:20<00:00, 12.60it/s]Test-loop:  97%|█████████▋| 259/268 [00:20<00:00, 12.53it/s]Test-loop:  97%|█████████▋| 261/268 [00:20<00:00, 12.51it/s]Test-loop:  98%|█████████▊| 263/268 [00:20<00:00, 12.58it/s]Test-loop:  99%|█████████▉| 265/268 [00:20<00:00, 12.50it/s]Test-loop: 100%|█████████▉| 267/268 [00:20<00:00, 12.19it/s]Test-loop: 100%|██████████| 268/268 [00:21<00:00, 12.76it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:43,  1.64it/s]Test-loop:   1%|          | 3/268 [00:00<01:05,  4.03it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:49,  5.36it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:42,  6.20it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:37,  6.88it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:34,  7.43it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:32,  7.84it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:31,  8.07it/s]Test-loop:   6%|▌         | 16/268 [00:02<00:31,  8.06it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:30,  8.27it/s]Test-loop:   7%|▋         | 18/268 [00:02<00:31,  8.05it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:30,  8.09it/s]Test-loop:   7%|▋         | 20/268 [00:02<00:30,  8.02it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:29,  8.30it/s]Test-loop:   8%|▊         | 22/268 [00:03<00:30,  8.10it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:30,  7.94it/s]Test-loop:   9%|▉         | 24/268 [00:03<00:30,  7.90it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:31,  7.63it/s]Test-loop:  10%|▉         | 26/268 [00:03<00:31,  7.76it/s]Test-loop:  10%|█         | 27/268 [00:03<00:31,  7.75it/s]Test-loop:  10%|█         | 28/268 [00:03<00:28,  8.29it/s]Test-loop:  11%|█         | 29/268 [00:04<00:30,  7.90it/s]Test-loop:  11%|█         | 30/268 [00:04<00:28,  8.30it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:29,  8.07it/s]Test-loop:  12%|█▏        | 32/268 [00:04<00:28,  8.25it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:30,  7.80it/s]Test-loop:  13%|█▎        | 34/268 [00:04<00:30,  7.74it/s]Test-loop:  13%|█▎        | 35/268 [00:04<00:29,  7.96it/s]Test-loop:  13%|█▎        | 36/268 [00:04<00:29,  7.90it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:28,  8.11it/s]Test-loop:  14%|█▍        | 38/268 [00:05<00:29,  7.78it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:28,  8.16it/s]Test-loop:  15%|█▍        | 40/268 [00:05<00:27,  8.30it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:27,  8.38it/s]Test-loop:  16%|█▌        | 42/268 [00:05<00:25,  8.74it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:27,  8.33it/s]Test-loop:  16%|█▋        | 44/268 [00:05<00:27,  8.22it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:27,  8.01it/s]Test-loop:  17%|█▋        | 46/268 [00:06<00:27,  8.20it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:27,  8.12it/s]Test-loop:  18%|█▊        | 48/268 [00:06<00:28,  7.79it/s]Test-loop:  19%|█▊        | 50/268 [00:06<00:27,  7.84it/s]Test-loop:  19%|█▉        | 52/268 [00:06<00:27,  7.95it/s]Test-loop:  20%|██        | 54/268 [00:07<00:27,  7.92it/s]Test-loop:  21%|██        | 55/268 [00:07<00:26,  7.98it/s]Test-loop:  21%|██        | 56/268 [00:07<00:26,  8.12it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:26,  8.00it/s]Test-loop:  22%|██▏       | 58/268 [00:07<00:25,  8.23it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:25,  8.19it/s]Test-loop:  22%|██▏       | 60/268 [00:07<00:25,  8.07it/s]Test-loop:  23%|██▎       | 61/268 [00:07<00:25,  8.22it/s]Test-loop:  23%|██▎       | 62/268 [00:08<00:26,  7.81it/s]Test-loop:  24%|██▍       | 64/268 [00:08<00:25,  8.02it/s]Test-loop:  25%|██▍       | 66/268 [00:08<00:24,  8.17it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:23,  8.44it/s]Test-loop:  25%|██▌       | 68/268 [00:08<00:24,  8.06it/s]Test-loop:  26%|██▌       | 69/268 [00:08<00:23,  8.47it/s]Test-loop:  26%|██▌       | 70/268 [00:09<00:25,  7.76it/s]Test-loop:  27%|██▋       | 72/268 [00:09<00:23,  8.19it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:23,  8.42it/s]Test-loop:  28%|██▊       | 74/268 [00:09<00:23,  8.11it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:22,  8.46it/s]Test-loop:  28%|██▊       | 76/268 [00:09<00:23,  8.05it/s]Test-loop:  29%|██▊       | 77/268 [00:09<00:22,  8.30it/s]Test-loop:  29%|██▉       | 78/268 [00:10<00:24,  7.80it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  8.13it/s]Test-loop:  30%|██▉       | 80/268 [00:10<00:23,  7.95it/s]Test-loop:  30%|███       | 81/268 [00:10<00:22,  8.23it/s]Test-loop:  31%|███       | 82/268 [00:10<00:24,  7.73it/s]Test-loop:  31%|███       | 83/268 [00:10<00:23,  8.04it/s]Test-loop:  31%|███▏      | 84/268 [00:10<00:23,  7.95it/s]Test-loop:  32%|███▏      | 85/268 [00:10<00:21,  8.46it/s]Test-loop:  32%|███▏      | 86/268 [00:11<00:23,  7.78it/s]Test-loop:  33%|███▎      | 88/268 [00:11<00:22,  7.88it/s]Test-loop:  34%|███▎      | 90/268 [00:11<00:22,  7.90it/s]Test-loop:  34%|███▍      | 92/268 [00:11<00:21,  8.03it/s]Test-loop:  35%|███▌      | 94/268 [00:12<00:21,  7.93it/s]Test-loop:  36%|███▌      | 96/268 [00:12<00:21,  8.08it/s]Test-loop:  37%|███▋      | 98/268 [00:12<00:21,  8.08it/s]Test-loop:  37%|███▋      | 100/268 [00:12<00:20,  8.12it/s]Test-loop:  38%|███▊      | 102/268 [00:13<00:20,  8.28it/s]Test-loop:  39%|███▉      | 104/268 [00:13<00:19,  8.25it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:19,  8.46it/s]Test-loop:  40%|███▉      | 106/268 [00:13<00:19,  8.41it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:18,  8.67it/s]Test-loop:  40%|████      | 108/268 [00:13<00:20,  7.98it/s]Test-loop:  41%|████      | 110/268 [00:14<00:19,  8.25it/s]Test-loop:  42%|████▏     | 112/268 [00:14<00:19,  7.88it/s]Test-loop:  43%|████▎     | 114/268 [00:14<00:19,  8.00it/s]Test-loop:  43%|████▎     | 116/268 [00:14<00:19,  7.97it/s]Test-loop:  44%|████▍     | 118/268 [00:15<00:18,  7.91it/s]Test-loop:  45%|████▍     | 120/268 [00:15<00:18,  7.90it/s]Test-loop:  46%|████▌     | 122/268 [00:15<00:18,  7.94it/s]Test-loop:  46%|████▋     | 124/268 [00:15<00:17,  8.06it/s]Test-loop:  47%|████▋     | 126/268 [00:16<00:17,  7.93it/s]Test-loop:  48%|████▊     | 128/268 [00:16<00:17,  8.02it/s]Test-loop:  49%|████▊     | 130/268 [00:16<00:16,  8.17it/s]Test-loop:  49%|████▉     | 132/268 [00:16<00:16,  8.24it/s]Test-loop:  50%|█████     | 134/268 [00:16<00:16,  8.32it/s]Test-loop:  51%|█████     | 136/268 [00:17<00:15,  8.28it/s]Test-loop:  51%|█████▏    | 138/268 [00:17<00:15,  8.45it/s]Test-loop:  52%|█████▏    | 140/268 [00:17<00:14,  8.74it/s]Test-loop:  53%|█████▎    | 142/268 [00:17<00:14,  8.67it/s]Test-loop:  54%|█████▎    | 144/268 [00:18<00:14,  8.41it/s]Test-loop:  54%|█████▍    | 146/268 [00:18<00:14,  8.48it/s]Test-loop:  55%|█████▌    | 148/268 [00:18<00:13,  8.67it/s]Test-loop:  56%|█████▌    | 150/268 [00:18<00:13,  8.52it/s]Test-loop:  57%|█████▋    | 152/268 [00:19<00:13,  8.34it/s]Test-loop:  57%|█████▋    | 154/268 [00:19<00:13,  8.26it/s]Test-loop:  58%|█████▊    | 156/268 [00:19<00:13,  8.18it/s]Test-loop:  59%|█████▉    | 158/268 [00:19<00:13,  8.06it/s]Test-loop:  60%|█████▉    | 160/268 [00:20<00:13,  8.09it/s]Test-loop:  60%|██████    | 162/268 [00:20<00:13,  8.15it/s]Test-loop:  61%|██████    | 164/268 [00:20<00:12,  8.03it/s]Test-loop:  62%|██████▏   | 166/268 [00:20<00:12,  8.20it/s]Test-loop:  63%|██████▎   | 168/268 [00:21<00:12,  8.26it/s]Test-loop:  63%|██████▎   | 170/268 [00:21<00:11,  8.30it/s]Test-loop:  64%|██████▍   | 172/268 [00:21<00:11,  8.21it/s]Test-loop:  65%|██████▍   | 174/268 [00:21<00:11,  8.41it/s]Test-loop:  66%|██████▌   | 176/268 [00:22<00:10,  8.38it/s]Test-loop:  66%|██████▋   | 178/268 [00:22<00:10,  8.22it/s]Test-loop:  67%|██████▋   | 180/268 [00:22<00:10,  8.42it/s]Test-loop:  68%|██████▊   | 182/268 [00:22<00:10,  8.37it/s]Test-loop:  69%|██████▊   | 184/268 [00:22<00:10,  8.38it/s]Test-loop:  69%|██████▉   | 186/268 [00:23<00:09,  8.46it/s]Test-loop:  70%|███████   | 188/268 [00:23<00:09,  8.28it/s]Test-loop:  71%|███████   | 190/268 [00:23<00:09,  8.18it/s]Test-loop:  72%|███████▏  | 192/268 [00:23<00:09,  8.15it/s]Test-loop:  72%|███████▏  | 194/268 [00:24<00:08,  8.29it/s]Test-loop:  73%|███████▎  | 196/268 [00:24<00:08,  8.10it/s]Test-loop:  74%|███████▍  | 198/268 [00:24<00:08,  8.04it/s]Test-loop:  75%|███████▍  | 200/268 [00:24<00:08,  8.12it/s]Test-loop:  75%|███████▌  | 202/268 [00:25<00:08,  8.14it/s]Test-loop:  76%|███████▌  | 204/268 [00:25<00:08,  7.98it/s]Test-loop:  77%|███████▋  | 206/268 [00:25<00:07,  8.00it/s]Test-loop:  78%|███████▊  | 208/268 [00:25<00:07,  7.90it/s]Test-loop:  78%|███████▊  | 210/268 [00:26<00:07,  7.91it/s]Test-loop:  79%|███████▉  | 212/268 [00:26<00:06,  8.03it/s]Test-loop:  80%|███████▉  | 214/268 [00:26<00:06,  7.97it/s]Test-loop:  81%|████████  | 216/268 [00:26<00:06,  8.12it/s]Test-loop:  81%|████████▏ | 218/268 [00:27<00:06,  8.10it/s]Test-loop:  82%|████████▏ | 220/268 [00:27<00:05,  8.21it/s]Test-loop:  83%|████████▎ | 222/268 [00:27<00:05,  8.11it/s]Test-loop:  84%|████████▎ | 224/268 [00:27<00:05,  8.21it/s]Test-loop:  84%|████████▍ | 226/268 [00:28<00:05,  8.38it/s]Test-loop:  85%|████████▌ | 228/268 [00:28<00:04,  8.32it/s]Test-loop:  86%|████████▌ | 230/268 [00:28<00:04,  8.38it/s]Test-loop:  87%|████████▋ | 232/268 [00:28<00:04,  8.54it/s]Test-loop:  87%|████████▋ | 234/268 [00:29<00:03,  8.75it/s]Test-loop:  88%|████████▊ | 236/268 [00:29<00:03,  8.77it/s]Test-loop:  89%|████████▉ | 238/268 [00:29<00:03,  8.67it/s]Test-loop:  90%|████████▉ | 240/268 [00:29<00:03,  8.61it/s]Test-loop:  90%|█████████ | 242/268 [00:30<00:02,  8.68it/s]Test-loop:  91%|█████████ | 244/268 [00:30<00:02,  8.67it/s]Test-loop:  92%|█████████▏| 246/268 [00:30<00:02,  8.69it/s]Test-loop:  93%|█████████▎| 248/268 [00:30<00:02,  8.62it/s]Test-loop:  93%|█████████▎| 250/268 [00:30<00:02,  8.52it/s]Test-loop:  94%|█████████▍| 252/268 [00:31<00:01,  8.47it/s]Test-loop:  95%|█████████▍| 254/268 [00:31<00:01,  8.43it/s]Test-loop:  96%|█████████▌| 256/268 [00:31<00:01,  8.42it/s]Test-loop:  96%|█████████▋| 258/268 [00:31<00:01,  8.35it/s]Test-loop:  97%|█████████▋| 260/268 [00:32<00:00,  8.24it/s]Test-loop:  98%|█████████▊| 262/268 [00:32<00:00,  8.08it/s]Test-loop:  99%|█████████▊| 264/268 [00:32<00:00,  7.99it/s]Test-loop:  99%|█████████▉| 266/268 [00:32<00:00,  8.11it/s]Test-loop: 100%|██████████| 268/268 [00:33<00:00,  9.56it/s]Test-loop: 100%|██████████| 268/268 [00:33<00:00,  8.10it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3011/17100 [00:00<00:00, 30098.40it/s]Loading Data:  35%|███▌      | 6023/17100 [00:00<00:00, 30105.47it/s]Loading Data:  53%|█████▎    | 9058/17100 [00:00<00:00, 30215.90it/s]Loading Data:  71%|███████   | 12094/17100 [00:00<00:00, 30270.54it/s]Loading Data:  88%|████████▊ | 15129/17100 [00:00<00:00, 30298.11it/s]Loading Data: 100%|██████████| 17100/17100 [00:00<00:00, 30256.70it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 30095.16it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3011/17098 [00:00<00:00, 30105.94it/s]Loading Data:  35%|███▌      | 6051/17098 [00:00<00:00, 30275.10it/s]Loading Data:  53%|█████▎    | 9079/17098 [00:00<00:00, 30231.21it/s]Loading Data:  71%|███████   | 12103/17098 [00:00<00:00, 30201.46it/s]Loading Data:  89%|████████▊ | 15139/17098 [00:00<00:00, 30256.33it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30258.74it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:25,  1.71it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:08,  4.74it/s]Test-loop:  11%|█         | 5/45 [00:00<00:05,  6.92it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.53it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.89it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.95it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 11.54it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 12.24it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 12.94it/s]Test-loop:  42%|████▏     | 19/45 [00:01<00:01, 13.48it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 13.81it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 13.48it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 13.33it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 13.14it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 13.08it/s]Test-loop:  69%|██████▉   | 31/45 [00:02<00:01, 13.00it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.95it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 13.00it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 13.07it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.81it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.91it/s]Test-loop:  96%|█████████▌| 43/45 [00:03<00:00, 12.96it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 13.73it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 11.42it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:41,  1.65it/s]Test-loop:   1%|          | 3/268 [00:00<00:58,  4.53it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:38,  6.74it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:31,  8.34it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:27,  9.45it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:24, 10.35it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:23, 10.97it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:22, 11.41it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:21, 11.80it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:20, 12.02it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:20, 12.23it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:19, 12.36it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:19, 12.42it/s]Test-loop:  10%|█         | 27/268 [00:02<00:19, 12.47it/s]Test-loop:  11%|█         | 29/268 [00:02<00:18, 12.60it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:18, 12.73it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:18, 12.80it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:18, 12.77it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:18, 12.72it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:17, 12.77it/s]Test-loop:  15%|█▌        | 41/268 [00:03<00:17, 12.74it/s]Test-loop:  16%|█▌        | 43/268 [00:03<00:17, 12.69it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:17, 12.70it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:17, 12.72it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:17, 12.77it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:17, 12.70it/s]Test-loop:  20%|█▉        | 53/268 [00:04<00:17, 12.58it/s]Test-loop:  21%|██        | 55/268 [00:04<00:16, 12.60it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:16, 12.68it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:16, 12.81it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:16, 12.67it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:16, 12.60it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:16, 12.58it/s]Test-loop:  25%|██▌       | 67/268 [00:05<00:16, 12.47it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:15, 12.58it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:15, 12.53it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:15, 12.50it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:15, 12.56it/s]Test-loop:  29%|██▊       | 77/268 [00:06<00:14, 12.90it/s]Test-loop:  29%|██▉       | 79/268 [00:06<00:14, 13.33it/s]Test-loop:  30%|███       | 81/268 [00:06<00:13, 13.69it/s]Test-loop:  31%|███       | 83/268 [00:07<00:13, 13.72it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:13, 13.18it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:13, 12.97it/s]Test-loop:  33%|███▎      | 89/268 [00:07<00:13, 12.93it/s]Test-loop:  34%|███▍      | 91/268 [00:07<00:13, 12.91it/s]Test-loop:  35%|███▍      | 93/268 [00:07<00:13, 12.88it/s]Test-loop:  35%|███▌      | 95/268 [00:07<00:13, 12.90it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:13, 12.92it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:12, 13.40it/s]Test-loop:  38%|███▊      | 101/268 [00:08<00:12, 13.76it/s]Test-loop:  38%|███▊      | 103/268 [00:08<00:11, 14.09it/s]Test-loop:  39%|███▉      | 105/268 [00:08<00:11, 13.81it/s]Test-loop:  40%|███▉      | 107/268 [00:08<00:11, 13.56it/s]Test-loop:  41%|████      | 109/268 [00:09<00:12, 13.25it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:12, 13.07it/s]Test-loop:  42%|████▏     | 113/268 [00:09<00:12, 12.88it/s]Test-loop:  43%|████▎     | 115/268 [00:09<00:11, 12.98it/s]Test-loop:  44%|████▎     | 117/268 [00:09<00:11, 12.92it/s]Test-loop:  44%|████▍     | 119/268 [00:09<00:11, 12.91it/s]Test-loop:  45%|████▌     | 121/268 [00:09<00:11, 12.89it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:11, 12.78it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:11, 12.75it/s]Test-loop:  47%|████▋     | 127/268 [00:10<00:11, 12.76it/s]Test-loop:  48%|████▊     | 129/268 [00:10<00:10, 12.80it/s]Test-loop:  49%|████▉     | 131/268 [00:10<00:10, 12.71it/s]Test-loop:  50%|████▉     | 133/268 [00:10<00:10, 12.61it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:10, 12.56it/s]Test-loop:  51%|█████     | 137/268 [00:11<00:10, 12.76it/s]Test-loop:  52%|█████▏    | 139/268 [00:11<00:10, 12.82it/s]Test-loop:  53%|█████▎    | 141/268 [00:11<00:09, 12.99it/s]Test-loop:  53%|█████▎    | 143/268 [00:11<00:09, 13.18it/s]Test-loop:  54%|█████▍    | 145/268 [00:11<00:09, 13.04it/s]Test-loop:  55%|█████▍    | 147/268 [00:11<00:09, 12.90it/s]Test-loop:  56%|█████▌    | 149/268 [00:12<00:09, 12.63it/s]Test-loop:  56%|█████▋    | 151/268 [00:12<00:09, 12.48it/s]Test-loop:  57%|█████▋    | 153/268 [00:12<00:09, 12.74it/s]Test-loop:  58%|█████▊    | 155/268 [00:12<00:08, 12.65it/s]Test-loop:  59%|█████▊    | 157/268 [00:12<00:08, 12.67it/s]Test-loop:  59%|█████▉    | 159/268 [00:12<00:08, 12.75it/s]Test-loop:  60%|██████    | 161/268 [00:13<00:08, 12.89it/s]Test-loop:  61%|██████    | 163/268 [00:13<00:08, 12.64it/s]Test-loop:  62%|██████▏   | 165/268 [00:13<00:08, 12.55it/s]Test-loop:  62%|██████▏   | 167/268 [00:13<00:08, 12.55it/s]Test-loop:  63%|██████▎   | 169/268 [00:13<00:07, 12.61it/s]Test-loop:  64%|██████▍   | 171/268 [00:13<00:07, 12.59it/s]Test-loop:  65%|██████▍   | 173/268 [00:14<00:07, 12.62it/s]Test-loop:  65%|██████▌   | 175/268 [00:14<00:07, 12.75it/s]Test-loop:  66%|██████▌   | 177/268 [00:14<00:07, 12.72it/s]Test-loop:  67%|██████▋   | 179/268 [00:14<00:06, 12.76it/s]Test-loop:  68%|██████▊   | 181/268 [00:14<00:06, 12.84it/s]Test-loop:  68%|██████▊   | 183/268 [00:14<00:06, 12.81it/s]Test-loop:  69%|██████▉   | 185/268 [00:14<00:06, 12.79it/s]Test-loop:  70%|██████▉   | 187/268 [00:15<00:06, 12.81it/s]Test-loop:  71%|███████   | 189/268 [00:15<00:06, 12.79it/s]Test-loop:  71%|███████▏  | 191/268 [00:15<00:05, 12.98it/s]Test-loop:  72%|███████▏  | 193/268 [00:15<00:05, 13.20it/s]Test-loop:  73%|███████▎  | 195/268 [00:15<00:05, 13.18it/s]Test-loop:  74%|███████▎  | 197/268 [00:15<00:05, 13.19it/s]Test-loop:  74%|███████▍  | 199/268 [00:16<00:05, 13.16it/s]Test-loop:  75%|███████▌  | 201/268 [00:16<00:05, 13.19it/s]Test-loop:  76%|███████▌  | 203/268 [00:16<00:04, 13.14it/s]Test-loop:  76%|███████▋  | 205/268 [00:16<00:04, 13.00it/s]Test-loop:  77%|███████▋  | 207/268 [00:16<00:04, 13.18it/s]Test-loop:  78%|███████▊  | 209/268 [00:16<00:04, 13.10it/s]Test-loop:  79%|███████▊  | 211/268 [00:16<00:04, 13.23it/s]Test-loop:  79%|███████▉  | 213/268 [00:17<00:04, 13.39it/s]Test-loop:  80%|████████  | 215/268 [00:17<00:04, 13.21it/s]Test-loop:  81%|████████  | 217/268 [00:17<00:03, 13.12it/s]Test-loop:  82%|████████▏ | 219/268 [00:17<00:03, 13.07it/s]Test-loop:  82%|████████▏ | 221/268 [00:17<00:03, 13.13it/s]Test-loop:  83%|████████▎ | 223/268 [00:17<00:03, 13.46it/s]Test-loop:  84%|████████▍ | 225/268 [00:17<00:03, 13.92it/s]Test-loop:  85%|████████▍ | 227/268 [00:18<00:02, 14.26it/s]Test-loop:  85%|████████▌ | 229/268 [00:18<00:02, 14.51it/s]Test-loop:  86%|████████▌ | 231/268 [00:18<00:02, 14.50it/s]Test-loop:  87%|████████▋ | 233/268 [00:18<00:02, 14.16it/s]Test-loop:  88%|████████▊ | 235/268 [00:18<00:02, 13.96it/s]Test-loop:  88%|████████▊ | 237/268 [00:18<00:02, 13.88it/s]Test-loop:  89%|████████▉ | 239/268 [00:18<00:02, 13.56it/s]Test-loop:  90%|████████▉ | 241/268 [00:19<00:02, 13.35it/s]Test-loop:  91%|█████████ | 243/268 [00:19<00:01, 13.32it/s]Test-loop:  91%|█████████▏| 245/268 [00:19<00:01, 13.33it/s]Test-loop:  92%|█████████▏| 247/268 [00:19<00:01, 13.41it/s]Test-loop:  93%|█████████▎| 249/268 [00:19<00:01, 13.54it/s]Test-loop:  94%|█████████▎| 251/268 [00:19<00:01, 13.49it/s]Test-loop:  94%|█████████▍| 253/268 [00:20<00:01, 13.61it/s]Test-loop:  95%|█████████▌| 255/268 [00:20<00:00, 13.51it/s]Test-loop:  96%|█████████▌| 257/268 [00:20<00:00, 13.54it/s]Test-loop:  97%|█████████▋| 259/268 [00:20<00:00, 13.43it/s]Test-loop:  97%|█████████▋| 261/268 [00:20<00:00, 13.33it/s]Test-loop:  98%|█████████▊| 263/268 [00:20<00:00, 13.37it/s]Test-loop:  99%|█████████▉| 265/268 [00:20<00:00, 13.28it/s]Test-loop: 100%|█████████▉| 267/268 [00:21<00:00, 13.15it/s]Test-loop: 100%|██████████| 268/268 [00:21<00:00, 12.65it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:14,  1.37it/s]Test-loop:   1%|          | 3/268 [00:00<01:15,  3.52it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:52,  5.01it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:43,  6.00it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:38,  6.70it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:36,  7.02it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:34,  7.35it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:32,  7.69it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:31,  7.85it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:30,  8.12it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:29,  8.40it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:28,  8.59it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:28,  8.64it/s]Test-loop:  10%|█         | 27/268 [00:03<00:28,  8.43it/s]Test-loop:  11%|█         | 29/268 [00:04<00:28,  8.53it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:28,  8.46it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:27,  8.56it/s]Test-loop:  13%|█▎        | 35/268 [00:04<00:27,  8.48it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:27,  8.36it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:27,  8.39it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:26,  8.41it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:26,  8.47it/s]Test-loop:  17%|█▋        | 45/268 [00:05<00:26,  8.35it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:26,  8.35it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:26,  8.34it/s]Test-loop:  19%|█▉        | 51/268 [00:06<00:26,  8.34it/s]Test-loop:  20%|█▉        | 53/268 [00:06<00:26,  8.23it/s]Test-loop:  21%|██        | 55/268 [00:07<00:25,  8.43it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:25,  8.30it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:25,  8.17it/s]Test-loop:  23%|██▎       | 61/268 [00:07<00:25,  8.21it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:25,  8.08it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:24,  8.20it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:24,  8.34it/s]Test-loop:  26%|██▌       | 69/268 [00:08<00:24,  8.29it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:23,  8.23it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:23,  8.25it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:22,  8.48it/s]Test-loop:  29%|██▊       | 77/268 [00:09<00:22,  8.62it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:22,  8.54it/s]Test-loop:  30%|███       | 81/268 [00:10<00:21,  8.60it/s]Test-loop:  31%|███       | 83/268 [00:10<00:22,  8.36it/s]Test-loop:  32%|███▏      | 85/268 [00:10<00:21,  8.35it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:21,  8.54it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:20,  8.75it/s]Test-loop:  34%|███▍      | 91/268 [00:11<00:20,  8.54it/s]Test-loop:  35%|███▍      | 93/268 [00:11<00:20,  8.50it/s]Test-loop:  35%|███▌      | 95/268 [00:11<00:20,  8.34it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:20,  8.47it/s]Test-loop:  37%|███▋      | 99/268 [00:12<00:20,  8.45it/s]Test-loop:  38%|███▊      | 101/268 [00:12<00:19,  8.37it/s]Test-loop:  38%|███▊      | 103/268 [00:12<00:19,  8.42it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:18,  8.64it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:18,  8.53it/s]Test-loop:  41%|████      | 109/268 [00:13<00:18,  8.38it/s]Test-loop:  41%|████▏     | 111/268 [00:13<00:18,  8.50it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:18,  8.49it/s]Test-loop:  43%|████▎     | 115/268 [00:14<00:18,  8.38it/s]Test-loop:  44%|████▎     | 117/268 [00:14<00:18,  8.35it/s]Test-loop:  44%|████▍     | 119/268 [00:14<00:17,  8.37it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:17,  8.31it/s]Test-loop:  46%|████▌     | 123/268 [00:15<00:17,  8.17it/s]Test-loop:  47%|████▋     | 125/268 [00:15<00:17,  8.33it/s]Test-loop:  47%|████▋     | 127/268 [00:15<00:16,  8.33it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:16,  8.28it/s]Test-loop:  49%|████▉     | 131/268 [00:16<00:16,  8.28it/s]Test-loop:  50%|████▉     | 133/268 [00:16<00:16,  8.05it/s]Test-loop:  50%|█████     | 135/268 [00:16<00:16,  8.07it/s]Test-loop:  51%|█████     | 137/268 [00:16<00:16,  8.15it/s]Test-loop:  52%|█████▏    | 139/268 [00:17<00:15,  8.20it/s]Test-loop:  53%|█████▎    | 141/268 [00:17<00:15,  8.29it/s]Test-loop:  53%|█████▎    | 143/268 [00:17<00:15,  8.27it/s]Test-loop:  54%|█████▍    | 145/268 [00:17<00:14,  8.28it/s]Test-loop:  55%|█████▍    | 147/268 [00:18<00:14,  8.40it/s]Test-loop:  56%|█████▌    | 149/268 [00:18<00:14,  8.49it/s]Test-loop:  56%|█████▋    | 151/268 [00:18<00:13,  8.52it/s]Test-loop:  57%|█████▋    | 153/268 [00:18<00:13,  8.55it/s]Test-loop:  58%|█████▊    | 155/268 [00:19<00:13,  8.61it/s]Test-loop:  59%|█████▊    | 157/268 [00:19<00:13,  8.47it/s]Test-loop:  59%|█████▉    | 159/268 [00:19<00:12,  8.46it/s]Test-loop:  60%|██████    | 161/268 [00:19<00:12,  8.40it/s]Test-loop:  61%|██████    | 163/268 [00:20<00:12,  8.41it/s]Test-loop:  62%|██████▏   | 165/268 [00:20<00:12,  8.30it/s]Test-loop:  62%|██████▏   | 167/268 [00:20<00:12,  8.29it/s]Test-loop:  63%|██████▎   | 169/268 [00:20<00:11,  8.43it/s]Test-loop:  64%|██████▍   | 171/268 [00:21<00:11,  8.29it/s]Test-loop:  65%|██████▍   | 173/268 [00:21<00:11,  8.18it/s]Test-loop:  65%|██████▌   | 175/268 [00:21<00:11,  8.35it/s]Test-loop:  66%|██████▌   | 177/268 [00:21<00:10,  8.39it/s]Test-loop:  67%|██████▋   | 179/268 [00:21<00:10,  8.41it/s]Test-loop:  68%|██████▊   | 181/268 [00:22<00:10,  8.42it/s]Test-loop:  68%|██████▊   | 183/268 [00:22<00:10,  8.38it/s]Test-loop:  69%|██████▉   | 185/268 [00:22<00:09,  8.42it/s]Test-loop:  70%|██████▉   | 187/268 [00:22<00:09,  8.31it/s]Test-loop:  71%|███████   | 189/268 [00:23<00:09,  8.16it/s]Test-loop:  71%|███████▏  | 191/268 [00:23<00:09,  8.24it/s]Test-loop:  72%|███████▏  | 193/268 [00:23<00:08,  8.42it/s]Test-loop:  73%|███████▎  | 195/268 [00:23<00:08,  8.39it/s]Test-loop:  74%|███████▎  | 197/268 [00:24<00:08,  8.25it/s]Test-loop:  74%|███████▍  | 199/268 [00:24<00:08,  8.37it/s]Test-loop:  75%|███████▌  | 201/268 [00:24<00:07,  8.42it/s]Test-loop:  76%|███████▌  | 203/268 [00:24<00:07,  8.41it/s]Test-loop:  76%|███████▋  | 205/268 [00:25<00:07,  8.54it/s]Test-loop:  77%|███████▋  | 207/268 [00:25<00:07,  8.43it/s]Test-loop:  78%|███████▊  | 209/268 [00:25<00:07,  8.36it/s]Test-loop:  79%|███████▊  | 211/268 [00:25<00:06,  8.52it/s]Test-loop:  79%|███████▉  | 213/268 [00:26<00:06,  8.31it/s]Test-loop:  80%|████████  | 215/268 [00:26<00:06,  8.53it/s]Test-loop:  81%|████████  | 217/268 [00:26<00:05,  8.62it/s]Test-loop:  82%|████████▏ | 219/268 [00:26<00:05,  8.84it/s]Test-loop:  82%|████████▏ | 221/268 [00:26<00:05,  8.79it/s]Test-loop:  83%|████████▎ | 223/268 [00:27<00:05,  8.67it/s]Test-loop:  84%|████████▍ | 225/268 [00:27<00:04,  8.84it/s]Test-loop:  85%|████████▍ | 227/268 [00:27<00:04,  8.78it/s]Test-loop:  85%|████████▌ | 229/268 [00:27<00:04,  8.79it/s]Test-loop:  86%|████████▌ | 231/268 [00:28<00:04,  8.72it/s]Test-loop:  87%|████████▋ | 233/268 [00:28<00:03,  8.76it/s]Test-loop:  88%|████████▊ | 235/268 [00:28<00:03,  8.69it/s]Test-loop:  88%|████████▊ | 237/268 [00:28<00:03,  8.60it/s]Test-loop:  89%|████████▉ | 239/268 [00:29<00:03,  8.73it/s]Test-loop:  90%|████████▉ | 241/268 [00:29<00:03,  8.78it/s]Test-loop:  91%|█████████ | 243/268 [00:29<00:02,  8.78it/s]Test-loop:  91%|█████████▏| 245/268 [00:29<00:02,  8.69it/s]Test-loop:  92%|█████████▏| 247/268 [00:29<00:02,  8.95it/s]Test-loop:  93%|█████████▎| 249/268 [00:30<00:02,  9.11it/s]Test-loop:  94%|█████████▎| 251/268 [00:30<00:01,  9.08it/s]Test-loop:  94%|█████████▍| 253/268 [00:30<00:01,  8.99it/s]Test-loop:  95%|█████████▌| 255/268 [00:30<00:01,  9.10it/s]Test-loop:  96%|█████████▌| 257/268 [00:31<00:01,  9.07it/s]Test-loop:  97%|█████████▋| 259/268 [00:31<00:00,  9.11it/s]Test-loop:  97%|█████████▋| 261/268 [00:31<00:00,  8.75it/s]Test-loop:  98%|█████████▊| 263/268 [00:31<00:00,  8.84it/s]Test-loop:  99%|█████████▉| 265/268 [00:31<00:00,  8.91it/s]Test-loop: 100%|█████████▉| 267/268 [00:32<00:00,  8.63it/s]Test-loop: 100%|██████████| 268/268 [00:32<00:00,  8.31it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3019/17100 [00:00<00:00, 30184.20it/s]Loading Data:  36%|███▌      | 6086/17100 [00:00<00:00, 30467.27it/s]Loading Data:  54%|█████▎    | 9155/17100 [00:00<00:00, 30566.05it/s]Loading Data:  71%|███████▏  | 12221/17100 [00:00<00:00, 30601.39it/s]Loading Data:  89%|████████▉ | 15282/17100 [00:00<00:00, 30520.47it/s]Loading Data: 100%|██████████| 17100/17100 [00:00<00:00, 30508.73it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 30204.13it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  17%|█▋        | 2990/17098 [00:00<00:00, 29890.69it/s]Loading Data:  35%|███▌      | 6022/17098 [00:00<00:00, 30138.35it/s]Loading Data:  53%|█████▎    | 9054/17098 [00:00<00:00, 30220.08it/s]Loading Data:  71%|███████   | 12095/17098 [00:00<00:00, 30293.75it/s]Loading Data:  88%|████████▊ | 15125/17098 [00:00<00:00, 30222.15it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30226.20it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:27,  1.60it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.50it/s]Test-loop:  11%|█         | 5/45 [00:00<00:05,  6.67it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.20it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.36it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.20it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:03, 10.65it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.36it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 11.79it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.96it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:02, 11.90it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 11.97it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 11.94it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 11.83it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 11.85it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 11.85it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:01, 11.90it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 11.94it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 11.86it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 11.83it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 11.88it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 11.94it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 12.91it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.53it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:51,  1.55it/s]Test-loop:   1%|          | 3/268 [00:00<01:01,  4.33it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:41,  6.32it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:34,  7.66it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:29,  8.77it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:26,  9.79it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:23, 10.75it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:21, 11.52it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:20, 12.06it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:19, 12.50it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:19, 12.80it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:18, 13.12it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:19, 12.74it/s]Test-loop:  10%|█         | 27/268 [00:02<00:19, 12.64it/s]Test-loop:  11%|█         | 29/268 [00:02<00:18, 12.93it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:18, 13.15it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:17, 13.42it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:17, 13.07it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:18, 12.72it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:18, 12.59it/s]Test-loop:  15%|█▌        | 41/268 [00:03<00:18, 12.46it/s]Test-loop:  16%|█▌        | 43/268 [00:03<00:18, 12.43it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:18, 12.26it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:18, 12.23it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:18, 12.03it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:18, 11.92it/s]Test-loop:  20%|█▉        | 53/268 [00:04<00:18, 11.93it/s]Test-loop:  21%|██        | 55/268 [00:04<00:17, 12.03it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:17, 12.10it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:17, 12.20it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:16, 12.32it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:16, 12.26it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:16, 12.19it/s]Test-loop:  25%|██▌       | 67/268 [00:05<00:16, 12.20it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:16, 12.17it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:16, 12.13it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:16, 11.98it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:16, 11.83it/s]Test-loop:  29%|██▊       | 77/268 [00:06<00:16, 11.78it/s]Test-loop:  29%|██▉       | 79/268 [00:06<00:16, 11.70it/s]Test-loop:  30%|███       | 81/268 [00:07<00:15, 11.71it/s]Test-loop:  31%|███       | 83/268 [00:07<00:15, 11.73it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:15, 11.77it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:15, 11.81it/s]Test-loop:  33%|███▎      | 89/268 [00:07<00:15, 11.82it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:15, 11.77it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:14, 11.71it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:14, 11.57it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:14, 11.54it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:14, 11.57it/s]Test-loop:  38%|███▊      | 101/268 [00:08<00:14, 11.51it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:14, 11.51it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:14, 11.56it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:14, 11.50it/s]Test-loop:  41%|████      | 109/268 [00:09<00:13, 11.51it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:13, 11.63it/s]Test-loop:  42%|████▏     | 113/268 [00:09<00:13, 11.79it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:12, 11.84it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 11.88it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 11.78it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:12, 11.79it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:12, 11.93it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:11, 12.10it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 12.16it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 12.22it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 12.17it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:11, 12.08it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:10, 12.29it/s]Test-loop:  51%|█████     | 137/268 [00:11<00:10, 12.29it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:10, 12.38it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:10, 12.27it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:10, 12.05it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:10, 11.94it/s]Test-loop:  55%|█████▍    | 147/268 [00:12<00:10, 11.91it/s]Test-loop:  56%|█████▌    | 149/268 [00:12<00:10, 11.80it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:10, 11.69it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 11.70it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 11.79it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:09, 11.88it/s]Test-loop:  59%|█████▉    | 159/268 [00:13<00:09, 12.08it/s]Test-loop:  60%|██████    | 161/268 [00:13<00:08, 12.62it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:08, 12.88it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:07, 13.13it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:07, 12.73it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:07, 12.42it/s]Test-loop:  64%|██████▍   | 171/268 [00:14<00:07, 12.23it/s]Test-loop:  65%|██████▍   | 173/268 [00:14<00:07, 12.44it/s]Test-loop:  65%|██████▌   | 175/268 [00:14<00:07, 12.43it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 12.19it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 12.05it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:07, 11.95it/s]Test-loop:  68%|██████▊   | 183/268 [00:15<00:07, 11.80it/s]Test-loop:  69%|██████▉   | 185/268 [00:15<00:06, 11.86it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 11.90it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 11.85it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 11.86it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:06, 11.88it/s]Test-loop:  73%|███████▎  | 195/268 [00:16<00:06, 11.95it/s]Test-loop:  74%|███████▎  | 197/268 [00:16<00:05, 11.91it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:05, 11.93it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 11.82it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 11.92it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 11.92it/s]Test-loop:  77%|███████▋  | 207/268 [00:17<00:05, 12.06it/s]Test-loop:  78%|███████▊  | 209/268 [00:17<00:04, 11.90it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 11.83it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 11.83it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 12.09it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:04, 12.22it/s]Test-loop:  82%|████████▏ | 219/268 [00:18<00:04, 12.03it/s]Test-loop:  82%|████████▏ | 221/268 [00:18<00:03, 11.94it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 11.88it/s]Test-loop:  84%|████████▍ | 225/268 [00:19<00:03, 11.71it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 11.66it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:03, 11.67it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:03, 11.64it/s]Test-loop:  87%|████████▋ | 233/268 [00:19<00:03, 11.64it/s]Test-loop:  88%|████████▊ | 235/268 [00:20<00:02, 11.69it/s]Test-loop:  88%|████████▊ | 237/268 [00:20<00:02, 11.58it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 11.67it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:02, 11.73it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:02, 11.77it/s]Test-loop:  91%|█████████▏| 245/268 [00:20<00:01, 12.00it/s]Test-loop:  92%|█████████▏| 247/268 [00:21<00:01, 11.97it/s]Test-loop:  93%|█████████▎| 249/268 [00:21<00:01, 12.04it/s]Test-loop:  94%|█████████▎| 251/268 [00:21<00:01, 11.90it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 11.87it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:01, 11.90it/s]Test-loop:  96%|█████████▌| 257/268 [00:21<00:00, 11.79it/s]Test-loop:  97%|█████████▋| 259/268 [00:22<00:00, 11.83it/s]Test-loop:  97%|█████████▋| 261/268 [00:22<00:00, 11.77it/s]Test-loop:  98%|█████████▊| 263/268 [00:22<00:00, 11.86it/s]Test-loop:  99%|█████████▉| 265/268 [00:22<00:00, 11.80it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 11.70it/s]Test-loop: 100%|██████████| 268/268 [00:22<00:00, 11.72it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:11,  1.40it/s]Test-loop:   1%|          | 3/268 [00:00<01:14,  3.55it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:53,  4.95it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:43,  5.96it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:39,  6.53it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:36,  7.00it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:35,  7.21it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:34,  7.40it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:32,  7.63it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:32,  7.77it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:31,  7.91it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:29,  8.27it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:29,  8.19it/s]Test-loop:  10%|█         | 27/268 [00:03<00:29,  8.19it/s]Test-loop:  11%|█         | 29/268 [00:04<00:29,  7.99it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:29,  8.06it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:29,  7.98it/s]Test-loop:  13%|█▎        | 35/268 [00:04<00:28,  8.10it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:28,  8.18it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:27,  8.38it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:26,  8.45it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:27,  8.23it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:27,  8.20it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:26,  8.24it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:27,  7.96it/s]Test-loop:  19%|█▉        | 51/268 [00:06<00:27,  7.91it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:27,  7.85it/s]Test-loop:  21%|██        | 55/268 [00:07<00:26,  7.90it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:27,  7.72it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:25,  8.06it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:25,  8.12it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:25,  8.18it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:25,  8.05it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:24,  8.12it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:25,  7.95it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:24,  7.98it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:24,  7.99it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:24,  8.01it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:23,  8.05it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  7.97it/s]Test-loop:  30%|███       | 81/268 [00:10<00:23,  8.02it/s]Test-loop:  31%|███       | 83/268 [00:10<00:23,  7.97it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:23,  7.89it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  7.93it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  7.91it/s]Test-loop:  34%|███▍      | 91/268 [00:11<00:22,  7.80it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:21,  7.97it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.02it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  7.98it/s]Test-loop:  37%|███▋      | 99/268 [00:12<00:20,  8.06it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.11it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  7.96it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:20,  7.93it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:20,  8.04it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.00it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  7.86it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:19,  7.91it/s]Test-loop:  43%|████▎     | 115/268 [00:14<00:19,  8.02it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:18,  8.15it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:18,  8.22it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:17,  8.34it/s]Test-loop:  46%|████▌     | 123/268 [00:15<00:17,  8.28it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:17,  8.25it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  8.27it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:16,  8.18it/s]Test-loop:  49%|████▉     | 131/268 [00:16<00:17,  8.03it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.14it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  8.17it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:15,  8.20it/s]Test-loop:  52%|█████▏    | 139/268 [00:17<00:15,  8.22it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:15,  8.11it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  8.13it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:14,  8.32it/s]Test-loop:  55%|█████▍    | 147/268 [00:18<00:14,  8.30it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  8.18it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  8.16it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:13,  8.21it/s]Test-loop:  58%|█████▊    | 155/268 [00:19<00:13,  8.28it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.21it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  8.24it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:12,  8.48it/s]Test-loop:  61%|██████    | 163/268 [00:20<00:12,  8.38it/s]Test-loop:  62%|██████▏   | 165/268 [00:20<00:12,  8.28it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  8.13it/s]Test-loop:  63%|██████▎   | 169/268 [00:21<00:12,  8.12it/s]Test-loop:  64%|██████▍   | 171/268 [00:21<00:11,  8.13it/s]Test-loop:  65%|██████▍   | 173/268 [00:21<00:11,  8.00it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  8.22it/s]Test-loop:  66%|██████▌   | 177/268 [00:22<00:11,  8.14it/s]Test-loop:  67%|██████▋   | 179/268 [00:22<00:11,  8.07it/s]Test-loop:  68%|██████▊   | 181/268 [00:22<00:10,  8.27it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  8.31it/s]Test-loop:  69%|██████▉   | 185/268 [00:23<00:10,  8.27it/s]Test-loop:  69%|██████▉   | 186/268 [00:23<00:09,  8.48it/s]Test-loop:  70%|██████▉   | 187/268 [00:23<00:09,  8.29it/s]Test-loop:  70%|███████   | 188/268 [00:23<00:09,  8.17it/s]Test-loop:  71%|███████   | 189/268 [00:23<00:09,  8.10it/s]Test-loop:  71%|███████   | 190/268 [00:24<00:09,  8.37it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  8.04it/s]Test-loop:  72%|███████▏  | 192/268 [00:24<00:08,  8.47it/s]Test-loop:  72%|███████▏  | 193/268 [00:24<00:09,  7.83it/s]Test-loop:  72%|███████▏  | 194/268 [00:24<00:08,  8.33it/s]Test-loop:  73%|███████▎  | 195/268 [00:24<00:09,  7.84it/s]Test-loop:  73%|███████▎  | 196/268 [00:24<00:08,  8.31it/s]Test-loop:  74%|███████▎  | 197/268 [00:24<00:08,  8.04it/s]Test-loop:  74%|███████▍  | 198/268 [00:25<00:08,  8.31it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  7.94it/s]Test-loop:  75%|███████▍  | 200/268 [00:25<00:08,  7.96it/s]Test-loop:  75%|███████▌  | 201/268 [00:25<00:08,  7.87it/s]Test-loop:  75%|███████▌  | 202/268 [00:25<00:07,  8.33it/s]Test-loop:  76%|███████▌  | 203/268 [00:25<00:08,  7.78it/s]Test-loop:  76%|███████▋  | 205/268 [00:25<00:07,  7.99it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  8.12it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:07,  8.32it/s]Test-loop:  79%|███████▊  | 211/268 [00:26<00:07,  8.14it/s]Test-loop:  79%|███████▉  | 213/268 [00:26<00:06,  8.15it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  8.25it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:06,  8.28it/s]Test-loop:  81%|████████▏ | 218/268 [00:27<00:05,  8.41it/s]Test-loop:  82%|████████▏ | 219/268 [00:27<00:05,  8.17it/s]Test-loop:  82%|████████▏ | 220/268 [00:27<00:05,  8.23it/s]Test-loop:  82%|████████▏ | 221/268 [00:27<00:05,  8.03it/s]Test-loop:  83%|████████▎ | 222/268 [00:27<00:05,  8.17it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  8.02it/s]Test-loop:  84%|████████▎ | 224/268 [00:28<00:05,  8.16it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.00it/s]Test-loop:  84%|████████▍ | 226/268 [00:28<00:05,  8.22it/s]Test-loop:  85%|████████▍ | 227/268 [00:28<00:05,  8.04it/s]Test-loop:  85%|████████▌ | 228/268 [00:28<00:05,  7.98it/s]Test-loop:  85%|████████▌ | 229/268 [00:28<00:04,  7.80it/s]Test-loop:  86%|████████▌ | 230/268 [00:28<00:04,  8.09it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  7.94it/s]Test-loop:  87%|████████▋ | 232/268 [00:29<00:04,  8.17it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  7.85it/s]Test-loop:  87%|████████▋ | 234/268 [00:29<00:04,  8.09it/s]Test-loop:  88%|████████▊ | 235/268 [00:29<00:04,  7.86it/s]Test-loop:  88%|████████▊ | 236/268 [00:29<00:04,  7.83it/s]Test-loop:  88%|████████▊ | 237/268 [00:29<00:03,  8.03it/s]Test-loop:  89%|████████▉ | 238/268 [00:29<00:03,  7.65it/s]Test-loop:  89%|████████▉ | 239/268 [00:30<00:03,  8.19it/s]Test-loop:  90%|████████▉ | 240/268 [00:30<00:03,  7.71it/s]Test-loop:  90%|█████████ | 242/268 [00:30<00:03,  8.20it/s]Test-loop:  91%|█████████ | 243/268 [00:30<00:02,  8.54it/s]Test-loop:  91%|█████████ | 244/268 [00:30<00:02,  8.35it/s]Test-loop:  91%|█████████▏| 245/268 [00:30<00:02,  7.95it/s]Test-loop:  92%|█████████▏| 247/268 [00:31<00:02,  8.03it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  8.15it/s]Test-loop:  94%|█████████▎| 251/268 [00:31<00:02,  8.27it/s]Test-loop:  94%|█████████▍| 252/268 [00:31<00:01,  8.55it/s]Test-loop:  94%|█████████▍| 253/268 [00:31<00:01,  8.20it/s]Test-loop:  95%|█████████▍| 254/268 [00:31<00:01,  8.13it/s]Test-loop:  95%|█████████▌| 255/268 [00:32<00:01,  8.28it/s]Test-loop:  96%|█████████▌| 256/268 [00:32<00:01,  8.02it/s]Test-loop:  96%|█████████▌| 257/268 [00:32<00:01,  8.31it/s]Test-loop:  96%|█████████▋| 258/268 [00:32<00:01,  7.75it/s]Test-loop:  97%|█████████▋| 259/268 [00:32<00:01,  8.10it/s]Test-loop:  97%|█████████▋| 260/268 [00:32<00:01,  7.78it/s]Test-loop:  97%|█████████▋| 261/268 [00:32<00:00,  8.15it/s]Test-loop:  98%|█████████▊| 262/268 [00:32<00:00,  7.58it/s]Test-loop:  99%|█████████▊| 264/268 [00:33<00:00,  7.96it/s]Test-loop:  99%|█████████▉| 265/268 [00:33<00:00,  8.09it/s]Test-loop:  99%|█████████▉| 266/268 [00:33<00:00,  7.85it/s]Test-loop: 100%|█████████▉| 267/268 [00:33<00:00,  8.15it/s]Test-loop: 100%|██████████| 268/268 [00:33<00:00,  7.96it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3015/17100 [00:00<00:00, 30147.15it/s]Loading Data:  36%|███▌      | 6075/17100 [00:00<00:00, 30409.19it/s]Loading Data:  53%|█████▎    | 9135/17100 [00:00<00:00, 30494.43it/s]Loading Data:  71%|███████▏  | 12185/17100 [00:00<00:00, 30491.33it/s]Loading Data:  89%|████████▉ | 15255/17100 [00:00<00:00, 30563.98it/s]Loading Data: 100%|██████████| 17100/17100 [00:00<00:00, 30504.98it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 30255.12it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3002/17098 [00:00<00:00, 30011.94it/s]Loading Data:  35%|███▌      | 6051/17098 [00:00<00:00, 30287.79it/s]Loading Data:  53%|█████▎    | 9111/17098 [00:00<00:00, 30429.22it/s]Loading Data:  71%|███████   | 12169/17098 [00:00<00:00, 30488.43it/s]Loading Data:  89%|████████▉ | 15228/17098 [00:00<00:00, 30524.15it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30466.23it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:29,  1.49it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.21it/s]Test-loop:  11%|█         | 5/45 [00:01<00:06,  6.22it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  7.77it/s]Test-loop:  20%|██        | 9/45 [00:01<00:04,  8.92it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03,  9.65it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:03, 10.11it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 10.55it/s]Test-loop:  38%|███▊      | 17/45 [00:02<00:02, 11.03it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.15it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:02, 11.28it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 11.47it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 11.51it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 11.53it/s]Test-loop:  64%|██████▍   | 29/45 [00:03<00:01, 11.60it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 11.65it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:01, 11.77it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 11.74it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 11.75it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 11.72it/s]Test-loop:  91%|█████████ | 41/45 [00:04<00:00, 11.66it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 11.68it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 12.70it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.14it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:49,  1.58it/s]Test-loop:   1%|          | 3/268 [00:00<01:01,  4.29it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:41,  6.34it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:31,  8.17it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:27,  9.53it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:24, 10.65it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:22, 11.11it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:22, 11.27it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:21, 11.60it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:20, 12.25it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:19, 12.69it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:18, 13.07it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:18, 12.91it/s]Test-loop:  10%|█         | 27/268 [00:02<00:19, 12.52it/s]Test-loop:  11%|█         | 29/268 [00:02<00:19, 12.32it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:19, 12.08it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:19, 11.84it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:19, 11.92it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:19, 11.86it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:19, 11.93it/s]Test-loop:  15%|█▌        | 41/268 [00:03<00:18, 11.99it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:18, 12.05it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:18, 12.01it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:18, 11.97it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:18, 11.93it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:18, 11.92it/s]Test-loop:  20%|█▉        | 53/268 [00:04<00:18, 11.94it/s]Test-loop:  21%|██        | 55/268 [00:05<00:17, 11.89it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:17, 11.86it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:17, 11.88it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:17, 11.80it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:17, 11.69it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:17, 11.64it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:17, 11.64it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:16, 11.79it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:16, 11.81it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:16, 11.78it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:16, 11.76it/s]Test-loop:  29%|██▊       | 77/268 [00:06<00:16, 11.79it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:15, 12.19it/s]Test-loop:  30%|███       | 81/268 [00:07<00:14, 12.60it/s]Test-loop:  31%|███       | 83/268 [00:07<00:14, 12.76it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:14, 12.76it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:14, 12.54it/s]Test-loop:  33%|███▎      | 89/268 [00:07<00:14, 12.30it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:14, 12.13it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:14, 11.98it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:14, 11.91it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:14, 11.70it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:14, 11.74it/s]Test-loop:  38%|███▊      | 101/268 [00:08<00:14, 11.64it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:14, 11.76it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:13, 11.65it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:13, 11.62it/s]Test-loop:  41%|████      | 109/268 [00:09<00:13, 11.81it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:13, 11.74it/s]Test-loop:  42%|████▏     | 113/268 [00:09<00:13, 11.76it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:12, 11.89it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 11.77it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 11.67it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:12, 11.77it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:12, 11.89it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:12, 11.82it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 11.81it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 11.79it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 11.76it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:11, 11.79it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:11, 11.70it/s]Test-loop:  51%|█████     | 137/268 [00:11<00:11, 11.61it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:11, 11.57it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:11, 11.48it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:10, 11.92it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:09, 12.34it/s]Test-loop:  55%|█████▍    | 147/268 [00:12<00:09, 12.81it/s]Test-loop:  56%|█████▌    | 149/268 [00:12<00:09, 12.93it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:09, 12.74it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 12.44it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 12.20it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:09, 12.20it/s]Test-loop:  59%|█████▉    | 159/268 [00:13<00:09, 12.11it/s]Test-loop:  60%|██████    | 161/268 [00:13<00:08, 11.98it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:08, 11.92it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 11.85it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 11.82it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:08, 11.90it/s]Test-loop:  64%|██████▍   | 171/268 [00:14<00:08, 11.85it/s]Test-loop:  65%|██████▍   | 173/268 [00:14<00:07, 11.89it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:07, 11.84it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 11.92it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 12.04it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:07, 12.15it/s]Test-loop:  68%|██████▊   | 183/268 [00:15<00:06, 12.31it/s]Test-loop:  69%|██████▉   | 185/268 [00:15<00:06, 12.27it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 12.17it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 12.09it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 12.14it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:06, 12.02it/s]Test-loop:  73%|███████▎  | 195/268 [00:16<00:06, 12.00it/s]Test-loop:  74%|███████▎  | 197/268 [00:16<00:05, 11.98it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:05, 12.09it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 12.14it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 12.14it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 11.98it/s]Test-loop:  77%|███████▋  | 207/268 [00:17<00:05, 11.97it/s]Test-loop:  78%|███████▊  | 209/268 [00:17<00:04, 12.06it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 12.11it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 12.06it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 11.88it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:04, 11.82it/s]Test-loop:  82%|████████▏ | 219/268 [00:18<00:04, 11.88it/s]Test-loop:  82%|████████▏ | 221/268 [00:18<00:03, 11.82it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 11.76it/s]Test-loop:  84%|████████▍ | 225/268 [00:19<00:03, 11.92it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 12.03it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:03, 11.96it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:03, 12.17it/s]Test-loop:  87%|████████▋ | 233/268 [00:19<00:02, 12.04it/s]Test-loop:  88%|████████▊ | 235/268 [00:20<00:02, 12.19it/s]Test-loop:  88%|████████▊ | 237/268 [00:20<00:02, 12.03it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 11.91it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:02, 11.88it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:02, 11.94it/s]Test-loop:  91%|█████████▏| 245/268 [00:20<00:01, 11.89it/s]Test-loop:  92%|█████████▏| 247/268 [00:21<00:01, 11.99it/s]Test-loop:  93%|█████████▎| 249/268 [00:21<00:01, 11.96it/s]Test-loop:  94%|█████████▎| 251/268 [00:21<00:01, 12.02it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 12.09it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:01, 12.03it/s]Test-loop:  96%|█████████▌| 257/268 [00:21<00:00, 12.01it/s]Test-loop:  97%|█████████▋| 259/268 [00:22<00:00, 12.10it/s]Test-loop:  97%|█████████▋| 261/268 [00:22<00:00, 12.32it/s]Test-loop:  98%|█████████▊| 263/268 [00:22<00:00, 12.43it/s]Test-loop:  99%|█████████▉| 265/268 [00:22<00:00, 12.27it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 12.18it/s]Test-loop: 100%|██████████| 268/268 [00:22<00:00, 11.74it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:23,  1.31it/s]Test-loop:   1%|          | 3/268 [00:01<01:18,  3.40it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:53,  4.90it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:43,  5.97it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:39,  6.49it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:37,  6.84it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:36,  7.05it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:34,  7.29it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:33,  7.54it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:32,  7.63it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:32,  7.62it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:31,  7.81it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:30,  7.85it/s]Test-loop:  10%|█         | 27/268 [00:04<00:30,  7.87it/s]Test-loop:  11%|█         | 29/268 [00:04<00:30,  7.72it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:30,  7.83it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:30,  7.77it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:29,  7.90it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.75it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:29,  7.84it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:28,  7.98it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:28,  7.85it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:28,  7.83it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:27,  7.89it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:28,  7.73it/s]Test-loop:  19%|█▉        | 51/268 [00:07<00:28,  7.74it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:28,  7.67it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.73it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:27,  7.68it/s]Test-loop:  22%|██▏       | 59/268 [00:08<00:26,  7.95it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:26,  7.96it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:25,  7.98it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:25,  7.85it/s]Test-loop:  25%|██▌       | 67/268 [00:09<00:25,  7.91it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:25,  7.73it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:25,  7.77it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:25,  7.80it/s]Test-loop:  28%|██▊       | 75/268 [00:10<00:24,  7.72it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:24,  7.86it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  8.08it/s]Test-loop:  30%|███       | 81/268 [00:10<00:22,  8.22it/s]Test-loop:  31%|███       | 83/268 [00:11<00:22,  8.05it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:23,  7.90it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  7.94it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  7.90it/s]Test-loop:  34%|███▍      | 91/268 [00:12<00:23,  7.64it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:22,  7.81it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  7.95it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  7.95it/s]Test-loop:  37%|███▋      | 99/268 [00:13<00:20,  8.17it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.30it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  8.18it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:19,  8.18it/s]Test-loop:  40%|███▉      | 107/268 [00:14<00:19,  8.26it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.18it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  8.00it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:19,  8.00it/s]Test-loop:  43%|████▎     | 115/268 [00:15<00:19,  7.88it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:19,  7.90it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:18,  8.02it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:18,  8.14it/s]Test-loop:  46%|████▌     | 123/268 [00:16<00:18,  8.04it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:17,  7.97it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  8.03it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:17,  7.92it/s]Test-loop:  49%|████▉     | 131/268 [00:17<00:17,  7.79it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  7.95it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  7.99it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:16,  8.07it/s]Test-loop:  52%|█████▏    | 139/268 [00:18<00:15,  8.12it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:15,  8.11it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  8.11it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:14,  8.24it/s]Test-loop:  55%|█████▍    | 147/268 [00:19<00:14,  8.15it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  8.10it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  8.09it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:14,  8.01it/s]Test-loop:  58%|█████▊    | 155/268 [00:20<00:13,  8.17it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.17it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  8.16it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:12,  8.44it/s]Test-loop:  61%|██████    | 163/268 [00:21<00:12,  8.47it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:12,  8.29it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  8.11it/s]Test-loop:  63%|██████▎   | 169/268 [00:21<00:12,  8.07it/s]Test-loop:  64%|██████▍   | 171/268 [00:22<00:12,  8.08it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:11,  7.98it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  8.12it/s]Test-loop:  66%|██████▌   | 177/268 [00:22<00:11,  8.04it/s]Test-loop:  67%|██████▋   | 179/268 [00:23<00:11,  7.95it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:10,  8.17it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  8.25it/s]Test-loop:  69%|██████▉   | 185/268 [00:23<00:10,  8.25it/s]Test-loop:  70%|██████▉   | 187/268 [00:24<00:09,  8.29it/s]Test-loop:  71%|███████   | 189/268 [00:24<00:09,  8.06it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  8.14it/s]Test-loop:  72%|███████▏  | 193/268 [00:24<00:09,  8.24it/s]Test-loop:  73%|███████▎  | 195/268 [00:25<00:08,  8.36it/s]Test-loop:  74%|███████▎  | 197/268 [00:25<00:08,  8.36it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  8.29it/s]Test-loop:  75%|███████▌  | 201/268 [00:25<00:08,  8.09it/s]Test-loop:  76%|███████▌  | 203/268 [00:26<00:08,  8.00it/s]Test-loop:  76%|███████▋  | 205/268 [00:26<00:07,  7.88it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  7.85it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:07,  7.98it/s]Test-loop:  79%|███████▊  | 211/268 [00:27<00:07,  7.93it/s]Test-loop:  79%|███████▉  | 213/268 [00:27<00:06,  7.95it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  7.98it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:06,  8.03it/s]Test-loop:  82%|████████▏ | 219/268 [00:28<00:06,  8.02it/s]Test-loop:  82%|████████▏ | 221/268 [00:28<00:05,  8.01it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  8.07it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.06it/s]Test-loop:  85%|████████▍ | 227/268 [00:29<00:05,  8.13it/s]Test-loop:  85%|████████▌ | 228/268 [00:29<00:04,  8.33it/s]Test-loop:  85%|████████▌ | 229/268 [00:29<00:04,  7.87it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  8.04it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  8.04it/s]Test-loop:  88%|████████▊ | 235/268 [00:30<00:04,  7.98it/s]Test-loop:  88%|████████▊ | 237/268 [00:30<00:03,  8.04it/s]Test-loop:  89%|████████▉ | 238/268 [00:30<00:03,  8.19it/s]Test-loop:  89%|████████▉ | 239/268 [00:30<00:03,  8.10it/s]Test-loop:  90%|████████▉ | 240/268 [00:30<00:03,  8.11it/s]Test-loop:  90%|████████▉ | 241/268 [00:30<00:03,  8.26it/s]Test-loop:  90%|█████████ | 242/268 [00:30<00:03,  8.25it/s]Test-loop:  91%|█████████ | 243/268 [00:30<00:03,  8.21it/s]Test-loop:  91%|█████████ | 244/268 [00:31<00:02,  8.37it/s]Test-loop:  91%|█████████▏| 245/268 [00:31<00:03,  7.65it/s]Test-loop:  92%|█████████▏| 247/268 [00:31<00:02,  7.79it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  7.94it/s]Test-loop:  94%|█████████▎| 251/268 [00:31<00:02,  8.08it/s]Test-loop:  94%|█████████▍| 253/268 [00:32<00:01,  8.17it/s]Test-loop:  95%|█████████▍| 254/268 [00:32<00:01,  8.16it/s]Test-loop:  95%|█████████▌| 255/268 [00:32<00:01,  8.21it/s]Test-loop:  96%|█████████▌| 256/268 [00:32<00:01,  8.02it/s]Test-loop:  96%|█████████▌| 257/268 [00:32<00:01,  8.27it/s]Test-loop:  96%|█████████▋| 258/268 [00:32<00:01,  7.80it/s]Test-loop:  97%|█████████▋| 259/268 [00:32<00:01,  8.23it/s]Test-loop:  97%|█████████▋| 260/268 [00:33<00:01,  7.74it/s]Test-loop:  97%|█████████▋| 261/268 [00:33<00:00,  8.23it/s]Test-loop:  98%|█████████▊| 262/268 [00:33<00:00,  7.72it/s]Test-loop:  98%|█████████▊| 263/268 [00:33<00:00,  8.23it/s]Test-loop:  99%|█████████▊| 264/268 [00:33<00:00,  8.03it/s]Test-loop:  99%|█████████▉| 265/268 [00:33<00:00,  8.00it/s]Test-loop:  99%|█████████▉| 266/268 [00:33<00:00,  7.88it/s]Test-loop: 100%|█████████▉| 267/268 [00:33<00:00,  8.21it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  7.87it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3048/17100 [00:00<00:00, 30470.44it/s]Loading Data:  36%|███▌      | 6125/17100 [00:00<00:00, 30643.42it/s]Loading Data:  54%|█████▍    | 9204/17100 [00:00<00:00, 30706.88it/s]Loading Data:  72%|███████▏  | 12276/17100 [00:00<00:00, 30708.40it/s]Loading Data:  90%|████████▉ | 15347/17100 [00:00<00:00, 30659.70it/s]Loading Data: 100%|██████████| 17100/17100 [00:00<00:00, 30652.56it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 30026.14it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3006/17098 [00:00<00:00, 30050.93it/s]Loading Data:  35%|███▌      | 6047/17098 [00:00<00:00, 30260.65it/s]Loading Data:  53%|█████▎    | 9101/17098 [00:00<00:00, 30383.15it/s]Loading Data:  71%|███████   | 12156/17098 [00:00<00:00, 30445.47it/s]Loading Data:  89%|████████▉ | 15201/17098 [00:00<00:00, 30384.95it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30372.69it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:29,  1.48it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:10,  4.18it/s]Test-loop:  11%|█         | 5/45 [00:01<00:06,  6.18it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  7.87it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.04it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03,  9.87it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:03, 10.33it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 10.79it/s]Test-loop:  38%|███▊      | 17/45 [00:02<00:02, 11.06it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.35it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:02, 11.41it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 11.56it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 11.56it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 11.57it/s]Test-loop:  64%|██████▍   | 29/45 [00:03<00:01, 11.55it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 11.64it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.24it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.64it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 12.84it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.53it/s]Test-loop:  91%|█████████ | 41/45 [00:04<00:00, 12.34it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 12.20it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 13.12it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.36it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:57,  1.51it/s]Test-loop:   1%|          | 3/268 [00:00<01:03,  4.17it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:42,  6.13it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:33,  7.70it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:29,  8.79it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:26,  9.70it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:24, 10.49it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:22, 11.02it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:22, 11.30it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:21, 11.34it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:21, 11.35it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:21, 11.46it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:20, 11.59it/s]Test-loop:  10%|█         | 27/268 [00:02<00:20, 11.54it/s]Test-loop:  11%|█         | 29/268 [00:03<00:20, 11.60it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:20, 11.71it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:20, 11.70it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:19, 11.77it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:19, 11.70it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:19, 11.75it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:19, 11.67it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:19, 11.67it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:19, 11.57it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:19, 11.56it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:18, 11.58it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:18, 11.68it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:18, 11.73it/s]Test-loop:  21%|██        | 55/268 [00:05<00:18, 11.63it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:17, 11.73it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:17, 11.72it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:17, 11.73it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:17, 11.76it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:17, 11.76it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:16, 11.95it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:16, 12.41it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:15, 12.71it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:15, 12.91it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:15, 12.70it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:15, 12.39it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:15, 12.15it/s]Test-loop:  30%|███       | 81/268 [00:07<00:15, 11.93it/s]Test-loop:  31%|███       | 83/268 [00:07<00:15, 11.97it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:15, 11.94it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:15, 11.91it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:14, 12.03it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:14, 12.26it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:14, 12.35it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:14, 12.20it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:14, 12.07it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:14, 12.02it/s]Test-loop:  38%|███▊      | 101/268 [00:09<00:13, 12.04it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:13, 11.86it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:13, 11.85it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:13, 11.94it/s]Test-loop:  41%|████      | 109/268 [00:09<00:13, 11.98it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:12, 12.10it/s]Test-loop:  42%|████▏     | 113/268 [00:10<00:12, 12.07it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:12, 12.10it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 12.06it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 12.00it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:12, 12.19it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:11, 12.56it/s]Test-loop:  47%|████▋     | 125/268 [00:11<00:11, 12.91it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:10, 13.16it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:10, 12.76it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:10, 12.49it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:10, 12.32it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:10, 12.16it/s]Test-loop:  51%|█████     | 137/268 [00:12<00:10, 12.14it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:10, 12.13it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:10, 12.02it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:10, 12.07it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:10, 11.98it/s]Test-loop:  55%|█████▍    | 147/268 [00:12<00:10, 11.99it/s]Test-loop:  56%|█████▌    | 149/268 [00:13<00:09, 11.96it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:09, 12.00it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 11.99it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 11.99it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:09, 12.04it/s]Test-loop:  59%|█████▉    | 159/268 [00:13<00:09, 11.94it/s]Test-loop:  60%|██████    | 161/268 [00:14<00:08, 11.92it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:08, 12.06it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 12.14it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 12.12it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:08, 12.06it/s]Test-loop:  64%|██████▍   | 171/268 [00:14<00:08, 12.05it/s]Test-loop:  65%|██████▍   | 173/268 [00:15<00:07, 12.08it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:07, 12.14it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 12.08it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 12.00it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:07, 12.06it/s]Test-loop:  68%|██████▊   | 183/268 [00:15<00:07, 12.04it/s]Test-loop:  69%|██████▉   | 185/268 [00:16<00:06, 12.06it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 12.06it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 12.06it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 12.05it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:06, 12.05it/s]Test-loop:  73%|███████▎  | 195/268 [00:16<00:06, 12.03it/s]Test-loop:  74%|███████▎  | 197/268 [00:16<00:05, 11.99it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:05, 11.84it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 11.92it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 11.91it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 11.85it/s]Test-loop:  77%|███████▋  | 207/268 [00:17<00:05, 11.77it/s]Test-loop:  78%|███████▊  | 209/268 [00:18<00:05, 11.71it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 11.78it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 11.75it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 11.86it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:04, 11.85it/s]Test-loop:  82%|████████▏ | 219/268 [00:18<00:04, 11.86it/s]Test-loop:  82%|████████▏ | 221/268 [00:19<00:03, 11.83it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 11.82it/s]Test-loop:  84%|████████▍ | 225/268 [00:19<00:03, 11.90it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 11.97it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:03, 11.84it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:03, 11.80it/s]Test-loop:  87%|████████▋ | 233/268 [00:20<00:02, 11.80it/s]Test-loop:  88%|████████▊ | 235/268 [00:20<00:02, 12.29it/s]Test-loop:  88%|████████▊ | 237/268 [00:20<00:02, 12.61it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 13.01it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:02, 12.90it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:01, 12.72it/s]Test-loop:  91%|█████████▏| 245/268 [00:20<00:01, 12.43it/s]Test-loop:  92%|█████████▏| 247/268 [00:21<00:01, 12.19it/s]Test-loop:  93%|█████████▎| 249/268 [00:21<00:01, 12.18it/s]Test-loop:  94%|█████████▎| 251/268 [00:21<00:01, 12.22it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 12.29it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:01, 12.29it/s]Test-loop:  96%|█████████▌| 257/268 [00:21<00:00, 12.25it/s]Test-loop:  97%|█████████▋| 259/268 [00:22<00:00, 12.75it/s]Test-loop:  97%|█████████▋| 261/268 [00:22<00:00, 13.01it/s]Test-loop:  98%|█████████▊| 263/268 [00:22<00:00, 13.22it/s]Test-loop:  99%|█████████▉| 265/268 [00:22<00:00, 13.31it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 13.05it/s]Test-loop: 100%|██████████| 268/268 [00:22<00:00, 11.75it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:20,  1.33it/s]Test-loop:   1%|          | 3/268 [00:01<01:17,  3.43it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:54,  4.80it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:45,  5.78it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:40,  6.42it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:37,  6.85it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:35,  7.10it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:34,  7.33it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:33,  7.58it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:32,  7.74it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:31,  7.76it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:30,  7.93it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:30,  7.97it/s]Test-loop:  10%|█         | 27/268 [00:04<00:30,  7.94it/s]Test-loop:  11%|█         | 29/268 [00:04<00:30,  7.79it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:29,  7.91it/s]Test-loop:  12%|█▏        | 32/268 [00:04<00:28,  8.14it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:30,  7.71it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:29,  7.91it/s]Test-loop:  13%|█▎        | 36/268 [00:05<00:28,  8.26it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.74it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:29,  7.78it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:28,  8.06it/s]Test-loop:  16%|█▌        | 42/268 [00:05<00:27,  8.31it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:28,  7.92it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:28,  7.87it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:27,  7.99it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:27,  7.84it/s]Test-loop:  19%|█▉        | 51/268 [00:07<00:27,  7.82it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:27,  7.72it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.78it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:27,  7.72it/s]Test-loop:  22%|██▏       | 59/268 [00:08<00:26,  7.94it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:26,  7.91it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:25,  8.04it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:25,  7.93it/s]Test-loop:  25%|██▌       | 67/268 [00:09<00:25,  7.94it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:25,  7.78it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:25,  7.76it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:25,  7.75it/s]Test-loop:  28%|██▊       | 75/268 [00:10<00:24,  7.74it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:23,  8.00it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  8.13it/s]Test-loop:  30%|███       | 81/268 [00:10<00:22,  8.32it/s]Test-loop:  31%|███       | 83/268 [00:11<00:22,  8.39it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:22,  8.16it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  8.17it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:21,  8.23it/s]Test-loop:  34%|███▍      | 91/268 [00:12<00:22,  7.97it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:21,  8.01it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.14it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  8.07it/s]Test-loop:  37%|███▋      | 99/268 [00:13<00:20,  8.07it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.05it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  7.92it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:20,  7.95it/s]Test-loop:  40%|███▉      | 107/268 [00:14<00:19,  8.06it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.02it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  7.95it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:19,  8.02it/s]Test-loop:  43%|████▎     | 115/268 [00:15<00:19,  7.88it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:19,  7.81it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:18,  7.88it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:18,  8.12it/s]Test-loop:  46%|████▌     | 123/268 [00:16<00:18,  8.03it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:18,  7.93it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  7.99it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:17,  7.88it/s]Test-loop:  49%|████▉     | 131/268 [00:17<00:17,  7.79it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:17,  7.91it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  7.94it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:16,  8.01it/s]Test-loop:  52%|█████▏    | 139/268 [00:18<00:16,  8.03it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:15,  7.95it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  8.00it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:15,  8.20it/s]Test-loop:  55%|█████▍    | 147/268 [00:19<00:15,  8.06it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:15,  7.92it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  7.96it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:14,  7.93it/s]Test-loop:  58%|█████▊    | 155/268 [00:20<00:13,  8.08it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.08it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  7.97it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:13,  8.05it/s]Test-loop:  61%|██████    | 163/268 [00:21<00:13,  7.99it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:13,  7.90it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  7.87it/s]Test-loop:  63%|██████▎   | 169/268 [00:21<00:12,  7.89it/s]Test-loop:  64%|██████▍   | 171/268 [00:22<00:11,  8.13it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:11,  8.14it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  8.35it/s]Test-loop:  66%|██████▌   | 177/268 [00:22<00:11,  8.20it/s]Test-loop:  67%|██████▋   | 179/268 [00:23<00:10,  8.15it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:10,  8.30it/s]Test-loop:  68%|██████▊   | 182/268 [00:23<00:10,  8.34it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  8.26it/s]Test-loop:  69%|██████▊   | 184/268 [00:23<00:10,  8.00it/s]Test-loop:  69%|██████▉   | 185/268 [00:23<00:10,  8.25it/s]Test-loop:  69%|██████▉   | 186/268 [00:23<00:10,  7.67it/s]Test-loop:  70%|███████   | 188/268 [00:24<00:10,  7.60it/s]Test-loop:  71%|███████   | 190/268 [00:24<00:10,  7.80it/s]Test-loop:  72%|███████▏  | 192/268 [00:24<00:09,  7.91it/s]Test-loop:  72%|███████▏  | 194/268 [00:24<00:09,  7.83it/s]Test-loop:  73%|███████▎  | 196/268 [00:25<00:09,  7.91it/s]Test-loop:  74%|███████▍  | 198/268 [00:25<00:08,  8.02it/s]Test-loop:  75%|███████▍  | 200/268 [00:25<00:08,  7.88it/s]Test-loop:  75%|███████▌  | 202/268 [00:25<00:08,  8.02it/s]Test-loop:  76%|███████▌  | 203/268 [00:26<00:07,  8.20it/s]Test-loop:  76%|███████▌  | 204/268 [00:26<00:07,  8.08it/s]Test-loop:  76%|███████▋  | 205/268 [00:26<00:07,  7.95it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  8.04it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:07,  8.07it/s]Test-loop:  79%|███████▊  | 211/268 [00:27<00:07,  7.97it/s]Test-loop:  79%|███████▉  | 213/268 [00:27<00:06,  8.03it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  8.08it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:06,  8.10it/s]Test-loop:  81%|████████▏ | 218/268 [00:27<00:06,  8.30it/s]Test-loop:  82%|████████▏ | 219/268 [00:28<00:06,  8.00it/s]Test-loop:  82%|████████▏ | 220/268 [00:28<00:05,  8.23it/s]Test-loop:  82%|████████▏ | 221/268 [00:28<00:05,  7.93it/s]Test-loop:  83%|████████▎ | 222/268 [00:28<00:05,  8.20it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  7.85it/s]Test-loop:  84%|████████▎ | 224/268 [00:28<00:05,  8.25it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  7.88it/s]Test-loop:  84%|████████▍ | 226/268 [00:28<00:05,  8.34it/s]Test-loop:  85%|████████▍ | 227/268 [00:29<00:05,  7.90it/s]Test-loop:  85%|████████▌ | 228/268 [00:29<00:04,  8.10it/s]Test-loop:  85%|████████▌ | 229/268 [00:29<00:05,  7.57it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  7.75it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  7.80it/s]Test-loop:  88%|████████▊ | 235/268 [00:30<00:04,  7.83it/s]Test-loop:  88%|████████▊ | 236/268 [00:30<00:03,  8.15it/s]Test-loop:  88%|████████▊ | 237/268 [00:30<00:03,  7.84it/s]Test-loop:  89%|████████▉ | 238/268 [00:30<00:03,  8.00it/s]Test-loop:  89%|████████▉ | 239/268 [00:30<00:03,  7.96it/s]Test-loop:  90%|████████▉ | 240/268 [00:30<00:03,  8.07it/s]Test-loop:  90%|████████▉ | 241/268 [00:30<00:03,  8.02it/s]Test-loop:  90%|█████████ | 242/268 [00:30<00:03,  8.23it/s]Test-loop:  91%|█████████ | 243/268 [00:31<00:03,  7.94it/s]Test-loop:  91%|█████████ | 244/268 [00:31<00:02,  8.39it/s]Test-loop:  91%|█████████▏| 245/268 [00:31<00:03,  7.31it/s]Test-loop:  92%|█████████▏| 247/268 [00:31<00:02,  7.62it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  7.92it/s]Test-loop:  94%|█████████▎| 251/268 [00:32<00:02,  8.12it/s]Test-loop:  94%|█████████▍| 253/268 [00:32<00:01,  8.25it/s]Test-loop:  95%|█████████▌| 255/268 [00:32<00:01,  8.37it/s]Test-loop:  96%|█████████▌| 257/268 [00:32<00:01,  8.38it/s]Test-loop:  96%|█████████▋| 258/268 [00:32<00:01,  8.46it/s]Test-loop:  97%|█████████▋| 259/268 [00:33<00:01,  8.15it/s]Test-loop:  97%|█████████▋| 260/268 [00:33<00:00,  8.36it/s]Test-loop:  97%|█████████▋| 261/268 [00:33<00:00,  8.09it/s]Test-loop:  98%|█████████▊| 262/268 [00:33<00:00,  8.37it/s]Test-loop:  98%|█████████▊| 263/268 [00:33<00:00,  8.13it/s]Test-loop:  99%|█████████▉| 265/268 [00:33<00:00,  8.41it/s]Test-loop: 100%|█████████▉| 267/268 [00:33<00:00,  8.40it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  7.86it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3009/17100 [00:00<00:00, 30080.49it/s]Loading Data:  35%|███▌      | 6064/17100 [00:00<00:00, 30351.72it/s]Loading Data:  53%|█████▎    | 9143/17100 [00:00<00:00, 30550.46it/s]Loading Data:  71%|███████▏  | 12220/17100 [00:00<00:00, 30633.10it/s]Loading Data:  89%|████████▉ | 15284/17100 [00:00<00:00, 30622.51it/s]Loading Data: 100%|██████████| 17100/17100 [00:00<00:00, 30549.47it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 30326.89it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3015/17098 [00:00<00:00, 30149.38it/s]Loading Data:  35%|███▌      | 6059/17098 [00:00<00:00, 30316.82it/s]Loading Data:  53%|█████▎    | 9109/17098 [00:00<00:00, 30397.06it/s]Loading Data:  71%|███████   | 12151/17098 [00:00<00:00, 30403.24it/s]Loading Data:  89%|████████▉ | 15193/17098 [00:00<00:00, 30408.25it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30372.08it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:27,  1.61it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.59it/s]Test-loop:  11%|█         | 5/45 [00:00<00:05,  6.74it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.36it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.51it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.45it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 11.09it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.54it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 12.01it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 12.27it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 12.45it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 12.23it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.13it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 12.06it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 11.97it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 12.09it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.03it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.01it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 11.99it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.00it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 11.88it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 11.76it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 12.76it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.67it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:00,  1.48it/s]Test-loop:   1%|          | 3/268 [00:00<01:04,  4.11it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:43,  6.10it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:34,  7.59it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:29,  8.70it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:27,  9.48it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:25, 10.18it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:23, 10.70it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:23, 10.88it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:22, 11.06it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:21, 11.33it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:21, 11.40it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:21, 11.51it/s]Test-loop:  10%|█         | 27/268 [00:02<00:20, 11.73it/s]Test-loop:  11%|█         | 29/268 [00:03<00:20, 11.75it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:20, 11.81it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:19, 11.86it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:19, 11.87it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:19, 12.10it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:18, 12.23it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:18, 12.13it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:18, 11.89it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:18, 11.87it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:18, 11.86it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:18, 11.93it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:18, 11.98it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:17, 12.10it/s]Test-loop:  21%|██        | 55/268 [00:05<00:17, 12.05it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:17, 12.03it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:17, 12.00it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:17, 11.99it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:17, 11.99it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:16, 12.00it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:16, 11.97it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:16, 11.87it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:16, 11.92it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:16, 11.94it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:16, 11.87it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:16, 11.85it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:16, 11.71it/s]Test-loop:  30%|███       | 81/268 [00:07<00:15, 12.05it/s]Test-loop:  31%|███       | 83/268 [00:07<00:14, 12.51it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:14, 12.84it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:13, 13.12it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:13, 12.83it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:13, 12.68it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:13, 12.67it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:13, 12.47it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:13, 12.36it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:13, 12.25it/s]Test-loop:  38%|███▊      | 101/268 [00:09<00:13, 12.33it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:13, 12.30it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:13, 12.19it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:13, 12.26it/s]Test-loop:  41%|████      | 109/268 [00:09<00:13, 12.17it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:12, 12.08it/s]Test-loop:  42%|████▏     | 113/268 [00:10<00:12, 12.07it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:12, 12.29it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 12.32it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 12.37it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:11, 12.40it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:11, 12.43it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:11, 12.37it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 12.29it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 12.16it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 12.14it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:11, 12.15it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:10, 12.21it/s]Test-loop:  51%|█████     | 137/268 [00:11<00:10, 12.26it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:10, 12.31it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:10, 12.10it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:10, 12.08it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:10, 12.03it/s]Test-loop:  55%|█████▍    | 147/268 [00:12<00:10, 12.03it/s]Test-loop:  56%|█████▌    | 149/268 [00:12<00:09, 12.06it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:09, 12.17it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 12.19it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 11.94it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:10, 10.37it/s]Test-loop:  59%|█████▉    | 159/268 [00:13<00:10, 10.83it/s]Test-loop:  60%|██████    | 161/268 [00:14<00:09, 11.21it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:09, 11.36it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 11.50it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 11.62it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:08, 11.75it/s]Test-loop:  64%|██████▍   | 171/268 [00:14<00:08, 11.98it/s]Test-loop:  65%|██████▍   | 173/268 [00:15<00:07, 12.09it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:07, 12.14it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 12.17it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 12.17it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:07, 12.17it/s]Test-loop:  68%|██████▊   | 183/268 [00:15<00:06, 12.19it/s]Test-loop:  69%|██████▉   | 185/268 [00:16<00:06, 12.24it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 12.32it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 12.45it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 12.51it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:06, 12.47it/s]Test-loop:  73%|███████▎  | 195/268 [00:16<00:05, 12.37it/s]Test-loop:  74%|███████▎  | 197/268 [00:16<00:05, 12.39it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:05, 12.26it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 12.07it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 12.04it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 12.11it/s]Test-loop:  77%|███████▋  | 207/268 [00:17<00:05, 12.17it/s]Test-loop:  78%|███████▊  | 209/268 [00:17<00:04, 12.20it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 12.28it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 12.14it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 12.14it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:04, 12.08it/s]Test-loop:  82%|████████▏ | 219/268 [00:18<00:04, 12.03it/s]Test-loop:  82%|████████▏ | 221/268 [00:18<00:03, 12.09it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 12.66it/s]Test-loop:  84%|████████▍ | 225/268 [00:19<00:03, 12.93it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 13.22it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:02, 13.30it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:02, 13.55it/s]Test-loop:  87%|████████▋ | 233/268 [00:19<00:02, 13.70it/s]Test-loop:  88%|████████▊ | 235/268 [00:19<00:02, 13.79it/s]Test-loop:  88%|████████▊ | 237/268 [00:20<00:02, 13.27it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 12.83it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:02, 12.67it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:02, 12.34it/s]Test-loop:  91%|█████████▏| 245/268 [00:20<00:01, 12.30it/s]Test-loop:  92%|█████████▏| 247/268 [00:20<00:01, 12.25it/s]Test-loop:  93%|█████████▎| 249/268 [00:21<00:01, 12.29it/s]Test-loop:  94%|█████████▎| 251/268 [00:21<00:01, 12.17it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 12.43it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:01, 12.55it/s]Test-loop:  96%|█████████▌| 257/268 [00:21<00:00, 12.58it/s]Test-loop:  97%|█████████▋| 259/268 [00:21<00:00, 12.51it/s]Test-loop:  97%|█████████▋| 261/268 [00:22<00:00, 12.54it/s]Test-loop:  98%|█████████▊| 263/268 [00:22<00:00, 12.31it/s]Test-loop:  99%|█████████▉| 265/268 [00:22<00:00, 12.20it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 12.33it/s]Test-loop: 100%|██████████| 268/268 [00:22<00:00, 11.83it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:16,  1.36it/s]Test-loop:   1%|          | 3/268 [00:00<01:15,  3.49it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:53,  4.88it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:44,  5.89it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:39,  6.52it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:37,  6.94it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:35,  7.14it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:34,  7.31it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:33,  7.45it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:32,  7.69it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:31,  7.75it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:30,  7.99it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:30,  8.01it/s]Test-loop:  10%|█         | 27/268 [00:03<00:29,  8.26it/s]Test-loop:  10%|█         | 28/268 [00:04<00:28,  8.49it/s]Test-loop:  11%|█         | 29/268 [00:04<00:28,  8.30it/s]Test-loop:  11%|█         | 30/268 [00:04<00:27,  8.61it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:28,  8.44it/s]Test-loop:  12%|█▏        | 32/268 [00:04<00:29,  8.08it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:28,  8.22it/s]Test-loop:  13%|█▎        | 34/268 [00:04<00:29,  8.06it/s]Test-loop:  13%|█▎        | 35/268 [00:04<00:28,  8.20it/s]Test-loop:  13%|█▎        | 36/268 [00:05<00:29,  7.93it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.91it/s]Test-loop:  14%|█▍        | 38/268 [00:05<00:29,  7.89it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:28,  7.96it/s]Test-loop:  15%|█▍        | 40/268 [00:05<00:28,  7.88it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:27,  8.21it/s]Test-loop:  16%|█▌        | 42/268 [00:05<00:29,  7.67it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:27,  8.12it/s]Test-loop:  16%|█▋        | 44/268 [00:06<00:27,  8.11it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:28,  7.93it/s]Test-loop:  17%|█▋        | 46/268 [00:06<00:27,  7.96it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:27,  8.16it/s]Test-loop:  18%|█▊        | 48/268 [00:06<00:27,  8.01it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:28,  7.62it/s]Test-loop:  19%|█▊        | 50/268 [00:06<00:27,  7.90it/s]Test-loop:  19%|█▉        | 51/268 [00:06<00:27,  7.79it/s]Test-loop:  19%|█▉        | 52/268 [00:07<00:27,  8.00it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:28,  7.63it/s]Test-loop:  20%|██        | 54/268 [00:07<00:26,  8.03it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.71it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:27,  7.66it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:25,  8.06it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:24,  8.34it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:23,  8.62it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:23,  8.50it/s]Test-loop:  25%|██▍       | 66/268 [00:08<00:23,  8.61it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:24,  8.26it/s]Test-loop:  25%|██▌       | 68/268 [00:09<00:24,  8.32it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:25,  7.75it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:25,  7.73it/s]Test-loop:  27%|██▋       | 72/268 [00:09<00:24,  8.15it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:25,  7.69it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:24,  7.73it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:24,  7.91it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  7.97it/s]Test-loop:  30%|███       | 81/268 [00:10<00:23,  8.07it/s]Test-loop:  31%|███       | 83/268 [00:10<00:23,  8.01it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:23,  7.86it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  7.97it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  7.94it/s]Test-loop:  34%|███▍      | 91/268 [00:11<00:22,  7.74it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:22,  7.90it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.12it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  8.03it/s]Test-loop:  37%|███▋      | 99/268 [00:12<00:21,  7.99it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.00it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  7.95it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:20,  8.01it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:19,  8.15it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.10it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  8.00it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:19,  8.03it/s]Test-loop:  43%|████▎     | 115/268 [00:14<00:19,  7.96it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:19,  7.93it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:18,  8.01it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:17,  8.21it/s]Test-loop:  46%|████▌     | 123/268 [00:15<00:17,  8.17it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:17,  8.09it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  8.16it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:17,  8.04it/s]Test-loop:  49%|████▉     | 131/268 [00:16<00:17,  7.93it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  7.99it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  8.04it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:16,  8.06it/s]Test-loop:  52%|█████▏    | 139/268 [00:17<00:15,  8.14it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:15,  8.11it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  8.07it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:14,  8.23it/s]Test-loop:  55%|█████▍    | 147/268 [00:18<00:14,  8.20it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  8.11it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  8.17it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:13,  8.30it/s]Test-loop:  58%|█████▊    | 155/268 [00:19<00:13,  8.52it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.47it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  8.33it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:12,  8.38it/s]Test-loop:  61%|██████    | 163/268 [00:20<00:12,  8.35it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:12,  8.22it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  8.10it/s]Test-loop:  63%|██████▎   | 169/268 [00:21<00:12,  8.08it/s]Test-loop:  64%|██████▍   | 171/268 [00:21<00:12,  8.05it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:12,  7.82it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  8.05it/s]Test-loop:  66%|██████▌   | 177/268 [00:22<00:11,  8.01it/s]Test-loop:  67%|██████▋   | 179/268 [00:22<00:11,  7.89it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:10,  8.08it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  8.21it/s]Test-loop:  69%|██████▉   | 185/268 [00:23<00:09,  8.41it/s]Test-loop:  69%|██████▉   | 186/268 [00:23<00:09,  8.50it/s]Test-loop:  70%|██████▉   | 187/268 [00:23<00:09,  8.64it/s]Test-loop:  70%|███████   | 188/268 [00:23<00:09,  8.14it/s]Test-loop:  71%|███████   | 189/268 [00:24<00:09,  8.26it/s]Test-loop:  71%|███████   | 190/268 [00:24<00:09,  8.10it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  8.04it/s]Test-loop:  72%|███████▏  | 192/268 [00:24<00:09,  8.06it/s]Test-loop:  72%|███████▏  | 193/268 [00:24<00:09,  7.88it/s]Test-loop:  72%|███████▏  | 194/268 [00:24<00:09,  7.91it/s]Test-loop:  73%|███████▎  | 195/268 [00:24<00:09,  7.82it/s]Test-loop:  73%|███████▎  | 196/268 [00:24<00:09,  7.85it/s]Test-loop:  74%|███████▎  | 197/268 [00:25<00:08,  8.02it/s]Test-loop:  74%|███████▍  | 198/268 [00:25<00:08,  7.96it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  7.97it/s]Test-loop:  75%|███████▍  | 200/268 [00:25<00:08,  7.68it/s]Test-loop:  75%|███████▌  | 201/268 [00:25<00:08,  7.87it/s]Test-loop:  75%|███████▌  | 202/268 [00:25<00:08,  8.04it/s]Test-loop:  76%|███████▌  | 203/268 [00:25<00:08,  7.69it/s]Test-loop:  76%|███████▌  | 204/268 [00:25<00:07,  8.14it/s]Test-loop:  76%|███████▋  | 205/268 [00:26<00:08,  7.50it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  7.65it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:07,  7.83it/s]Test-loop:  79%|███████▊  | 211/268 [00:26<00:07,  7.88it/s]Test-loop:  79%|███████▉  | 213/268 [00:27<00:06,  7.94it/s]Test-loop:  80%|███████▉  | 214/268 [00:27<00:06,  8.27it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  8.00it/s]Test-loop:  81%|████████  | 216/268 [00:27<00:06,  8.36it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:06,  8.01it/s]Test-loop:  81%|████████▏ | 218/268 [00:27<00:06,  8.05it/s]Test-loop:  82%|████████▏ | 219/268 [00:27<00:06,  8.13it/s]Test-loop:  82%|████████▏ | 220/268 [00:27<00:06,  7.97it/s]Test-loop:  82%|████████▏ | 221/268 [00:28<00:05,  8.13it/s]Test-loop:  83%|████████▎ | 222/268 [00:28<00:05,  7.97it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  8.16it/s]Test-loop:  84%|████████▎ | 224/268 [00:28<00:05,  7.76it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.09it/s]Test-loop:  84%|████████▍ | 226/268 [00:28<00:05,  7.76it/s]Test-loop:  85%|████████▍ | 227/268 [00:28<00:04,  8.22it/s]Test-loop:  85%|████████▌ | 228/268 [00:28<00:05,  7.62it/s]Test-loop:  85%|████████▌ | 229/268 [00:29<00:04,  8.09it/s]Test-loop:  86%|████████▌ | 230/268 [00:29<00:04,  8.06it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  8.24it/s]Test-loop:  87%|████████▋ | 232/268 [00:29<00:04,  7.98it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  8.19it/s]Test-loop:  87%|████████▋ | 234/268 [00:29<00:04,  7.88it/s]Test-loop:  88%|████████▊ | 235/268 [00:29<00:04,  8.16it/s]Test-loop:  88%|████████▊ | 236/268 [00:29<00:04,  7.81it/s]Test-loop:  89%|████████▉ | 238/268 [00:30<00:03,  7.75it/s]Test-loop:  90%|████████▉ | 240/268 [00:30<00:03,  7.78it/s]Test-loop:  90%|█████████ | 242/268 [00:30<00:03,  7.95it/s]Test-loop:  91%|█████████ | 244/268 [00:30<00:02,  8.09it/s]Test-loop:  91%|█████████▏| 245/268 [00:31<00:02,  8.15it/s]Test-loop:  92%|█████████▏| 246/268 [00:31<00:02,  8.39it/s]Test-loop:  92%|█████████▏| 247/268 [00:31<00:02,  8.10it/s]Test-loop:  93%|█████████▎| 248/268 [00:31<00:02,  8.50it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  8.45it/s]Test-loop:  93%|█████████▎| 250/268 [00:31<00:02,  8.71it/s]Test-loop:  94%|█████████▎| 251/268 [00:31<00:01,  8.76it/s]Test-loop:  94%|█████████▍| 252/268 [00:31<00:01,  8.72it/s]Test-loop:  95%|█████████▍| 254/268 [00:32<00:01,  8.28it/s]Test-loop:  96%|█████████▌| 256/268 [00:32<00:01,  8.21it/s]Test-loop:  96%|█████████▋| 258/268 [00:32<00:01,  8.05it/s]Test-loop:  97%|█████████▋| 260/268 [00:32<00:00,  8.03it/s]Test-loop:  98%|█████████▊| 262/268 [00:33<00:00,  8.03it/s]Test-loop:  99%|█████████▊| 264/268 [00:33<00:00,  8.17it/s]Test-loop:  99%|█████████▉| 266/268 [00:33<00:00,  8.09it/s]Test-loop: 100%|██████████| 268/268 [00:33<00:00,  9.54it/s]Test-loop: 100%|██████████| 268/268 [00:33<00:00,  7.94it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:  17%|█▋        | 2976/17100 [00:00<00:00, 29756.69it/s]Loading Data:  35%|███▌      | 6022/17100 [00:00<00:00, 30165.24it/s]Loading Data:  53%|█████▎    | 9083/17100 [00:00<00:00, 30364.91it/s]Loading Data:  71%|███████   | 12134/17100 [00:00<00:00, 30421.79it/s]Loading Data:  89%|████████▉ | 15177/17100 [00:00<00:00, 30411.43it/s]Loading Data: 100%|██████████| 17100/17100 [00:00<00:00, 30343.94it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 30345.21it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 2994/17098 [00:00<00:00, 29931.47it/s]Loading Data:  35%|███▌      | 6022/17098 [00:00<00:00, 30132.21it/s]Loading Data:  53%|█████▎    | 9054/17098 [00:00<00:00, 30215.66it/s]Loading Data:  71%|███████   | 12081/17098 [00:00<00:00, 30234.73it/s]Loading Data:  88%|████████▊ | 15105/17098 [00:00<00:00, 30224.20it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30219.57it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:30,  1.44it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:10,  4.11it/s]Test-loop:  11%|█         | 5/45 [00:01<00:06,  6.19it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  7.77it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.03it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.09it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 10.90it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.43it/s]Test-loop:  38%|███▊      | 17/45 [00:02<00:02, 11.51it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.57it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:02, 11.61it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 11.77it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 11.90it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 11.97it/s]Test-loop:  64%|██████▍   | 29/45 [00:03<00:01, 12.02it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 12.03it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.05it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 11.99it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 11.99it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 11.94it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.06it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 11.90it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 12.88it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.37it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:02,  1.46it/s]Test-loop:   1%|          | 3/268 [00:00<01:04,  4.08it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:43,  6.09it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:34,  7.62it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:29,  8.78it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:26,  9.68it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:24, 10.22it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:23, 10.66it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:22, 11.06it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:22, 11.29it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:21, 11.45it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:21, 11.66it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:20, 11.80it/s]Test-loop:  10%|█         | 27/268 [00:02<00:20, 11.87it/s]Test-loop:  11%|█         | 29/268 [00:03<00:20, 11.86it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:19, 11.88it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:19, 11.86it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:19, 11.89it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:19, 12.01it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:18, 12.15it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:18, 12.28it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:18, 12.33it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:18, 12.29it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:18, 12.26it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:17, 12.19it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:17, 12.13it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:17, 12.02it/s]Test-loop:  21%|██        | 55/268 [00:05<00:17, 11.99it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:17, 11.97it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:17, 12.08it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:17, 12.08it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:16, 12.09it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:16, 12.14it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:16, 12.03it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:16, 11.89it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:16, 11.73it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:16, 11.78it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:16, 11.79it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:16, 11.90it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:15, 11.98it/s]Test-loop:  30%|███       | 81/268 [00:07<00:15, 12.09it/s]Test-loop:  31%|███       | 83/268 [00:07<00:14, 12.65it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:14, 12.98it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:13, 13.19it/s]Test-loop:  33%|███▎      | 89/268 [00:07<00:13, 13.05it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:13, 12.90it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:13, 12.75it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:13, 12.78it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:13, 12.67it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:13, 12.41it/s]Test-loop:  38%|███▊      | 101/268 [00:08<00:13, 12.40it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:13, 12.26it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:13, 12.33it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:12, 12.42it/s]Test-loop:  41%|████      | 109/268 [00:09<00:12, 12.31it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:12, 12.33it/s]Test-loop:  42%|████▏     | 113/268 [00:09<00:12, 12.23it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:12, 12.21it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 12.16it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 12.11it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:12, 12.22it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:11, 12.34it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:11, 12.31it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 12.19it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 12.11it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 12.14it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:11, 12.17it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:11, 12.08it/s]Test-loop:  51%|█████     | 137/268 [00:11<00:10, 12.06it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:10, 12.19it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:10, 12.05it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:10, 12.08it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:10, 11.99it/s]Test-loop:  55%|█████▍    | 147/268 [00:12<00:10, 11.94it/s]Test-loop:  56%|█████▌    | 149/268 [00:12<00:09, 12.01it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:09, 12.02it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 12.05it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 12.11it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:09, 12.13it/s]Test-loop:  59%|█████▉    | 159/268 [00:13<00:08, 12.12it/s]Test-loop:  60%|██████    | 161/268 [00:13<00:08, 12.05it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:08, 12.17it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 12.19it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 12.16it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:08, 12.31it/s]Test-loop:  64%|██████▍   | 171/268 [00:14<00:07, 12.30it/s]Test-loop:  65%|██████▍   | 173/268 [00:14<00:07, 12.31it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:07, 12.16it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 12.13it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 12.19it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:07, 12.12it/s]Test-loop:  68%|██████▊   | 183/268 [00:15<00:06, 12.21it/s]Test-loop:  69%|██████▉   | 185/268 [00:15<00:06, 12.34it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 12.32it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 12.44it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 12.42it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:06, 12.49it/s]Test-loop:  73%|███████▎  | 195/268 [00:16<00:05, 12.44it/s]Test-loop:  74%|███████▎  | 197/268 [00:16<00:05, 12.43it/s]Test-loop:  74%|███████▍  | 199/268 [00:16<00:05, 12.20it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 12.31it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 12.33it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 12.35it/s]Test-loop:  77%|███████▋  | 207/268 [00:17<00:04, 12.39it/s]Test-loop:  78%|███████▊  | 209/268 [00:17<00:04, 12.46it/s]Test-loop:  79%|███████▊  | 211/268 [00:17<00:04, 12.51it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 12.40it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 12.62it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:03, 12.81it/s]Test-loop:  82%|████████▏ | 219/268 [00:18<00:03, 13.07it/s]Test-loop:  82%|████████▏ | 221/268 [00:18<00:03, 13.36it/s]Test-loop:  83%|████████▎ | 223/268 [00:18<00:03, 13.53it/s]Test-loop:  84%|████████▍ | 225/268 [00:18<00:03, 13.70it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 13.37it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:02, 13.17it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:02, 13.02it/s]Test-loop:  87%|████████▋ | 233/268 [00:19<00:02, 12.89it/s]Test-loop:  88%|████████▊ | 235/268 [00:19<00:02, 12.73it/s]Test-loop:  88%|████████▊ | 237/268 [00:19<00:02, 12.93it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 13.35it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:01, 13.60it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:01, 13.80it/s]Test-loop:  91%|█████████▏| 245/268 [00:20<00:01, 13.37it/s]Test-loop:  92%|█████████▏| 247/268 [00:20<00:01, 13.41it/s]Test-loop:  93%|█████████▎| 249/268 [00:20<00:01, 13.75it/s]Test-loop:  94%|█████████▎| 251/268 [00:20<00:01, 13.92it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 14.13it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:00, 13.96it/s]Test-loop:  96%|█████████▌| 257/268 [00:21<00:00, 13.63it/s]Test-loop:  97%|█████████▋| 259/268 [00:21<00:00, 13.32it/s]Test-loop:  97%|█████████▋| 261/268 [00:21<00:00, 13.21it/s]Test-loop:  98%|█████████▊| 263/268 [00:21<00:00, 13.13it/s]Test-loop:  99%|█████████▉| 265/268 [00:21<00:00, 12.97it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 12.71it/s]Test-loop: 100%|██████████| 268/268 [00:22<00:00, 12.05it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:27,  1.29it/s]Test-loop:   1%|          | 3/268 [00:01<01:18,  3.37it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:55,  4.74it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:45,  5.78it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:40,  6.42it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:37,  6.89it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:35,  7.16it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:33,  7.48it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:32,  7.70it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:31,  7.81it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:31,  7.80it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:30,  7.99it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:30,  7.91it/s]Test-loop:  10%|█         | 27/268 [00:04<00:30,  7.95it/s]Test-loop:  11%|█         | 29/268 [00:04<00:30,  7.85it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:29,  8.01it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:29,  7.96it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:28,  8.03it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.94it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:28,  7.91it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:28,  8.07it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:28,  7.99it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:27,  8.03it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:27,  8.10it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:27,  7.94it/s]Test-loop:  19%|█▉        | 51/268 [00:07<00:27,  7.94it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:27,  7.85it/s]Test-loop:  21%|██        | 55/268 [00:07<00:26,  8.12it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:25,  8.18it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:24,  8.57it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:24,  8.44it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:24,  8.43it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:24,  8.21it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:24,  8.22it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:24,  7.99it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:24,  7.95it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:24,  7.89it/s]Test-loop:  28%|██▊       | 75/268 [00:10<00:24,  7.82it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:24,  7.85it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:24,  7.85it/s]Test-loop:  30%|███       | 81/268 [00:10<00:23,  7.94it/s]Test-loop:  31%|███       | 83/268 [00:11<00:23,  7.89it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:23,  7.82it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  7.95it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  7.91it/s]Test-loop:  34%|███▍      | 91/268 [00:12<00:23,  7.69it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:22,  7.87it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.04it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  7.97it/s]Test-loop:  37%|███▋      | 99/268 [00:13<00:20,  8.05it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.05it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  7.90it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:20,  7.93it/s]Test-loop:  40%|███▉      | 107/268 [00:14<00:20,  8.05it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.04it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  7.97it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:19,  8.05it/s]Test-loop:  43%|████▎     | 115/268 [00:15<00:19,  7.91it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:19,  7.80it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:18,  7.86it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:18,  8.00it/s]Test-loop:  46%|████▌     | 123/268 [00:16<00:18,  8.00it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:18,  7.93it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  8.01it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:17,  8.02it/s]Test-loop:  49%|████▉     | 131/268 [00:17<00:17,  8.00it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.12it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  8.21it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:15,  8.24it/s]Test-loop:  52%|█████▏    | 139/268 [00:17<00:15,  8.25it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:15,  8.16it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  8.25it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:14,  8.56it/s]Test-loop:  55%|█████▍    | 147/268 [00:18<00:14,  8.57it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  8.36it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  8.32it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:14,  8.21it/s]Test-loop:  58%|█████▊    | 155/268 [00:19<00:13,  8.25it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.18it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  8.04it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:13,  8.07it/s]Test-loop:  61%|██████    | 163/268 [00:20<00:13,  7.97it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:13,  7.86it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  7.83it/s]Test-loop:  63%|██████▎   | 169/268 [00:21<00:12,  7.87it/s]Test-loop:  64%|██████▍   | 171/268 [00:21<00:12,  7.89it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:12,  7.76it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  8.02it/s]Test-loop:  66%|██████▌   | 177/268 [00:22<00:11,  7.93it/s]Test-loop:  67%|██████▋   | 179/268 [00:22<00:11,  7.93it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:10,  8.22it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  8.30it/s]Test-loop:  69%|██████▉   | 185/268 [00:23<00:10,  8.24it/s]Test-loop:  69%|██████▉   | 186/268 [00:23<00:09,  8.29it/s]Test-loop:  70%|██████▉   | 187/268 [00:23<00:09,  8.22it/s]Test-loop:  70%|███████   | 188/268 [00:24<00:09,  8.06it/s]Test-loop:  71%|███████   | 189/268 [00:24<00:09,  8.23it/s]Test-loop:  71%|███████   | 190/268 [00:24<00:09,  8.62it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  8.34it/s]Test-loop:  72%|███████▏  | 193/268 [00:24<00:09,  8.30it/s]Test-loop:  73%|███████▎  | 195/268 [00:24<00:08,  8.18it/s]Test-loop:  74%|███████▎  | 197/268 [00:25<00:08,  8.25it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  8.27it/s]Test-loop:  75%|███████▍  | 200/268 [00:25<00:08,  8.38it/s]Test-loop:  75%|███████▌  | 201/268 [00:25<00:08,  7.97it/s]Test-loop:  76%|███████▌  | 203/268 [00:25<00:08,  7.94it/s]Test-loop:  76%|███████▋  | 205/268 [00:26<00:08,  7.85it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  7.82it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:07,  7.92it/s]Test-loop:  79%|███████▊  | 211/268 [00:26<00:07,  7.85it/s]Test-loop:  79%|███████▉  | 213/268 [00:27<00:06,  7.86it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  7.90it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:06,  7.95it/s]Test-loop:  82%|████████▏ | 219/268 [00:27<00:06,  8.01it/s]Test-loop:  82%|████████▏ | 221/268 [00:28<00:05,  8.02it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  8.06it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.04it/s]Test-loop:  85%|████████▍ | 227/268 [00:28<00:05,  8.05it/s]Test-loop:  85%|████████▌ | 229/268 [00:29<00:04,  7.88it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  7.93it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  7.88it/s]Test-loop:  88%|████████▊ | 235/268 [00:29<00:04,  7.82it/s]Test-loop:  88%|████████▊ | 237/268 [00:30<00:03,  8.03it/s]Test-loop:  89%|████████▉ | 239/268 [00:30<00:03,  8.33it/s]Test-loop:  90%|████████▉ | 241/268 [00:30<00:03,  8.53it/s]Test-loop:  91%|█████████ | 243/268 [00:30<00:02,  8.42it/s]Test-loop:  91%|█████████▏| 245/268 [00:31<00:02,  8.04it/s]Test-loop:  92%|█████████▏| 247/268 [00:31<00:02,  8.10it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  8.20it/s]Test-loop:  94%|█████████▎| 251/268 [00:31<00:02,  8.34it/s]Test-loop:  94%|█████████▍| 253/268 [00:32<00:01,  8.37it/s]Test-loop:  95%|█████████▌| 255/268 [00:32<00:01,  8.35it/s]Test-loop:  96%|█████████▌| 257/268 [00:32<00:01,  8.38it/s]Test-loop:  97%|█████████▋| 259/268 [00:32<00:01,  8.18it/s]Test-loop:  97%|█████████▋| 261/268 [00:33<00:00,  8.15it/s]Test-loop:  98%|█████████▊| 263/268 [00:33<00:00,  8.03it/s]Test-loop:  99%|█████████▉| 265/268 [00:33<00:00,  8.04it/s]Test-loop: 100%|█████████▉| 267/268 [00:33<00:00,  7.95it/s]Test-loop: 100%|██████████| 268/268 [00:33<00:00,  7.90it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 2998/17100 [00:00<00:00, 29974.53it/s]Loading Data:  35%|███▌      | 6040/17100 [00:00<00:00, 30232.58it/s]Loading Data:  53%|█████▎    | 9112/17100 [00:00<00:00, 30453.71it/s]Loading Data:  71%|███████   | 12171/17100 [00:00<00:00, 30505.08it/s]Loading Data:  89%|████████▉ | 15227/17100 [00:00<00:00, 30521.54it/s]Loading Data: 100%|██████████| 17100/17100 [00:00<00:00, 30450.17it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 30258.18it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3014/17098 [00:00<00:00, 30132.13it/s]Loading Data:  35%|███▌      | 6051/17098 [00:00<00:00, 30266.79it/s]Loading Data:  53%|█████▎    | 9095/17098 [00:00<00:00, 30342.02it/s]Loading Data:  71%|███████   | 12142/17098 [00:00<00:00, 30389.52it/s]Loading Data:  89%|████████▉ | 15181/17098 [00:00<00:00, 30326.93it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30303.27it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:29,  1.49it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.30it/s]Test-loop:  11%|█         | 5/45 [00:00<00:06,  6.51it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.10it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.20it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.04it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 10.75it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.27it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 11.65it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.96it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 12.03it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 12.05it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.07it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 12.07it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 12.03it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 12.02it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.11it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.01it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 12.10it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.20it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.15it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 12.16it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 13.09it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.54it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:01,  1.47it/s]Test-loop:   1%|          | 3/268 [00:00<01:04,  4.09it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:41,  6.27it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:33,  7.89it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:28,  9.16it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:25, 10.08it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:23, 10.74it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:22, 11.15it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:22, 11.37it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:21, 11.52it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:21, 11.65it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:20, 11.69it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:20, 11.79it/s]Test-loop:  10%|█         | 27/268 [00:02<00:20, 11.90it/s]Test-loop:  11%|█         | 29/268 [00:03<00:20, 11.87it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:19, 11.95it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:19, 12.02it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:19, 12.02it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:18, 12.18it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:18, 12.71it/s]Test-loop:  15%|█▌        | 41/268 [00:03<00:17, 13.00it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:16, 13.43it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:17, 13.08it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:17, 12.93it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:17, 12.73it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:17, 12.69it/s]Test-loop:  20%|█▉        | 53/268 [00:04<00:17, 12.53it/s]Test-loop:  21%|██        | 55/268 [00:05<00:16, 12.56it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:16, 12.45it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:16, 12.46it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:16, 12.51it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:15, 12.84it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:15, 13.18it/s]Test-loop:  25%|██▌       | 67/268 [00:05<00:15, 13.35it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:14, 13.49it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:14, 13.22it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:15, 12.81it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:15, 12.66it/s]Test-loop:  29%|██▊       | 77/268 [00:06<00:15, 12.43it/s]Test-loop:  29%|██▉       | 79/268 [00:06<00:15, 12.43it/s]Test-loop:  30%|███       | 81/268 [00:07<00:15, 12.30it/s]Test-loop:  31%|███       | 83/268 [00:07<00:15, 12.25it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:14, 12.20it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:14, 12.15it/s]Test-loop:  33%|███▎      | 89/268 [00:07<00:14, 12.44it/s]Test-loop:  34%|███▍      | 91/268 [00:07<00:14, 12.62it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:13, 12.66it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:13, 12.58it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:13, 12.45it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:13, 12.36it/s]Test-loop:  38%|███▊      | 101/268 [00:08<00:13, 12.34it/s]Test-loop:  38%|███▊      | 103/268 [00:08<00:13, 12.31it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:13, 12.07it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:13, 12.00it/s]Test-loop:  41%|████      | 109/268 [00:09<00:13, 12.09it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:12, 12.10it/s]Test-loop:  42%|████▏     | 113/268 [00:09<00:12, 12.03it/s]Test-loop:  43%|████▎     | 115/268 [00:09<00:12, 12.11it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 12.06it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 12.14it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:12, 12.01it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:12, 12.02it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:11, 11.93it/s]Test-loop:  47%|████▋     | 127/268 [00:10<00:11, 11.81it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 11.80it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 11.97it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:11, 11.94it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:11, 11.91it/s]Test-loop:  51%|█████     | 137/268 [00:11<00:10, 11.91it/s]Test-loop:  52%|█████▏    | 139/268 [00:11<00:10, 12.00it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:10, 12.01it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:10, 12.09it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:10, 12.25it/s]Test-loop:  55%|█████▍    | 147/268 [00:12<00:09, 12.11it/s]Test-loop:  56%|█████▌    | 149/268 [00:12<00:09, 12.06it/s]Test-loop:  56%|█████▋    | 151/268 [00:12<00:09, 12.09it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 12.09it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 12.10it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:09, 12.09it/s]Test-loop:  59%|█████▉    | 159/268 [00:13<00:09, 12.01it/s]Test-loop:  60%|██████    | 161/268 [00:13<00:08, 12.07it/s]Test-loop:  61%|██████    | 163/268 [00:13<00:08, 12.10it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 12.10it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 12.14it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:08, 12.29it/s]Test-loop:  64%|██████▍   | 171/268 [00:14<00:07, 12.22it/s]Test-loop:  65%|██████▍   | 173/268 [00:14<00:07, 12.14it/s]Test-loop:  65%|██████▌   | 175/268 [00:14<00:07, 12.17it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 12.21it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:06, 12.73it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:06, 13.14it/s]Test-loop:  68%|██████▊   | 183/268 [00:15<00:06, 13.53it/s]Test-loop:  69%|██████▉   | 185/268 [00:15<00:06, 13.41it/s]Test-loop:  70%|██████▉   | 187/268 [00:15<00:06, 13.00it/s]Test-loop:  71%|███████   | 189/268 [00:15<00:06, 12.85it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 12.57it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:05, 12.51it/s]Test-loop:  73%|███████▎  | 195/268 [00:16<00:05, 12.44it/s]Test-loop:  74%|███████▎  | 197/268 [00:16<00:05, 12.41it/s]Test-loop:  74%|███████▍  | 199/268 [00:16<00:05, 12.19it/s]Test-loop:  75%|███████▌  | 201/268 [00:16<00:05, 12.16it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 12.07it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 12.18it/s]Test-loop:  77%|███████▋  | 207/268 [00:17<00:04, 12.21it/s]Test-loop:  78%|███████▊  | 209/268 [00:17<00:04, 12.12it/s]Test-loop:  79%|███████▊  | 211/268 [00:17<00:04, 12.14it/s]Test-loop:  79%|███████▉  | 213/268 [00:17<00:04, 12.13it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 12.08it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:04, 12.11it/s]Test-loop:  82%|████████▏ | 219/268 [00:18<00:04, 12.16it/s]Test-loop:  82%|████████▏ | 221/268 [00:18<00:03, 12.25it/s]Test-loop:  83%|████████▎ | 223/268 [00:18<00:03, 12.17it/s]Test-loop:  84%|████████▍ | 225/268 [00:18<00:03, 12.12it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 12.01it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:03, 12.14it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:03, 12.21it/s]Test-loop:  87%|████████▋ | 233/268 [00:19<00:02, 12.19it/s]Test-loop:  88%|████████▊ | 235/268 [00:19<00:02, 12.25it/s]Test-loop:  88%|████████▊ | 237/268 [00:19<00:02, 12.26it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 12.34it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:02, 12.22it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:02, 12.11it/s]Test-loop:  91%|█████████▏| 245/268 [00:20<00:01, 12.09it/s]Test-loop:  92%|█████████▏| 247/268 [00:20<00:01, 12.10it/s]Test-loop:  93%|█████████▎| 249/268 [00:20<00:01, 12.04it/s]Test-loop:  94%|█████████▎| 251/268 [00:21<00:01, 11.98it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 12.17it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:01, 12.12it/s]Test-loop:  96%|█████████▌| 257/268 [00:21<00:00, 12.16it/s]Test-loop:  97%|█████████▋| 259/268 [00:21<00:00, 12.16it/s]Test-loop:  97%|█████████▋| 261/268 [00:21<00:00, 12.21it/s]Test-loop:  98%|█████████▊| 263/268 [00:22<00:00, 12.19it/s]Test-loop:  99%|█████████▉| 265/268 [00:22<00:00, 12.32it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 12.22it/s]Test-loop: 100%|██████████| 268/268 [00:22<00:00, 11.95it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:21,  1.32it/s]Test-loop:   1%|          | 3/268 [00:01<01:17,  3.41it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:54,  4.82it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:44,  5.83it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:40,  6.37it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:37,  6.80it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:36,  7.06it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:34,  7.34it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:33,  7.55it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:32,  7.69it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:32,  7.71it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:30,  7.92it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:29,  8.11it/s]Test-loop:  10%|█         | 27/268 [00:04<00:28,  8.35it/s]Test-loop:  11%|█         | 29/268 [00:04<00:29,  8.24it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:28,  8.30it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:28,  8.12it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:28,  8.04it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.91it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:28,  7.91it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:28,  8.10it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:28,  7.99it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:27,  8.06it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:26,  8.26it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:27,  8.00it/s]Test-loop:  19%|█▉        | 51/268 [00:06<00:27,  8.01it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:27,  7.89it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.87it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:27,  7.75it/s]Test-loop:  22%|██▏       | 59/268 [00:08<00:25,  8.04it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:25,  8.02it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:25,  8.07it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:25,  7.94it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:24,  8.26it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:24,  8.22it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:24,  8.12it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:24,  8.04it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:23,  8.14it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:22,  8.36it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:22,  8.29it/s]Test-loop:  30%|███       | 81/268 [00:10<00:22,  8.24it/s]Test-loop:  31%|███       | 83/268 [00:10<00:22,  8.09it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:22,  7.97it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  8.08it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  8.09it/s]Test-loop:  34%|███▍      | 91/268 [00:11<00:22,  7.90it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:21,  8.04it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.18it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  8.11it/s]Test-loop:  37%|███▋      | 99/268 [00:12<00:20,  8.14it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.15it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  8.00it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:20,  7.95it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:19,  8.09it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.09it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  7.94it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:19,  8.00it/s]Test-loop:  43%|████▎     | 115/268 [00:14<00:18,  8.10it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:18,  8.22it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:18,  8.12it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:17,  8.29it/s]Test-loop:  46%|████▌     | 123/268 [00:15<00:17,  8.20it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:17,  8.06it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  8.12it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:17,  8.08it/s]Test-loop:  49%|████▉     | 131/268 [00:16<00:17,  7.99it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.11it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  8.18it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:15,  8.28it/s]Test-loop:  52%|█████▏    | 139/268 [00:17<00:15,  8.28it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:15,  8.27it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  8.20it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:14,  8.34it/s]Test-loop:  55%|█████▍    | 147/268 [00:18<00:14,  8.21it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  8.04it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  8.08it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:14,  8.10it/s]Test-loop:  58%|█████▊    | 155/268 [00:19<00:13,  8.23it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.20it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  8.13it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:13,  8.19it/s]Test-loop:  61%|██████    | 163/268 [00:20<00:12,  8.21it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:12,  8.25it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  8.15it/s]Test-loop:  63%|██████▎   | 169/268 [00:21<00:12,  8.13it/s]Test-loop:  64%|██████▍   | 171/268 [00:21<00:11,  8.15it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:11,  8.03it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  8.26it/s]Test-loop:  66%|██████▌   | 177/268 [00:22<00:11,  8.18it/s]Test-loop:  67%|██████▋   | 179/268 [00:22<00:11,  8.09it/s]Test-loop:  68%|██████▊   | 181/268 [00:22<00:10,  8.26it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  8.41it/s]Test-loop:  69%|██████▉   | 185/268 [00:23<00:09,  8.41it/s]Test-loop:  70%|██████▉   | 187/268 [00:23<00:09,  8.46it/s]Test-loop:  71%|███████   | 189/268 [00:23<00:09,  8.30it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  8.19it/s]Test-loop:  72%|███████▏  | 193/268 [00:24<00:09,  8.15it/s]Test-loop:  73%|███████▎  | 195/268 [00:24<00:08,  8.15it/s]Test-loop:  74%|███████▎  | 197/268 [00:24<00:08,  8.17it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  8.18it/s]Test-loop:  75%|███████▌  | 201/268 [00:25<00:08,  8.02it/s]Test-loop:  76%|███████▌  | 203/268 [00:25<00:08,  7.96it/s]Test-loop:  76%|███████▋  | 205/268 [00:25<00:08,  7.85it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  7.86it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:07,  8.03it/s]Test-loop:  79%|███████▊  | 211/268 [00:26<00:06,  8.18it/s]Test-loop:  79%|███████▉  | 213/268 [00:26<00:06,  8.43it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  8.49it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:05,  8.52it/s]Test-loop:  82%|████████▏ | 219/268 [00:27<00:05,  8.55it/s]Test-loop:  82%|████████▏ | 221/268 [00:27<00:05,  8.48it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  8.44it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.32it/s]Test-loop:  85%|████████▍ | 227/268 [00:28<00:04,  8.27it/s]Test-loop:  85%|████████▌ | 229/268 [00:28<00:04,  8.05it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  8.01it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  7.97it/s]Test-loop:  88%|████████▊ | 235/268 [00:29<00:04,  7.92it/s]Test-loop:  88%|████████▊ | 237/268 [00:29<00:03,  8.04it/s]Test-loop:  89%|████████▉ | 239/268 [00:30<00:03,  8.13it/s]Test-loop:  90%|████████▉ | 240/268 [00:30<00:03,  8.37it/s]Test-loop:  90%|████████▉ | 241/268 [00:30<00:03,  8.08it/s]Test-loop:  90%|█████████ | 242/268 [00:30<00:03,  8.34it/s]Test-loop:  91%|█████████ | 243/268 [00:30<00:03,  7.85it/s]Test-loop:  91%|█████████▏| 245/268 [00:30<00:03,  7.61it/s]Test-loop:  92%|█████████▏| 247/268 [00:31<00:02,  7.80it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  7.97it/s]Test-loop:  94%|█████████▎| 251/268 [00:31<00:02,  8.13it/s]Test-loop:  94%|█████████▍| 253/268 [00:31<00:01,  8.26it/s]Test-loop:  95%|█████████▍| 254/268 [00:31<00:01,  8.42it/s]Test-loop:  95%|█████████▌| 255/268 [00:32<00:01,  8.16it/s]Test-loop:  96%|█████████▌| 256/268 [00:32<00:01,  8.33it/s]Test-loop:  96%|█████████▌| 257/268 [00:32<00:01,  8.09it/s]Test-loop:  96%|█████████▋| 258/268 [00:32<00:01,  8.12it/s]Test-loop:  97%|█████████▋| 259/268 [00:32<00:01,  7.99it/s]Test-loop:  97%|█████████▋| 260/268 [00:32<00:00,  8.12it/s]Test-loop:  97%|█████████▋| 261/268 [00:32<00:00,  7.95it/s]Test-loop:  98%|█████████▊| 262/268 [00:32<00:00,  8.14it/s]Test-loop:  98%|█████████▊| 263/268 [00:33<00:00,  8.00it/s]Test-loop:  99%|█████████▊| 264/268 [00:33<00:00,  8.49it/s]Test-loop:  99%|█████████▉| 265/268 [00:33<00:00,  7.81it/s]Test-loop: 100%|█████████▉| 267/268 [00:33<00:00,  7.86it/s]Test-loop: 100%|██████████| 268/268 [00:33<00:00,  7.96it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 2994/17100 [00:00<00:00, 29928.61it/s]Loading Data:  35%|███▌      | 6043/17100 [00:00<00:00, 30254.05it/s]Loading Data:  53%|█████▎    | 9091/17100 [00:00<00:00, 30353.06it/s]Loading Data:  71%|███████   | 12142/17100 [00:00<00:00, 30410.92it/s]Loading Data:  89%|████████▉ | 15191/17100 [00:00<00:00, 30436.07it/s]Loading Data: 100%|██████████| 17100/17100 [00:00<00:00, 30363.96it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 30037.00it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3003/17098 [00:00<00:00, 30025.02it/s]Loading Data:  35%|███▌      | 6030/17098 [00:00<00:00, 30167.44it/s]Loading Data:  53%|█████▎    | 9048/17098 [00:00<00:00, 30168.75it/s]Loading Data:  71%|███████   | 12080/17098 [00:00<00:00, 30225.20it/s]Loading Data:  88%|████████▊ | 15104/17098 [00:00<00:00, 30227.06it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30212.30it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:30,  1.45it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:10,  4.14it/s]Test-loop:  11%|█         | 5/45 [00:01<00:06,  6.17it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  7.69it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.24it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.37it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 11.33it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.75it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 11.78it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.76it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 12.01it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 12.05it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.04it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 12.02it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 11.97it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 11.94it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:01, 11.92it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.02it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 11.99it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.09it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.08it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 12.06it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 13.00it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.48it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:05,  1.44it/s]Test-loop:   1%|          | 3/268 [00:00<01:03,  4.16it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:42,  6.23it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:33,  7.74it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:29,  8.92it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:26,  9.72it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:24, 10.30it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:23, 10.76it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:22, 11.04it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:22, 11.20it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:21, 11.37it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:21, 11.59it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:20, 11.70it/s]Test-loop:  10%|█         | 27/268 [00:02<00:20, 11.70it/s]Test-loop:  11%|█         | 29/268 [00:03<00:20, 11.71it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:19, 11.98it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:19, 11.95it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:19, 11.82it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:19, 11.75it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:19, 11.72it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:19, 11.63it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:19, 11.62it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:19, 11.59it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:19, 11.58it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:18, 11.55it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:18, 11.56it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:18, 11.59it/s]Test-loop:  21%|██        | 55/268 [00:05<00:18, 11.43it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:18, 11.46it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:18, 11.56it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:17, 11.64it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:17, 11.55it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:17, 11.63it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:17, 11.67it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:17, 11.69it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:16, 11.69it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:16, 11.63it/s]Test-loop:  28%|██▊       | 75/268 [00:07<00:16, 11.59it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:16, 11.59it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:16, 11.63it/s]Test-loop:  30%|███       | 81/268 [00:07<00:16, 11.65it/s]Test-loop:  31%|███       | 83/268 [00:07<00:16, 11.56it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:15, 11.48it/s]Test-loop:  32%|███▏      | 87/268 [00:08<00:15, 12.05it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:14, 12.46it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:13, 12.74it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:13, 13.09it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:12, 13.34it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:12, 13.26it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:13, 12.69it/s]Test-loop:  38%|███▊      | 101/268 [00:09<00:13, 12.54it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:13, 12.44it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:13, 12.44it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:12, 12.42it/s]Test-loop:  41%|████      | 109/268 [00:09<00:13, 12.19it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:12, 12.32it/s]Test-loop:  42%|████▏     | 113/268 [00:10<00:12, 12.27it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:12, 12.24it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 12.10it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 12.14it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:12, 12.14it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:12, 12.01it/s]Test-loop:  47%|████▋     | 125/268 [00:11<00:11, 12.01it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 11.94it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 11.96it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 12.02it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:11, 11.84it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:11, 11.83it/s]Test-loop:  51%|█████     | 137/268 [00:12<00:11, 11.90it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:10, 11.90it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:10, 11.80it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:10, 11.76it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:10, 11.81it/s]Test-loop:  55%|█████▍    | 147/268 [00:12<00:10, 11.84it/s]Test-loop:  56%|█████▌    | 149/268 [00:13<00:09, 11.91it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:09, 11.92it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 11.94it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 11.86it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:09, 11.94it/s]Test-loop:  59%|█████▉    | 159/268 [00:13<00:09, 11.89it/s]Test-loop:  60%|██████    | 161/268 [00:14<00:08, 11.90it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:08, 11.97it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 11.97it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 11.84it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:08, 11.73it/s]Test-loop:  64%|██████▍   | 171/268 [00:14<00:08, 11.75it/s]Test-loop:  65%|██████▍   | 173/268 [00:15<00:08, 11.87it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:07, 11.84it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 11.87it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 11.88it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:07, 11.80it/s]Test-loop:  68%|██████▊   | 183/268 [00:15<00:07, 11.88it/s]Test-loop:  69%|██████▉   | 185/268 [00:16<00:06, 12.06it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 12.12it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 12.05it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 12.03it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:06, 11.94it/s]Test-loop:  73%|███████▎  | 195/268 [00:16<00:06, 12.01it/s]Test-loop:  74%|███████▎  | 197/268 [00:17<00:05, 12.06it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:05, 12.23it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 12.23it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 12.26it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 12.22it/s]Test-loop:  77%|███████▋  | 207/268 [00:17<00:04, 12.28it/s]Test-loop:  78%|███████▊  | 209/268 [00:18<00:04, 12.22it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 11.98it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 12.09it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 12.07it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:04, 11.93it/s]Test-loop:  82%|████████▏ | 219/268 [00:18<00:04, 11.92it/s]Test-loop:  82%|████████▏ | 221/268 [00:19<00:03, 12.01it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 11.97it/s]Test-loop:  84%|████████▍ | 225/268 [00:19<00:03, 12.00it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 12.42it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:03, 12.79it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:02, 13.15it/s]Test-loop:  87%|████████▋ | 233/268 [00:20<00:02, 13.43it/s]Test-loop:  88%|████████▊ | 235/268 [00:20<00:02, 13.68it/s]Test-loop:  88%|████████▊ | 237/268 [00:20<00:02, 13.92it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 13.57it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:02, 13.28it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:01, 12.93it/s]Test-loop:  91%|█████████▏| 245/268 [00:20<00:01, 12.47it/s]Test-loop:  92%|█████████▏| 247/268 [00:21<00:01, 12.41it/s]Test-loop:  93%|█████████▎| 249/268 [00:21<00:01, 12.32it/s]Test-loop:  94%|█████████▎| 251/268 [00:21<00:01, 12.25it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 12.32it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:01, 12.29it/s]Test-loop:  96%|█████████▌| 257/268 [00:21<00:00, 12.42it/s]Test-loop:  97%|█████████▋| 259/268 [00:22<00:00, 12.47it/s]Test-loop:  97%|█████████▋| 261/268 [00:22<00:00, 12.50it/s]Test-loop:  98%|█████████▊| 263/268 [00:22<00:00, 12.66it/s]Test-loop:  99%|█████████▉| 265/268 [00:22<00:00, 12.69it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 12.47it/s]Test-loop: 100%|██████████| 268/268 [00:22<00:00, 11.74it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:16,  1.36it/s]Test-loop:   1%|          | 3/268 [00:00<01:16,  3.47it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:54,  4.86it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:45,  5.78it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:40,  6.38it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:38,  6.75it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:36,  7.04it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:34,  7.42it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:33,  7.56it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:32,  7.74it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:31,  7.85it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:31,  7.88it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:30,  7.97it/s]Test-loop:  10%|█         | 27/268 [00:04<00:30,  7.89it/s]Test-loop:  11%|█         | 29/268 [00:04<00:29,  8.05it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:29,  8.03it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:28,  8.12it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:29,  7.99it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.84it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:29,  7.85it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:28,  7.91it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:28,  7.93it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:28,  7.83it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:27,  7.93it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:27,  7.86it/s]Test-loop:  19%|█▉        | 51/268 [00:07<00:27,  7.80it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:27,  7.69it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.78it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:27,  7.61it/s]Test-loop:  22%|██▏       | 59/268 [00:08<00:27,  7.55it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:27,  7.64it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:26,  7.77it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:25,  8.00it/s]Test-loop:  25%|██▌       | 67/268 [00:09<00:25,  8.03it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:24,  8.04it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:24,  7.90it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:24,  7.89it/s]Test-loop:  28%|██▊       | 75/268 [00:10<00:23,  8.15it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:23,  8.24it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:22,  8.22it/s]Test-loop:  30%|███       | 81/268 [00:10<00:22,  8.24it/s]Test-loop:  31%|███       | 83/268 [00:11<00:23,  8.04it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:23,  7.83it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  7.94it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:21,  8.15it/s]Test-loop:  34%|███▍      | 91/268 [00:12<00:21,  8.21it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:20,  8.38it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:20,  8.26it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:20,  8.34it/s]Test-loop:  37%|███▋      | 99/268 [00:13<00:20,  8.24it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.06it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  8.16it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:19,  8.35it/s]Test-loop:  40%|███▉      | 107/268 [00:14<00:19,  8.29it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.03it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  8.16it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:18,  8.16it/s]Test-loop:  43%|████▎     | 115/268 [00:15<00:19,  8.05it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:18,  8.07it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:18,  8.02it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:18,  8.00it/s]Test-loop:  46%|████▌     | 123/268 [00:16<00:18,  7.89it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:18,  7.85it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:18,  7.67it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:17,  7.77it/s]Test-loop:  49%|████▉     | 131/268 [00:17<00:17,  7.80it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:17,  7.65it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:17,  7.69it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:16,  7.73it/s]Test-loop:  52%|█████▏    | 139/268 [00:18<00:16,  7.81it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:16,  7.77it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:16,  7.78it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:15,  7.88it/s]Test-loop:  55%|█████▍    | 147/268 [00:19<00:15,  7.99it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  8.12it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  8.05it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:14,  8.16it/s]Test-loop:  58%|█████▊    | 155/268 [00:20<00:13,  8.40it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.44it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:12,  8.42it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:12,  8.27it/s]Test-loop:  61%|██████    | 163/268 [00:21<00:12,  8.20it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:12,  8.07it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  8.01it/s]Test-loop:  63%|██████▎   | 169/268 [00:21<00:12,  8.09it/s]Test-loop:  64%|██████▍   | 171/268 [00:22<00:12,  8.03it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:11,  7.93it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  8.05it/s]Test-loop:  66%|██████▌   | 177/268 [00:22<00:11,  8.10it/s]Test-loop:  67%|██████▋   | 179/268 [00:23<00:11,  8.04it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:10,  8.10it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  8.02it/s]Test-loop:  69%|██████▉   | 185/268 [00:23<00:10,  8.02it/s]Test-loop:  70%|██████▉   | 187/268 [00:24<00:10,  7.93it/s]Test-loop:  71%|███████   | 189/268 [00:24<00:10,  7.77it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  7.82it/s]Test-loop:  72%|███████▏  | 193/268 [00:24<00:09,  7.96it/s]Test-loop:  73%|███████▎  | 195/268 [00:25<00:09,  7.90it/s]Test-loop:  74%|███████▎  | 197/268 [00:25<00:09,  7.84it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  7.95it/s]Test-loop:  75%|███████▌  | 201/268 [00:25<00:08,  7.97it/s]Test-loop:  76%|███████▌  | 203/268 [00:26<00:08,  7.94it/s]Test-loop:  76%|███████▋  | 205/268 [00:26<00:07,  8.04it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  8.01it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:07,  7.94it/s]Test-loop:  79%|███████▊  | 211/268 [00:27<00:07,  8.09it/s]Test-loop:  79%|███████▉  | 213/268 [00:27<00:06,  8.00it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  8.17it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:06,  8.24it/s]Test-loop:  82%|████████▏ | 219/268 [00:28<00:05,  8.39it/s]Test-loop:  82%|████████▏ | 221/268 [00:28<00:05,  8.31it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  8.17it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.26it/s]Test-loop:  85%|████████▍ | 227/268 [00:28<00:05,  8.13it/s]Test-loop:  85%|████████▌ | 229/268 [00:29<00:04,  8.01it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  7.86it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  7.98it/s]Test-loop:  88%|████████▊ | 235/268 [00:30<00:04,  7.97it/s]Test-loop:  88%|████████▊ | 237/268 [00:30<00:03,  7.99it/s]Test-loop:  89%|████████▉ | 239/268 [00:30<00:03,  8.14it/s]Test-loop:  90%|████████▉ | 241/268 [00:30<00:03,  8.21it/s]Test-loop:  91%|█████████ | 243/268 [00:30<00:03,  7.99it/s]Test-loop:  91%|█████████▏| 245/268 [00:31<00:02,  7.75it/s]Test-loop:  92%|█████████▏| 247/268 [00:31<00:02,  7.94it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  8.18it/s]Test-loop:  94%|█████████▎| 251/268 [00:31<00:02,  8.40it/s]Test-loop:  94%|█████████▍| 253/268 [00:32<00:01,  8.31it/s]Test-loop:  95%|█████████▌| 255/268 [00:32<00:01,  8.36it/s]Test-loop:  96%|█████████▌| 257/268 [00:32<00:01,  8.21it/s]Test-loop:  97%|█████████▋| 259/268 [00:32<00:01,  8.20it/s]Test-loop:  97%|█████████▋| 261/268 [00:33<00:00,  7.95it/s]Test-loop:  98%|█████████▊| 263/268 [00:33<00:00,  8.05it/s]Test-loop:  99%|█████████▉| 265/268 [00:33<00:00,  8.09it/s]Test-loop: 100%|█████████▉| 267/268 [00:33<00:00,  7.94it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  7.87it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3003/17098 [00:00<00:00, 30026.95it/s]Loading Data:  35%|███▌      | 6051/17098 [00:00<00:00, 30289.72it/s]Loading Data:  53%|█████▎    | 9112/17098 [00:00<00:00, 30432.12it/s]Loading Data:  71%|███████   | 12180/17098 [00:00<00:00, 30527.02it/s]Loading Data:  89%|████████▉ | 15243/17098 [00:00<00:00, 30560.77it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30476.83it/s]
Loading Data:   0%|          | 0/2849 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2849/2849 [00:00<00:00, 30087.17it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  17%|█▋        | 2986/17098 [00:00<00:00, 29850.78it/s]Loading Data:  35%|███▌      | 5990/17098 [00:00<00:00, 29957.72it/s]Loading Data:  53%|█████▎    | 9008/17098 [00:00<00:00, 30057.71it/s]Loading Data:  70%|███████   | 12030/17098 [00:00<00:00, 30120.31it/s]Loading Data:  88%|████████▊ | 15043/17098 [00:00<00:00, 30047.77it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30045.72it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:28,  1.54it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.43it/s]Test-loop:  11%|█         | 5/45 [00:00<00:06,  6.62it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.29it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.95it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 11.31it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 12.33it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 12.78it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 12.87it/s]Test-loop:  42%|████▏     | 19/45 [00:01<00:02, 12.92it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 12.99it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 12.87it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.72it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 12.64it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 12.79it/s]Test-loop:  69%|██████▉   | 31/45 [00:02<00:01, 12.82it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.96it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.99it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 13.08it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 13.11it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.99it/s]Test-loop:  96%|█████████▌| 43/45 [00:03<00:00, 13.05it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 13.80it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 11.27it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:48,  1.58it/s]Test-loop:   1%|          | 3/268 [00:00<01:00,  4.41it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:40,  6.54it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:30,  8.48it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:25, 10.04it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:23, 11.12it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:21, 12.07it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:20, 12.33it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:19, 12.67it/s]Test-loop:   7%|▋         | 19/268 [00:01<00:19, 12.69it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:19, 12.81it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:19, 12.84it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:18, 12.93it/s]Test-loop:  10%|█         | 27/268 [00:02<00:18, 12.89it/s]Test-loop:  11%|█         | 29/268 [00:02<00:18, 13.01it/s]Test-loop:  12%|█▏        | 31/268 [00:02<00:18, 13.07it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:18, 12.93it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:18, 12.91it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:17, 12.84it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:17, 12.91it/s]Test-loop:  15%|█▌        | 41/268 [00:03<00:17, 12.92it/s]Test-loop:  16%|█▌        | 43/268 [00:03<00:17, 12.89it/s]Test-loop:  17%|█▋        | 45/268 [00:03<00:17, 12.87it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:17, 12.93it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:17, 12.75it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:16, 12.77it/s]Test-loop:  20%|█▉        | 53/268 [00:04<00:16, 12.76it/s]Test-loop:  21%|██        | 55/268 [00:04<00:16, 12.80it/s]Test-loop:  21%|██▏       | 57/268 [00:04<00:16, 12.88it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:16, 12.97it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:15, 12.98it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:15, 12.90it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:15, 13.07it/s]Test-loop:  25%|██▌       | 67/268 [00:05<00:15, 13.11it/s]Test-loop:  26%|██▌       | 69/268 [00:05<00:15, 13.14it/s]Test-loop:  26%|██▋       | 71/268 [00:05<00:14, 13.16it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:15, 12.98it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:14, 12.90it/s]Test-loop:  29%|██▊       | 77/268 [00:06<00:14, 12.81it/s]Test-loop:  29%|██▉       | 79/268 [00:06<00:14, 12.96it/s]Test-loop:  30%|███       | 81/268 [00:06<00:14, 12.95it/s]Test-loop:  31%|███       | 83/268 [00:06<00:14, 12.92it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:14, 12.96it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:13, 12.93it/s]Test-loop:  33%|███▎      | 89/268 [00:07<00:13, 12.90it/s]Test-loop:  34%|███▍      | 91/268 [00:07<00:13, 12.88it/s]Test-loop:  35%|███▍      | 93/268 [00:07<00:13, 12.96it/s]Test-loop:  35%|███▌      | 95/268 [00:07<00:13, 12.72it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:13, 12.76it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:13, 12.76it/s]Test-loop:  38%|███▊      | 101/268 [00:08<00:13, 12.75it/s]Test-loop:  38%|███▊      | 103/268 [00:08<00:12, 12.74it/s]Test-loop:  39%|███▉      | 105/268 [00:08<00:12, 12.77it/s]Test-loop:  40%|███▉      | 107/268 [00:08<00:12, 12.72it/s]Test-loop:  41%|████      | 109/268 [00:08<00:12, 12.70it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:12, 12.70it/s]Test-loop:  42%|████▏     | 113/268 [00:09<00:11, 12.94it/s]Test-loop:  43%|████▎     | 115/268 [00:09<00:11, 13.17it/s]Test-loop:  44%|████▎     | 117/268 [00:09<00:11, 13.23it/s]Test-loop:  44%|████▍     | 119/268 [00:09<00:11, 13.25it/s]Test-loop:  45%|████▌     | 121/268 [00:09<00:11, 13.30it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:10, 13.30it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:10, 13.10it/s]Test-loop:  47%|████▋     | 127/268 [00:10<00:10, 13.05it/s]Test-loop:  48%|████▊     | 129/268 [00:10<00:10, 13.05it/s]Test-loop:  49%|████▉     | 131/268 [00:10<00:10, 13.09it/s]Test-loop:  50%|████▉     | 133/268 [00:10<00:10, 13.18it/s]Test-loop:  50%|█████     | 135/268 [00:10<00:10, 13.02it/s]Test-loop:  51%|█████     | 137/268 [00:11<00:09, 13.15it/s]Test-loop:  52%|█████▏    | 139/268 [00:11<00:09, 13.07it/s]Test-loop:  53%|█████▎    | 141/268 [00:11<00:09, 13.07it/s]Test-loop:  53%|█████▎    | 143/268 [00:11<00:09, 13.12it/s]Test-loop:  54%|█████▍    | 145/268 [00:11<00:09, 13.15it/s]Test-loop:  55%|█████▍    | 147/268 [00:11<00:09, 13.09it/s]Test-loop:  56%|█████▌    | 149/268 [00:12<00:09, 13.14it/s]Test-loop:  56%|█████▋    | 151/268 [00:12<00:08, 13.13it/s]Test-loop:  57%|█████▋    | 153/268 [00:12<00:08, 13.13it/s]Test-loop:  58%|█████▊    | 155/268 [00:12<00:08, 13.17it/s]Test-loop:  59%|█████▊    | 157/268 [00:12<00:08, 13.22it/s]Test-loop:  59%|█████▉    | 159/268 [00:12<00:08, 13.33it/s]Test-loop:  60%|██████    | 161/268 [00:12<00:08, 13.34it/s]Test-loop:  61%|██████    | 163/268 [00:13<00:07, 13.81it/s]Test-loop:  62%|██████▏   | 165/268 [00:13<00:07, 14.16it/s]Test-loop:  62%|██████▏   | 167/268 [00:13<00:06, 14.44it/s]Test-loop:  63%|██████▎   | 169/268 [00:13<00:06, 14.47it/s]Test-loop:  64%|██████▍   | 171/268 [00:13<00:06, 14.03it/s]Test-loop:  65%|██████▍   | 173/268 [00:13<00:06, 13.66it/s]Test-loop:  65%|██████▌   | 175/268 [00:13<00:06, 13.47it/s]Test-loop:  66%|██████▌   | 177/268 [00:14<00:06, 13.52it/s]Test-loop:  67%|██████▋   | 179/268 [00:14<00:06, 13.49it/s]Test-loop:  68%|██████▊   | 181/268 [00:14<00:06, 13.94it/s]Test-loop:  68%|██████▊   | 183/268 [00:14<00:05, 14.27it/s]Test-loop:  69%|██████▉   | 185/268 [00:14<00:05, 14.51it/s]Test-loop:  70%|██████▉   | 187/268 [00:14<00:05, 14.68it/s]Test-loop:  71%|███████   | 189/268 [00:14<00:05, 14.47it/s]Test-loop:  71%|███████▏  | 191/268 [00:15<00:05, 13.97it/s]Test-loop:  72%|███████▏  | 193/268 [00:15<00:05, 13.78it/s]Test-loop:  73%|███████▎  | 195/268 [00:15<00:05, 13.62it/s]Test-loop:  74%|███████▎  | 197/268 [00:15<00:05, 13.50it/s]Test-loop:  74%|███████▍  | 199/268 [00:15<00:05, 13.34it/s]Test-loop:  75%|███████▌  | 201/268 [00:15<00:05, 13.26it/s]Test-loop:  76%|███████▌  | 203/268 [00:15<00:04, 13.22it/s]Test-loop:  76%|███████▋  | 205/268 [00:16<00:04, 13.24it/s]Test-loop:  77%|███████▋  | 207/268 [00:16<00:04, 13.23it/s]Test-loop:  78%|███████▊  | 209/268 [00:16<00:04, 13.15it/s]Test-loop:  79%|███████▊  | 211/268 [00:16<00:04, 13.05it/s]Test-loop:  79%|███████▉  | 213/268 [00:16<00:04, 13.01it/s]Test-loop:  80%|████████  | 215/268 [00:16<00:04, 13.10it/s]Test-loop:  81%|████████  | 217/268 [00:17<00:03, 13.19it/s]Test-loop:  82%|████████▏ | 219/268 [00:17<00:03, 13.11it/s]Test-loop:  82%|████████▏ | 221/268 [00:17<00:03, 13.30it/s]Test-loop:  83%|████████▎ | 223/268 [00:17<00:03, 13.34it/s]Test-loop:  84%|████████▍ | 225/268 [00:17<00:03, 13.32it/s]Test-loop:  85%|████████▍ | 227/268 [00:17<00:03, 13.23it/s]Test-loop:  85%|████████▌ | 229/268 [00:17<00:02, 13.20it/s]Test-loop:  86%|████████▌ | 231/268 [00:18<00:02, 12.96it/s]Test-loop:  87%|████████▋ | 233/268 [00:18<00:02, 13.07it/s]Test-loop:  88%|████████▊ | 235/268 [00:18<00:02, 13.07it/s]Test-loop:  88%|████████▊ | 237/268 [00:18<00:02, 13.13it/s]Test-loop:  89%|████████▉ | 239/268 [00:18<00:02, 13.06it/s]Test-loop:  90%|████████▉ | 241/268 [00:18<00:02, 13.06it/s]Test-loop:  91%|█████████ | 243/268 [00:19<00:01, 12.84it/s]Test-loop:  91%|█████████▏| 245/268 [00:19<00:01, 12.89it/s]Test-loop:  92%|█████████▏| 247/268 [00:19<00:01, 12.80it/s]Test-loop:  93%|█████████▎| 249/268 [00:19<00:01, 12.87it/s]Test-loop:  94%|█████████▎| 251/268 [00:19<00:01, 12.93it/s]Test-loop:  94%|█████████▍| 253/268 [00:19<00:01, 13.03it/s]Test-loop:  95%|█████████▌| 255/268 [00:19<00:01, 12.99it/s]Test-loop:  96%|█████████▌| 257/268 [00:20<00:00, 13.06it/s]Test-loop:  97%|█████████▋| 259/268 [00:20<00:00, 13.09it/s]Test-loop:  97%|█████████▋| 261/268 [00:20<00:00, 12.99it/s]Test-loop:  98%|█████████▊| 263/268 [00:20<00:00, 12.87it/s]Test-loop:  99%|█████████▉| 265/268 [00:20<00:00, 12.89it/s]Test-loop: 100%|█████████▉| 267/268 [00:20<00:00, 12.83it/s]Test-loop: 100%|██████████| 268/268 [00:20<00:00, 12.79it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:08,  1.42it/s]Test-loop:   1%|          | 3/268 [00:00<01:10,  3.73it/s]Test-loop:   1%|▏         | 4/268 [00:01<00:55,  4.74it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:50,  5.21it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:42,  6.14it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:37,  6.84it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:35,  7.29it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:33,  7.71it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:30,  8.17it/s]Test-loop:   6%|▌         | 16/268 [00:02<00:30,  8.20it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:29,  8.53it/s]Test-loop:   7%|▋         | 18/268 [00:02<00:29,  8.44it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:29,  8.41it/s]Test-loop:   7%|▋         | 20/268 [00:02<00:29,  8.32it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:29,  8.43it/s]Test-loop:   8%|▊         | 22/268 [00:03<00:29,  8.24it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:29,  8.26it/s]Test-loop:   9%|▉         | 24/268 [00:03<00:29,  8.41it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:29,  8.13it/s]Test-loop:  10%|▉         | 26/268 [00:03<00:28,  8.57it/s]Test-loop:  10%|█         | 27/268 [00:03<00:29,  8.06it/s]Test-loop:  11%|█         | 29/268 [00:04<00:29,  8.11it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:28,  8.24it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:28,  8.18it/s]Test-loop:  13%|█▎        | 34/268 [00:04<00:27,  8.49it/s]Test-loop:  13%|█▎        | 35/268 [00:04<00:28,  8.32it/s]Test-loop:  13%|█▎        | 36/268 [00:04<00:26,  8.66it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:27,  8.27it/s]Test-loop:  14%|█▍        | 38/268 [00:05<00:27,  8.50it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:29,  7.87it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:28,  7.91it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:28,  7.99it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:28,  7.86it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:27,  8.05it/s]Test-loop:  18%|█▊        | 48/268 [00:06<00:26,  8.24it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:26,  8.16it/s]Test-loop:  19%|█▊        | 50/268 [00:06<00:27,  8.02it/s]Test-loop:  19%|█▉        | 51/268 [00:06<00:26,  8.15it/s]Test-loop:  19%|█▉        | 52/268 [00:06<00:26,  8.05it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:26,  8.03it/s]Test-loop:  20%|██        | 54/268 [00:07<00:26,  8.02it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.73it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:26,  7.99it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:25,  8.28it/s]Test-loop:  22%|██▏       | 60/268 [00:07<00:24,  8.47it/s]Test-loop:  23%|██▎       | 61/268 [00:07<00:24,  8.30it/s]Test-loop:  23%|██▎       | 62/268 [00:08<00:25,  8.16it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:24,  8.50it/s]Test-loop:  24%|██▍       | 64/268 [00:08<00:25,  8.04it/s]Test-loop:  25%|██▍       | 66/268 [00:08<00:24,  8.18it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:23,  8.46it/s]Test-loop:  25%|██▌       | 68/268 [00:08<00:24,  8.10it/s]Test-loop:  26%|██▌       | 69/268 [00:08<00:23,  8.46it/s]Test-loop:  26%|██▌       | 70/268 [00:09<00:24,  7.97it/s]Test-loop:  27%|██▋       | 72/268 [00:09<00:23,  8.21it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:23,  8.36it/s]Test-loop:  28%|██▊       | 74/268 [00:09<00:23,  8.19it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:22,  8.47it/s]Test-loop:  28%|██▊       | 76/268 [00:09<00:23,  8.14it/s]Test-loop:  29%|██▊       | 77/268 [00:09<00:23,  8.30it/s]Test-loop:  29%|██▉       | 78/268 [00:10<00:23,  8.07it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  8.16it/s]Test-loop:  30%|██▉       | 80/268 [00:10<00:22,  8.38it/s]Test-loop:  30%|███       | 81/268 [00:10<00:22,  8.13it/s]Test-loop:  31%|███       | 82/268 [00:10<00:22,  8.10it/s]Test-loop:  31%|███       | 83/268 [00:10<00:23,  7.74it/s]Test-loop:  31%|███▏      | 84/268 [00:10<00:22,  8.28it/s]Test-loop:  32%|███▏      | 85/268 [00:10<00:22,  8.07it/s]Test-loop:  32%|███▏      | 86/268 [00:11<00:22,  8.17it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  8.00it/s]Test-loop:  33%|███▎      | 88/268 [00:11<00:21,  8.29it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  7.87it/s]Test-loop:  34%|███▎      | 90/268 [00:11<00:21,  8.33it/s]Test-loop:  34%|███▍      | 91/268 [00:11<00:22,  7.91it/s]Test-loop:  34%|███▍      | 92/268 [00:11<00:21,  8.36it/s]Test-loop:  35%|███▍      | 93/268 [00:11<00:21,  8.05it/s]Test-loop:  35%|███▌      | 94/268 [00:12<00:21,  7.97it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.11it/s]Test-loop:  36%|███▌      | 96/268 [00:12<00:21,  8.10it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:22,  7.63it/s]Test-loop:  37%|███▋      | 98/268 [00:12<00:20,  8.21it/s]Test-loop:  37%|███▋      | 99/268 [00:12<00:22,  7.63it/s]Test-loop:  38%|███▊      | 101/268 [00:12<00:20,  7.97it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  8.02it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:20,  7.91it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:19,  8.24it/s]Test-loop:  41%|████      | 109/268 [00:13<00:19,  8.31it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  8.17it/s]Test-loop:  42%|████▏     | 112/268 [00:14<00:18,  8.44it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:18,  8.31it/s]Test-loop:  43%|████▎     | 114/268 [00:14<00:18,  8.38it/s]Test-loop:  43%|████▎     | 115/268 [00:14<00:18,  8.12it/s]Test-loop:  43%|████▎     | 116/268 [00:14<00:18,  8.27it/s]Test-loop:  44%|████▎     | 117/268 [00:14<00:17,  8.39it/s]Test-loop:  44%|████▍     | 118/268 [00:14<00:17,  8.50it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:17,  8.45it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:16,  8.83it/s]Test-loop:  46%|████▌     | 122/268 [00:15<00:16,  8.59it/s]Test-loop:  46%|████▌     | 123/268 [00:15<00:16,  8.85it/s]Test-loop:  46%|████▋     | 124/268 [00:15<00:17,  8.41it/s]Test-loop:  47%|████▋     | 125/268 [00:15<00:17,  8.36it/s]Test-loop:  47%|████▋     | 126/268 [00:15<00:18,  7.87it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:16,  8.32it/s]Test-loop:  48%|████▊     | 128/268 [00:16<00:17,  7.97it/s]Test-loop:  49%|████▊     | 130/268 [00:16<00:17,  8.02it/s]Test-loop:  49%|████▉     | 132/268 [00:16<00:16,  8.16it/s]Test-loop:  50%|█████     | 134/268 [00:16<00:16,  8.15it/s]Test-loop:  51%|█████     | 136/268 [00:17<00:16,  8.17it/s]Test-loop:  51%|█████▏    | 138/268 [00:17<00:16,  8.05it/s]Test-loop:  52%|█████▏    | 140/268 [00:17<00:15,  8.18it/s]Test-loop:  53%|█████▎    | 142/268 [00:17<00:15,  8.15it/s]Test-loop:  54%|█████▎    | 144/268 [00:18<00:15,  8.03it/s]Test-loop:  54%|█████▍    | 146/268 [00:18<00:15,  8.10it/s]Test-loop:  55%|█████▌    | 148/268 [00:18<00:14,  8.16it/s]Test-loop:  56%|█████▌    | 150/268 [00:18<00:14,  8.01it/s]Test-loop:  57%|█████▋    | 152/268 [00:19<00:14,  7.98it/s]Test-loop:  57%|█████▋    | 154/268 [00:19<00:14,  8.01it/s]Test-loop:  58%|█████▊    | 156/268 [00:19<00:13,  8.03it/s]Test-loop:  59%|█████▉    | 158/268 [00:19<00:13,  8.08it/s]Test-loop:  60%|█████▉    | 160/268 [00:20<00:13,  8.19it/s]Test-loop:  60%|██████    | 162/268 [00:20<00:12,  8.19it/s]Test-loop:  61%|██████    | 164/268 [00:20<00:12,  8.06it/s]Test-loop:  62%|██████▏   | 166/268 [00:20<00:12,  8.20it/s]Test-loop:  63%|██████▎   | 168/268 [00:21<00:12,  8.23it/s]Test-loop:  63%|██████▎   | 170/268 [00:21<00:11,  8.23it/s]Test-loop:  64%|██████▍   | 172/268 [00:21<00:11,  8.16it/s]Test-loop:  65%|██████▍   | 174/268 [00:21<00:11,  8.40it/s]Test-loop:  66%|██████▌   | 176/268 [00:22<00:11,  8.34it/s]Test-loop:  66%|██████▋   | 178/268 [00:22<00:11,  8.03it/s]Test-loop:  67%|██████▋   | 180/268 [00:22<00:10,  8.18it/s]Test-loop:  68%|██████▊   | 182/268 [00:22<00:10,  8.17it/s]Test-loop:  69%|██████▊   | 184/268 [00:23<00:10,  8.25it/s]Test-loop:  69%|██████▉   | 186/268 [00:23<00:09,  8.38it/s]Test-loop:  70%|███████   | 188/268 [00:23<00:09,  8.23it/s]Test-loop:  71%|███████   | 190/268 [00:23<00:09,  8.16it/s]Test-loop:  72%|███████▏  | 192/268 [00:24<00:09,  8.14it/s]Test-loop:  72%|███████▏  | 194/268 [00:24<00:08,  8.26it/s]Test-loop:  73%|███████▎  | 196/268 [00:24<00:08,  8.12it/s]Test-loop:  74%|███████▍  | 198/268 [00:24<00:08,  8.07it/s]Test-loop:  75%|███████▍  | 200/268 [00:24<00:08,  8.18it/s]Test-loop:  75%|███████▌  | 202/268 [00:25<00:08,  8.21it/s]Test-loop:  76%|███████▌  | 204/268 [00:25<00:07,  8.13it/s]Test-loop:  77%|███████▋  | 206/268 [00:25<00:07,  8.19it/s]Test-loop:  78%|███████▊  | 208/268 [00:25<00:07,  8.13it/s]Test-loop:  78%|███████▊  | 210/268 [00:26<00:07,  8.01it/s]Test-loop:  79%|███████▉  | 212/268 [00:26<00:06,  8.29it/s]Test-loop:  80%|███████▉  | 214/268 [00:26<00:06,  8.44it/s]Test-loop:  81%|████████  | 216/268 [00:26<00:06,  8.53it/s]Test-loop:  81%|████████▏ | 218/268 [00:27<00:05,  8.41it/s]Test-loop:  82%|████████▏ | 220/268 [00:27<00:05,  8.47it/s]Test-loop:  83%|████████▎ | 222/268 [00:27<00:05,  8.25it/s]Test-loop:  84%|████████▎ | 224/268 [00:27<00:05,  8.35it/s]Test-loop:  84%|████████▍ | 226/268 [00:28<00:04,  8.54it/s]Test-loop:  85%|████████▌ | 228/268 [00:28<00:04,  8.42it/s]Test-loop:  86%|████████▌ | 230/268 [00:28<00:04,  8.63it/s]Test-loop:  87%|████████▋ | 232/268 [00:28<00:04,  8.65it/s]Test-loop:  87%|████████▋ | 234/268 [00:29<00:03,  8.67it/s]Test-loop:  88%|████████▊ | 236/268 [00:29<00:03,  8.67it/s]Test-loop:  89%|████████▉ | 238/268 [00:29<00:03,  8.59it/s]Test-loop:  90%|████████▉ | 240/268 [00:29<00:03,  8.57it/s]Test-loop:  90%|█████████ | 242/268 [00:29<00:03,  8.62it/s]Test-loop:  91%|█████████ | 244/268 [00:30<00:02,  8.59it/s]Test-loop:  92%|█████████▏| 246/268 [00:30<00:02,  8.59it/s]Test-loop:  93%|█████████▎| 248/268 [00:30<00:02,  8.55it/s]Test-loop:  93%|█████████▎| 250/268 [00:30<00:02,  8.48it/s]Test-loop:  94%|█████████▍| 252/268 [00:31<00:01,  8.42it/s]Test-loop:  95%|█████████▍| 254/268 [00:31<00:01,  8.37it/s]Test-loop:  96%|█████████▌| 256/268 [00:31<00:01,  8.43it/s]Test-loop:  96%|█████████▋| 258/268 [00:31<00:01,  8.41it/s]Test-loop:  97%|█████████▋| 260/268 [00:32<00:00,  8.44it/s]Test-loop:  98%|█████████▊| 262/268 [00:32<00:00,  8.32it/s]Test-loop:  99%|█████████▊| 264/268 [00:32<00:00,  8.24it/s]Test-loop:  99%|█████████▉| 266/268 [00:32<00:00,  8.24it/s]Test-loop: 100%|██████████| 268/268 [00:32<00:00,  9.69it/s]Test-loop: 100%|██████████| 268/268 [00:32<00:00,  8.12it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3003/17098 [00:00<00:00, 30026.38it/s]Loading Data:  36%|███▌      | 6075/17098 [00:00<00:00, 30431.49it/s]Loading Data:  53%|█████▎    | 9127/17098 [00:00<00:00, 30470.32it/s]Loading Data:  71%|███████▏  | 12206/17098 [00:00<00:00, 30594.40it/s]Loading Data:  89%|████████▉ | 15266/17098 [00:00<00:00, 30514.24it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30483.48it/s]
Loading Data:   0%|          | 0/2849 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2849/2849 [00:00<00:00, 30044.81it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3003/17098 [00:00<00:00, 30024.59it/s]Loading Data:  35%|███▌      | 6047/17098 [00:00<00:00, 30264.32it/s]Loading Data:  53%|█████▎    | 9089/17098 [00:00<00:00, 30332.51it/s]Loading Data:  71%|███████   | 12125/17098 [00:00<00:00, 30341.14it/s]Loading Data:  89%|████████▊ | 15160/17098 [00:00<00:00, 30295.62it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30284.33it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:29,  1.48it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.26it/s]Test-loop:  11%|█         | 5/45 [00:01<00:06,  6.37it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  7.91it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.11it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.00it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 10.89it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.82it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 12.42it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 12.86it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 12.80it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 12.75it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.74it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 12.77it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 12.64it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 12.59it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.64it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.65it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 12.64it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.66it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.68it/s]Test-loop:  96%|█████████▌| 43/45 [00:03<00:00, 12.58it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 13.41it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.86it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:04,  1.44it/s]Test-loop:   1%|          | 3/268 [00:00<01:05,  4.06it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:43,  6.01it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:35,  7.45it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:29,  8.64it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:26,  9.57it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:24, 10.25it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:23, 10.65it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:23, 10.90it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:22, 11.09it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:21, 11.30it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:21, 11.55it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:20, 11.66it/s]Test-loop:  10%|█         | 27/268 [00:02<00:20, 11.78it/s]Test-loop:  11%|█         | 29/268 [00:03<00:20, 11.76it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:19, 12.04it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:19, 12.11it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:19, 12.26it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:18, 12.29it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:18, 12.36it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:18, 12.30it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:18, 12.31it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:18, 12.37it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:17, 12.46it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:17, 12.40it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:17, 12.47it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:17, 12.55it/s]Test-loop:  21%|██        | 55/268 [00:05<00:17, 12.52it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:16, 12.59it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:16, 12.64it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:16, 12.66it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:16, 12.67it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:16, 12.51it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:16, 12.52it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:15, 12.54it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:15, 12.55it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:15, 12.56it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:15, 12.55it/s]Test-loop:  29%|██▊       | 77/268 [00:06<00:15, 12.50it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:15, 12.45it/s]Test-loop:  30%|███       | 81/268 [00:07<00:15, 12.41it/s]Test-loop:  31%|███       | 83/268 [00:07<00:14, 12.42it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:14, 12.52it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:14, 12.48it/s]Test-loop:  33%|███▎      | 89/268 [00:07<00:14, 12.44it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:14, 12.38it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:14, 12.45it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:14, 12.35it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:13, 12.38it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:13, 12.45it/s]Test-loop:  38%|███▊      | 101/268 [00:08<00:13, 12.62it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:13, 12.53it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:12, 12.71it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:12, 13.11it/s]Test-loop:  41%|████      | 109/268 [00:09<00:11, 13.44it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:11, 13.69it/s]Test-loop:  42%|████▏     | 113/268 [00:09<00:11, 13.28it/s]Test-loop:  43%|████▎     | 115/268 [00:09<00:11, 12.96it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:11, 12.83it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:11, 12.70it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:11, 12.75it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:11, 12.72it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:11, 12.63it/s]Test-loop:  47%|████▋     | 127/268 [00:10<00:11, 12.74it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:10, 12.65it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:10, 12.70it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:10, 12.55it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:10, 12.69it/s]Test-loop:  51%|█████     | 137/268 [00:11<00:10, 12.73it/s]Test-loop:  52%|█████▏    | 139/268 [00:11<00:10, 12.65it/s]Test-loop:  53%|█████▎    | 141/268 [00:11<00:10, 12.54it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:09, 12.56it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:09, 12.39it/s]Test-loop:  55%|█████▍    | 147/268 [00:12<00:09, 12.21it/s]Test-loop:  56%|█████▌    | 149/268 [00:12<00:09, 12.19it/s]Test-loop:  56%|█████▋    | 151/268 [00:12<00:09, 12.02it/s]Test-loop:  57%|█████▋    | 153/268 [00:12<00:09, 12.12it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 12.22it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:09, 12.12it/s]Test-loop:  59%|█████▉    | 159/268 [00:13<00:08, 12.13it/s]Test-loop:  60%|██████    | 161/268 [00:13<00:08, 12.18it/s]Test-loop:  61%|██████    | 163/268 [00:13<00:08, 12.13it/s]Test-loop:  62%|██████▏   | 165/268 [00:13<00:08, 12.00it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 12.06it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:08, 11.94it/s]Test-loop:  64%|██████▍   | 171/268 [00:14<00:08, 11.93it/s]Test-loop:  65%|██████▍   | 173/268 [00:14<00:07, 11.93it/s]Test-loop:  65%|██████▌   | 175/268 [00:14<00:07, 11.87it/s]Test-loop:  66%|██████▌   | 177/268 [00:14<00:07, 11.99it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 11.98it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:07, 12.10it/s]Test-loop:  68%|██████▊   | 183/268 [00:15<00:06, 12.19it/s]Test-loop:  69%|██████▉   | 185/268 [00:15<00:06, 12.29it/s]Test-loop:  70%|██████▉   | 187/268 [00:15<00:06, 12.20it/s]Test-loop:  71%|███████   | 189/268 [00:15<00:06, 12.17it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 12.21it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:06, 12.03it/s]Test-loop:  73%|███████▎  | 195/268 [00:16<00:06, 12.03it/s]Test-loop:  74%|███████▎  | 197/268 [00:16<00:05, 12.09it/s]Test-loop:  74%|███████▍  | 199/268 [00:16<00:05, 12.11it/s]Test-loop:  75%|███████▌  | 201/268 [00:16<00:05, 12.28it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 12.28it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 12.24it/s]Test-loop:  77%|███████▋  | 207/268 [00:17<00:04, 12.22it/s]Test-loop:  78%|███████▊  | 209/268 [00:17<00:04, 12.27it/s]Test-loop:  79%|███████▊  | 211/268 [00:17<00:04, 12.16it/s]Test-loop:  79%|███████▉  | 213/268 [00:17<00:04, 11.96it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 12.07it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:04, 12.24it/s]Test-loop:  82%|████████▏ | 219/268 [00:18<00:03, 12.40it/s]Test-loop:  82%|████████▏ | 221/268 [00:18<00:03, 12.38it/s]Test-loop:  83%|████████▎ | 223/268 [00:18<00:03, 12.34it/s]Test-loop:  84%|████████▍ | 225/268 [00:18<00:03, 12.28it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 12.31it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:03, 12.24it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:03, 12.26it/s]Test-loop:  87%|████████▋ | 233/268 [00:19<00:02, 12.19it/s]Test-loop:  88%|████████▊ | 235/268 [00:19<00:02, 12.17it/s]Test-loop:  88%|████████▊ | 237/268 [00:19<00:02, 12.73it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 13.05it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:02, 13.39it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:01, 12.99it/s]Test-loop:  91%|█████████▏| 245/268 [00:20<00:01, 13.29it/s]Test-loop:  92%|█████████▏| 247/268 [00:20<00:01, 13.65it/s]Test-loop:  93%|█████████▎| 249/268 [00:20<00:01, 13.96it/s]Test-loop:  94%|█████████▎| 251/268 [00:20<00:01, 13.97it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 13.56it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:00, 13.75it/s]Test-loop:  96%|█████████▌| 257/268 [00:21<00:00, 13.84it/s]Test-loop:  97%|█████████▋| 259/268 [00:21<00:00, 14.03it/s]Test-loop:  97%|█████████▋| 261/268 [00:21<00:00, 13.69it/s]Test-loop:  98%|█████████▊| 263/268 [00:21<00:00, 13.15it/s]Test-loop:  99%|█████████▉| 265/268 [00:21<00:00, 12.77it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 12.46it/s]Test-loop: 100%|██████████| 268/268 [00:22<00:00, 12.07it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:24,  1.31it/s]Test-loop:   1%|          | 3/268 [00:01<01:17,  3.40it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:55,  4.78it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:45,  5.79it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:40,  6.37it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:38,  6.76it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:36,  7.02it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:35,  7.22it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:33,  7.48it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:32,  7.57it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:32,  7.56it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:31,  7.76it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:31,  7.75it/s]Test-loop:  10%|█         | 27/268 [00:04<00:30,  7.88it/s]Test-loop:  11%|█         | 29/268 [00:04<00:30,  7.71it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:30,  7.90it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:30,  7.80it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:29,  7.88it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.75it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:29,  7.78it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:28,  7.93it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:28,  7.77it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:28,  7.80it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:28,  7.89it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:28,  7.67it/s]Test-loop:  19%|█▉        | 51/268 [00:07<00:28,  7.69it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:28,  7.66it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.70it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:27,  7.65it/s]Test-loop:  22%|██▏       | 59/268 [00:08<00:26,  7.84it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:26,  7.91it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:25,  8.03it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:25,  7.95it/s]Test-loop:  25%|██▌       | 67/268 [00:09<00:25,  8.01it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:25,  7.92it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:25,  7.86it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:24,  7.84it/s]Test-loop:  28%|██▊       | 75/268 [00:10<00:24,  7.85it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:24,  7.91it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  7.91it/s]Test-loop:  30%|███       | 81/268 [00:10<00:23,  8.05it/s]Test-loop:  31%|███       | 83/268 [00:11<00:22,  8.20it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:22,  8.16it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:21,  8.26it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  8.13it/s]Test-loop:  34%|███▍      | 91/268 [00:12<00:22,  7.82it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:22,  7.89it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.01it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  7.95it/s]Test-loop:  37%|███▋      | 99/268 [00:13<00:21,  8.03it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.11it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  7.97it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:20,  7.99it/s]Test-loop:  40%|███▉      | 107/268 [00:14<00:19,  8.05it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  7.98it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  7.86it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:19,  7.85it/s]Test-loop:  43%|████▎     | 115/268 [00:15<00:19,  7.75it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:19,  7.74it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:19,  7.80it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:18,  7.99it/s]Test-loop:  46%|████▌     | 123/268 [00:16<00:18,  7.92it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:18,  7.90it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  7.98it/s]Test-loop:  48%|████▊     | 129/268 [00:17<00:17,  7.86it/s]Test-loop:  49%|████▉     | 131/268 [00:17<00:17,  7.83it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.00it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  8.03it/s]Test-loop:  51%|█████     | 137/268 [00:18<00:16,  7.99it/s]Test-loop:  52%|█████▏    | 139/268 [00:18<00:16,  7.98it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:16,  7.93it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  7.87it/s]Test-loop:  54%|█████▍    | 145/268 [00:19<00:15,  8.00it/s]Test-loop:  55%|█████▍    | 147/268 [00:19<00:15,  7.98it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  7.95it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  8.01it/s]Test-loop:  57%|█████▋    | 153/268 [00:20<00:14,  7.95it/s]Test-loop:  58%|█████▊    | 155/268 [00:20<00:14,  7.98it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  7.94it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  7.82it/s]Test-loop:  60%|██████    | 161/268 [00:21<00:13,  7.92it/s]Test-loop:  61%|██████    | 163/268 [00:21<00:13,  7.89it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:13,  7.89it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  7.82it/s]Test-loop:  63%|██████▎   | 169/268 [00:22<00:12,  7.91it/s]Test-loop:  64%|██████▍   | 171/268 [00:22<00:12,  7.96it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:12,  7.87it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  8.06it/s]Test-loop:  66%|██████▌   | 177/268 [00:23<00:11,  7.98it/s]Test-loop:  67%|██████▋   | 179/268 [00:23<00:11,  7.98it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:10,  8.44it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:09,  8.64it/s]Test-loop:  69%|██████▉   | 185/268 [00:23<00:09,  8.52it/s]Test-loop:  70%|██████▉   | 187/268 [00:24<00:09,  8.60it/s]Test-loop:  71%|███████   | 189/268 [00:24<00:09,  8.55it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  8.48it/s]Test-loop:  72%|███████▏  | 193/268 [00:24<00:08,  8.35it/s]Test-loop:  73%|███████▎  | 195/268 [00:25<00:08,  8.24it/s]Test-loop:  74%|███████▎  | 197/268 [00:25<00:08,  8.23it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  8.17it/s]Test-loop:  75%|███████▌  | 201/268 [00:25<00:08,  7.97it/s]Test-loop:  76%|███████▌  | 203/268 [00:26<00:08,  7.85it/s]Test-loop:  76%|███████▋  | 205/268 [00:26<00:08,  7.69it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  7.71it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:07,  7.88it/s]Test-loop:  79%|███████▊  | 211/268 [00:27<00:07,  7.95it/s]Test-loop:  79%|███████▉  | 213/268 [00:27<00:06,  8.01it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  8.08it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:06,  8.13it/s]Test-loop:  82%|████████▏ | 219/268 [00:28<00:05,  8.26it/s]Test-loop:  82%|████████▏ | 221/268 [00:28<00:05,  8.14it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  8.13it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.03it/s]Test-loop:  85%|████████▍ | 227/268 [00:29<00:05,  8.04it/s]Test-loop:  85%|████████▌ | 229/268 [00:29<00:04,  7.86it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  7.92it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  7.96it/s]Test-loop:  88%|████████▊ | 235/268 [00:30<00:04,  7.93it/s]Test-loop:  88%|████████▊ | 237/268 [00:30<00:03,  8.02it/s]Test-loop:  89%|████████▉ | 239/268 [00:30<00:03,  8.06it/s]Test-loop:  90%|████████▉ | 241/268 [00:30<00:03,  8.03it/s]Test-loop:  91%|█████████ | 243/268 [00:31<00:03,  8.03it/s]Test-loop:  91%|█████████▏| 245/268 [00:31<00:02,  7.80it/s]Test-loop:  92%|█████████▏| 247/268 [00:31<00:02,  7.92it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  8.12it/s]Test-loop:  94%|█████████▎| 251/268 [00:32<00:02,  8.22it/s]Test-loop:  94%|█████████▍| 253/268 [00:32<00:01,  8.28it/s]Test-loop:  95%|█████████▌| 255/268 [00:32<00:01,  8.23it/s]Test-loop:  96%|█████████▌| 257/268 [00:32<00:01,  8.27it/s]Test-loop:  97%|█████████▋| 259/268 [00:33<00:01,  8.16it/s]Test-loop:  97%|█████████▋| 261/268 [00:33<00:00,  8.13it/s]Test-loop:  98%|█████████▊| 263/268 [00:33<00:00,  8.04it/s]Test-loop:  99%|█████████▉| 265/268 [00:33<00:00,  8.02it/s]Test-loop: 100%|█████████▉| 267/268 [00:34<00:00,  8.09it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  7.83it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3003/17098 [00:00<00:00, 30020.37it/s]Loading Data:  36%|███▌      | 6072/17098 [00:00<00:00, 30411.46it/s]Loading Data:  53%|█████▎    | 9128/17098 [00:00<00:00, 30475.21it/s]Loading Data:  71%|███████▏  | 12184/17098 [00:00<00:00, 30508.29it/s]Loading Data:  89%|████████▉ | 15247/17098 [00:00<00:00, 30550.85it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30507.99it/s]
Loading Data:   0%|          | 0/2849 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2849/2849 [00:00<00:00, 30178.13it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3012/17098 [00:00<00:00, 30118.31it/s]Loading Data:  35%|███▌      | 6066/17098 [00:00<00:00, 30363.22it/s]Loading Data:  53%|█████▎    | 9111/17098 [00:00<00:00, 30400.80it/s]Loading Data:  71%|███████▏  | 12185/17098 [00:00<00:00, 30532.76it/s]Loading Data:  89%|████████▉ | 15239/17098 [00:00<00:00, 30511.09it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30463.73it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:31,  1.42it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:10,  3.99it/s]Test-loop:  11%|█         | 5/45 [00:01<00:06,  6.00it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:05,  7.48it/s]Test-loop:  20%|██        | 9/45 [00:01<00:04,  8.54it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03,  9.32it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:03, 10.00it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 10.39it/s]Test-loop:  38%|███▊      | 17/45 [00:02<00:02, 10.61it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 10.82it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:02, 10.97it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 11.07it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 11.15it/s]Test-loop:  60%|██████    | 27/45 [00:03<00:01, 11.16it/s]Test-loop:  64%|██████▍   | 29/45 [00:03<00:01, 11.12it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 11.13it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:01, 11.28it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 11.36it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 11.42it/s]Test-loop:  87%|████████▋ | 39/45 [00:04<00:00, 11.57it/s]Test-loop:  91%|█████████ | 41/45 [00:04<00:00, 11.52it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 11.59it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 12.61it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00,  9.85it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:06,  1.44it/s]Test-loop:   1%|          | 3/268 [00:00<01:05,  4.05it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:43,  6.01it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:34,  7.52it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:29,  8.65it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:27,  9.50it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:25, 10.06it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:24, 10.37it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:23, 10.64it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:23, 10.79it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:22, 10.87it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:22, 10.97it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:22, 11.04it/s]Test-loop:  10%|█         | 27/268 [00:03<00:21, 11.20it/s]Test-loop:  11%|█         | 29/268 [00:03<00:20, 11.38it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:20, 11.34it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:20, 11.59it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:20, 11.62it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:19, 11.58it/s]Test-loop:  15%|█▍        | 39/268 [00:04<00:19, 11.58it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:19, 11.51it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:19, 11.45it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:19, 11.57it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:19, 11.55it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:18, 11.57it/s]Test-loop:  19%|█▉        | 51/268 [00:05<00:18, 11.69it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:18, 11.70it/s]Test-loop:  21%|██        | 55/268 [00:05<00:18, 11.63it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:18, 11.68it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:17, 11.71it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:17, 11.83it/s]Test-loop:  24%|██▎       | 63/268 [00:06<00:16, 12.20it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:16, 12.49it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:15, 12.67it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:15, 12.78it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:15, 13.00it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:14, 13.12it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:14, 12.99it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:15, 12.65it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:15, 12.19it/s]Test-loop:  30%|███       | 81/268 [00:07<00:15, 11.87it/s]Test-loop:  31%|███       | 83/268 [00:07<00:15, 11.60it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:15, 11.61it/s]Test-loop:  32%|███▏      | 87/268 [00:08<00:15, 11.69it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:15, 11.66it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:15, 11.67it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:15, 11.55it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:15, 11.52it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:14, 11.44it/s]Test-loop:  37%|███▋      | 99/268 [00:09<00:14, 11.50it/s]Test-loop:  38%|███▊      | 101/268 [00:09<00:14, 11.40it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:14, 11.46it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:14, 11.57it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:13, 11.78it/s]Test-loop:  41%|████      | 109/268 [00:09<00:13, 11.96it/s]Test-loop:  41%|████▏     | 111/268 [00:10<00:13, 11.74it/s]Test-loop:  42%|████▏     | 113/268 [00:10<00:13, 11.62it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:13, 11.65it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 11.80it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 11.70it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:12, 11.69it/s]Test-loop:  46%|████▌     | 123/268 [00:11<00:12, 11.73it/s]Test-loop:  47%|████▋     | 125/268 [00:11<00:12, 11.79it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 11.77it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 11.75it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 11.75it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:11, 11.76it/s]Test-loop:  50%|█████     | 135/268 [00:12<00:11, 11.73it/s]Test-loop:  51%|█████     | 137/268 [00:12<00:11, 11.56it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:11, 11.49it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:11, 11.53it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:10, 11.55it/s]Test-loop:  54%|█████▍    | 145/268 [00:13<00:10, 11.51it/s]Test-loop:  55%|█████▍    | 147/268 [00:13<00:10, 11.58it/s]Test-loop:  56%|█████▌    | 149/268 [00:13<00:10, 11.52it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:10, 11.64it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 11.63it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 11.64it/s]Test-loop:  59%|█████▊    | 157/268 [00:14<00:09, 11.52it/s]Test-loop:  59%|█████▉    | 159/268 [00:14<00:09, 11.61it/s]Test-loop:  60%|██████    | 161/268 [00:14<00:09, 11.58it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:09, 11.66it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 11.60it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 11.67it/s]Test-loop:  63%|██████▎   | 169/268 [00:15<00:08, 11.67it/s]Test-loop:  64%|██████▍   | 171/268 [00:15<00:08, 11.60it/s]Test-loop:  65%|██████▍   | 173/268 [00:15<00:08, 11.59it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:08, 11.57it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 11.47it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 11.49it/s]Test-loop:  68%|██████▊   | 181/268 [00:16<00:07, 11.50it/s]Test-loop:  68%|██████▊   | 183/268 [00:16<00:07, 11.56it/s]Test-loop:  69%|██████▉   | 185/268 [00:16<00:07, 11.72it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 11.87it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 11.97it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 11.76it/s]Test-loop:  72%|███████▏  | 193/268 [00:17<00:06, 11.87it/s]Test-loop:  73%|███████▎  | 195/268 [00:17<00:05, 12.32it/s]Test-loop:  74%|███████▎  | 197/268 [00:17<00:05, 12.51it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:05, 12.74it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 12.94it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:04, 13.10it/s]Test-loop:  76%|███████▋  | 205/268 [00:18<00:04, 13.32it/s]Test-loop:  77%|███████▋  | 207/268 [00:18<00:04, 13.21it/s]Test-loop:  78%|███████▊  | 209/268 [00:18<00:04, 12.83it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 12.48it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 12.24it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 12.10it/s]Test-loop:  81%|████████  | 217/268 [00:19<00:04, 12.04it/s]Test-loop:  82%|████████▏ | 219/268 [00:19<00:04, 12.07it/s]Test-loop:  82%|████████▏ | 221/268 [00:19<00:03, 12.03it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 11.89it/s]Test-loop:  84%|████████▍ | 225/268 [00:19<00:03, 11.74it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 11.76it/s]Test-loop:  85%|████████▌ | 229/268 [00:20<00:03, 11.81it/s]Test-loop:  86%|████████▌ | 231/268 [00:20<00:03, 11.69it/s]Test-loop:  87%|████████▋ | 233/268 [00:20<00:02, 11.73it/s]Test-loop:  88%|████████▊ | 235/268 [00:20<00:02, 11.58it/s]Test-loop:  88%|████████▊ | 237/268 [00:20<00:02, 11.54it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 11.51it/s]Test-loop:  90%|████████▉ | 241/268 [00:21<00:02, 11.63it/s]Test-loop:  91%|█████████ | 243/268 [00:21<00:02, 11.63it/s]Test-loop:  91%|█████████▏| 245/268 [00:21<00:01, 11.60it/s]Test-loop:  92%|█████████▏| 247/268 [00:21<00:01, 11.59it/s]Test-loop:  93%|█████████▎| 249/268 [00:21<00:01, 11.54it/s]Test-loop:  94%|█████████▎| 251/268 [00:21<00:01, 11.57it/s]Test-loop:  94%|█████████▍| 253/268 [00:22<00:01, 11.62it/s]Test-loop:  95%|█████████▌| 255/268 [00:22<00:01, 11.67it/s]Test-loop:  96%|█████████▌| 257/268 [00:22<00:00, 11.74it/s]Test-loop:  97%|█████████▋| 259/268 [00:22<00:00, 11.78it/s]Test-loop:  97%|█████████▋| 261/268 [00:22<00:00, 11.83it/s]Test-loop:  98%|█████████▊| 263/268 [00:22<00:00, 11.85it/s]Test-loop:  99%|█████████▉| 265/268 [00:23<00:00, 11.75it/s]Test-loop: 100%|█████████▉| 267/268 [00:23<00:00, 11.55it/s]Test-loop: 100%|██████████| 268/268 [00:23<00:00, 11.45it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:30,  1.27it/s]Test-loop:   1%|          | 3/268 [00:01<01:20,  3.30it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:56,  4.67it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:46,  5.66it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:41,  6.25it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:38,  6.68it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:36,  6.95it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:35,  7.19it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:33,  7.41it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:33,  7.53it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:32,  7.55it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:31,  7.81it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:31,  7.80it/s]Test-loop:  10%|█         | 27/268 [00:04<00:30,  7.91it/s]Test-loop:  11%|█         | 29/268 [00:04<00:31,  7.69it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:30,  7.76it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:29,  7.84it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:28,  8.06it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.87it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:29,  7.86it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:28,  7.96it/s]Test-loop:  16%|█▌        | 42/268 [00:06<00:27,  8.10it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:29,  7.70it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:28,  7.70it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:28,  7.83it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:28,  7.68it/s]Test-loop:  19%|█▉        | 51/268 [00:07<00:28,  7.69it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:28,  7.59it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.62it/s]Test-loop:  21%|██▏       | 57/268 [00:08<00:27,  7.62it/s]Test-loop:  22%|██▏       | 59/268 [00:08<00:26,  7.90it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:26,  7.89it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:25,  8.00it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:25,  7.84it/s]Test-loop:  25%|██▌       | 67/268 [00:09<00:25,  7.93it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:25,  7.96it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:24,  7.97it/s]Test-loop:  27%|██▋       | 73/268 [00:10<00:24,  7.84it/s]Test-loop:  28%|██▊       | 75/268 [00:10<00:25,  7.67it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:24,  7.67it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:24,  7.60it/s]Test-loop:  30%|███       | 81/268 [00:11<00:24,  7.61it/s]Test-loop:  31%|███       | 83/268 [00:11<00:24,  7.51it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:24,  7.39it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:24,  7.49it/s]Test-loop:  33%|███▎      | 89/268 [00:12<00:23,  7.52it/s]Test-loop:  34%|███▍      | 91/268 [00:12<00:24,  7.35it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:23,  7.51it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:22,  7.71it/s]Test-loop:  36%|███▌      | 97/268 [00:13<00:22,  7.64it/s]Test-loop:  37%|███▋      | 99/268 [00:13<00:22,  7.67it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:21,  7.70it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:21,  7.61it/s]Test-loop:  39%|███▉      | 105/268 [00:14<00:21,  7.68it/s]Test-loop:  40%|███▉      | 107/268 [00:14<00:20,  7.88it/s]Test-loop:  41%|████      | 109/268 [00:14<00:20,  7.86it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  7.90it/s]Test-loop:  42%|████▏     | 113/268 [00:15<00:19,  7.91it/s]Test-loop:  43%|████▎     | 115/268 [00:15<00:19,  7.80it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:19,  7.69it/s]Test-loop:  44%|████▍     | 119/268 [00:16<00:19,  7.76it/s]Test-loop:  45%|████▌     | 121/268 [00:16<00:18,  8.15it/s]Test-loop:  46%|████▌     | 123/268 [00:16<00:17,  8.20it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:17,  8.12it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  8.07it/s]Test-loop:  48%|████▊     | 129/268 [00:17<00:17,  7.96it/s]Test-loop:  49%|████▉     | 131/268 [00:17<00:17,  7.84it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  7.95it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  7.97it/s]Test-loop:  51%|█████     | 137/268 [00:18<00:16,  8.00it/s]Test-loop:  52%|█████▏    | 139/268 [00:18<00:16,  8.02it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:16,  7.93it/s]Test-loop:  53%|█████▎    | 143/268 [00:19<00:15,  7.90it/s]Test-loop:  54%|█████▍    | 145/268 [00:19<00:15,  8.06it/s]Test-loop:  55%|█████▍    | 147/268 [00:19<00:15,  8.05it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:15,  7.92it/s]Test-loop:  56%|█████▋    | 151/268 [00:20<00:14,  7.97it/s]Test-loop:  57%|█████▋    | 153/268 [00:20<00:14,  7.91it/s]Test-loop:  58%|█████▊    | 155/268 [00:20<00:14,  8.03it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  7.96it/s]Test-loop:  59%|█████▉    | 159/268 [00:21<00:13,  7.90it/s]Test-loop:  60%|██████    | 161/268 [00:21<00:13,  7.99it/s]Test-loop:  61%|██████    | 163/268 [00:21<00:13,  7.91it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:13,  7.84it/s]Test-loop:  62%|██████▏   | 167/268 [00:22<00:13,  7.70it/s]Test-loop:  63%|██████▎   | 169/268 [00:22<00:12,  7.68it/s]Test-loop:  64%|██████▍   | 171/268 [00:22<00:12,  7.66it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:12,  7.56it/s]Test-loop:  65%|██████▌   | 175/268 [00:23<00:11,  7.80it/s]Test-loop:  66%|██████▌   | 177/268 [00:23<00:11,  7.71it/s]Test-loop:  67%|██████▋   | 179/268 [00:23<00:11,  7.64it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:11,  7.90it/s]Test-loop:  68%|██████▊   | 182/268 [00:23<00:10,  8.08it/s]Test-loop:  68%|██████▊   | 183/268 [00:24<00:10,  7.99it/s]Test-loop:  69%|██████▊   | 184/268 [00:24<00:10,  7.84it/s]Test-loop:  69%|██████▉   | 185/268 [00:24<00:10,  8.02it/s]Test-loop:  69%|██████▉   | 186/268 [00:24<00:10,  7.54it/s]Test-loop:  70%|███████   | 188/268 [00:24<00:10,  7.50it/s]Test-loop:  71%|███████   | 190/268 [00:25<00:10,  7.80it/s]Test-loop:  72%|███████▏  | 192/268 [00:25<00:09,  7.88it/s]Test-loop:  72%|███████▏  | 193/268 [00:25<00:09,  8.11it/s]Test-loop:  72%|███████▏  | 194/268 [00:25<00:09,  7.72it/s]Test-loop:  73%|███████▎  | 196/268 [00:25<00:09,  7.72it/s]Test-loop:  74%|███████▍  | 198/268 [00:26<00:09,  7.75it/s]Test-loop:  75%|███████▍  | 200/268 [00:26<00:08,  7.68it/s]Test-loop:  75%|███████▌  | 202/268 [00:26<00:08,  7.80it/s]Test-loop:  76%|███████▌  | 203/268 [00:26<00:08,  8.00it/s]Test-loop:  76%|███████▌  | 204/268 [00:26<00:08,  7.79it/s]Test-loop:  76%|███████▋  | 205/268 [00:26<00:08,  7.70it/s]Test-loop:  77%|███████▋  | 206/268 [00:27<00:07,  7.96it/s]Test-loop:  77%|███████▋  | 207/268 [00:27<00:08,  7.51it/s]Test-loop:  78%|███████▊  | 208/268 [00:27<00:07,  7.95it/s]Test-loop:  78%|███████▊  | 209/268 [00:27<00:07,  7.66it/s]Test-loop:  78%|███████▊  | 210/268 [00:27<00:07,  8.02it/s]Test-loop:  79%|███████▊  | 211/268 [00:27<00:07,  7.77it/s]Test-loop:  79%|███████▉  | 212/268 [00:27<00:06,  8.29it/s]Test-loop:  79%|███████▉  | 213/268 [00:27<00:06,  8.13it/s]Test-loop:  80%|███████▉  | 214/268 [00:28<00:06,  8.33it/s]Test-loop:  80%|████████  | 215/268 [00:28<00:06,  8.34it/s]Test-loop:  81%|████████  | 216/268 [00:28<00:06,  8.25it/s]Test-loop:  81%|████████  | 217/268 [00:28<00:06,  8.15it/s]Test-loop:  81%|████████▏ | 218/268 [00:28<00:06,  7.74it/s]Test-loop:  82%|████████▏ | 219/268 [00:28<00:06,  8.14it/s]Test-loop:  82%|████████▏ | 220/268 [00:28<00:06,  7.73it/s]Test-loop:  82%|████████▏ | 221/268 [00:28<00:05,  8.19it/s]Test-loop:  83%|████████▎ | 222/268 [00:29<00:05,  7.78it/s]Test-loop:  83%|████████▎ | 223/268 [00:29<00:05,  8.30it/s]Test-loop:  84%|████████▎ | 224/268 [00:29<00:05,  7.82it/s]Test-loop:  84%|████████▍ | 225/268 [00:29<00:05,  8.19it/s]Test-loop:  84%|████████▍ | 226/268 [00:29<00:05,  7.80it/s]Test-loop:  85%|████████▍ | 227/268 [00:29<00:05,  8.20it/s]Test-loop:  85%|████████▌ | 228/268 [00:29<00:05,  7.78it/s]Test-loop:  85%|████████▌ | 229/268 [00:29<00:04,  8.03it/s]Test-loop:  86%|████████▌ | 230/268 [00:30<00:04,  8.06it/s]Test-loop:  86%|████████▌ | 231/268 [00:30<00:04,  8.13it/s]Test-loop:  87%|████████▋ | 232/268 [00:30<00:04,  7.95it/s]Test-loop:  87%|████████▋ | 233/268 [00:30<00:04,  7.97it/s]Test-loop:  87%|████████▋ | 234/268 [00:30<00:04,  7.90it/s]Test-loop:  88%|████████▊ | 235/268 [00:30<00:04,  7.85it/s]Test-loop:  88%|████████▊ | 236/268 [00:30<00:04,  7.68it/s]Test-loop:  88%|████████▊ | 237/268 [00:30<00:03,  8.05it/s]Test-loop:  89%|████████▉ | 238/268 [00:31<00:03,  7.56it/s]Test-loop:  90%|████████▉ | 240/268 [00:31<00:03,  7.68it/s]Test-loop:  90%|█████████ | 242/268 [00:31<00:03,  7.83it/s]Test-loop:  91%|█████████ | 244/268 [00:31<00:03,  7.87it/s]Test-loop:  91%|█████████▏| 245/268 [00:31<00:02,  7.99it/s]Test-loop:  92%|█████████▏| 247/268 [00:32<00:02,  8.27it/s]Test-loop:  93%|█████████▎| 249/268 [00:32<00:02,  8.47it/s]Test-loop:  93%|█████████▎| 250/268 [00:32<00:02,  8.52it/s]Test-loop:  94%|█████████▎| 251/268 [00:32<00:02,  8.35it/s]Test-loop:  94%|█████████▍| 252/268 [00:32<00:01,  8.24it/s]Test-loop:  94%|█████████▍| 253/268 [00:32<00:01,  8.35it/s]Test-loop:  95%|█████████▍| 254/268 [00:33<00:01,  7.71it/s]Test-loop:  96%|█████████▌| 256/268 [00:33<00:01,  7.88it/s]Test-loop:  96%|█████████▋| 258/268 [00:33<00:01,  7.79it/s]Test-loop:  97%|█████████▋| 260/268 [00:33<00:01,  7.81it/s]Test-loop:  98%|█████████▊| 262/268 [00:34<00:00,  7.78it/s]Test-loop:  99%|█████████▊| 264/268 [00:34<00:00,  7.95it/s]Test-loop:  99%|█████████▉| 265/268 [00:34<00:00,  8.19it/s]Test-loop:  99%|█████████▉| 266/268 [00:34<00:00,  7.81it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  9.29it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  7.71it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3018/17098 [00:00<00:00, 30172.55it/s]Loading Data:  36%|███▌      | 6074/17098 [00:00<00:00, 30396.70it/s]Loading Data:  53%|█████▎    | 9137/17098 [00:00<00:00, 30500.31it/s]Loading Data:  71%|███████▏  | 12216/17098 [00:00<00:00, 30611.82it/s]Loading Data:  89%|████████▉ | 15289/17098 [00:00<00:00, 30652.57it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30584.77it/s]
Loading Data:   0%|          | 0/2849 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2849/2849 [00:00<00:00, 29729.37it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3025/17098 [00:00<00:00, 30240.30it/s]Loading Data:  36%|███▌      | 6087/17098 [00:00<00:00, 30459.67it/s]Loading Data:  53%|█████▎    | 9133/17098 [00:00<00:00, 30409.78it/s]Loading Data:  71%|███████   | 12174/17098 [00:00<00:00, 30399.16it/s]Loading Data:  89%|████████▉ | 15230/17098 [00:00<00:00, 30455.47it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30459.14it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:30,  1.45it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:10,  4.16it/s]Test-loop:  11%|█         | 5/45 [00:01<00:06,  6.46it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.35it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.73it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.41it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 10.89it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.27it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 11.32it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.54it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:02, 11.61it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 11.63it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 11.64it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 11.64it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 11.77it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 11.76it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:01, 11.73it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 11.80it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 11.82it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 11.87it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 11.97it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 12.07it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 13.01it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.41it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:05,  1.44it/s]Test-loop:   1%|          | 3/268 [00:00<01:03,  4.18it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:41,  6.40it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:31,  8.24it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:27,  9.51it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:25, 10.24it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:23, 10.82it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:22, 11.21it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:22, 11.38it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:21, 11.47it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:21, 11.50it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:20, 11.70it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:20, 11.70it/s]Test-loop:  10%|█         | 27/268 [00:02<00:20, 11.87it/s]Test-loop:  11%|█         | 29/268 [00:02<00:20, 11.81it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:19, 11.86it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:19, 11.91it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:19, 11.94it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:19, 11.82it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:19, 11.91it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:19, 11.86it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:19, 11.82it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:18, 11.87it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:18, 11.90it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:18, 11.90it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:18, 11.85it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:18, 11.73it/s]Test-loop:  21%|██        | 55/268 [00:05<00:18, 11.62it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:18, 11.55it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:18, 11.58it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:17, 11.58it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:17, 11.64it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:17, 11.63it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:17, 11.69it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:16, 11.76it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:17, 11.59it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:16, 11.63it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:16, 11.58it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:16, 11.52it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:16, 11.57it/s]Test-loop:  30%|███       | 81/268 [00:07<00:16, 11.52it/s]Test-loop:  31%|███       | 83/268 [00:07<00:15, 11.62it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:15, 11.62it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:15, 11.60it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:15, 11.71it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:15, 11.68it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:14, 11.81it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:14, 11.84it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:14, 11.90it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:14, 11.87it/s]Test-loop:  38%|███▊      | 101/268 [00:09<00:14, 11.90it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:14, 11.76it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:13, 11.74it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:13, 11.64it/s]Test-loop:  41%|████      | 109/268 [00:09<00:13, 11.69it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:13, 11.73it/s]Test-loop:  42%|████▏     | 113/268 [00:10<00:12, 12.10it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:12, 12.28it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 12.28it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 12.25it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:12, 12.18it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:11, 12.12it/s]Test-loop:  47%|████▋     | 125/268 [00:11<00:11, 12.06it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 11.88it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 11.80it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 11.65it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:11, 11.75it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:10, 12.20it/s]Test-loop:  51%|█████     | 137/268 [00:12<00:10, 12.57it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:09, 13.07it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:09, 13.26it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:09, 13.44it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:09, 13.52it/s]Test-loop:  55%|█████▍    | 147/268 [00:12<00:09, 13.37it/s]Test-loop:  56%|█████▌    | 149/268 [00:12<00:08, 13.55it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:09, 12.88it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 12.46it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 12.22it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:09, 12.09it/s]Test-loop:  59%|█████▉    | 159/268 [00:13<00:09, 11.96it/s]Test-loop:  60%|██████    | 161/268 [00:14<00:09, 11.80it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:08, 11.79it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 11.83it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 11.90it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:08, 12.04it/s]Test-loop:  64%|██████▍   | 171/268 [00:14<00:08, 11.93it/s]Test-loop:  65%|██████▍   | 173/268 [00:15<00:07, 11.93it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:07, 11.82it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 11.89it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 12.04it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:07, 12.11it/s]Test-loop:  68%|██████▊   | 183/268 [00:15<00:07, 11.93it/s]Test-loop:  69%|██████▉   | 185/268 [00:16<00:07, 11.73it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 11.78it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 11.87it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 11.87it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:06, 12.12it/s]Test-loop:  73%|███████▎  | 195/268 [00:16<00:05, 12.19it/s]Test-loop:  74%|███████▎  | 197/268 [00:17<00:05, 12.14it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:05, 12.03it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 12.00it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 11.90it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 11.86it/s]Test-loop:  77%|███████▋  | 207/268 [00:17<00:05, 11.79it/s]Test-loop:  78%|███████▊  | 209/268 [00:18<00:04, 11.81it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 11.85it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 11.91it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 11.79it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:04, 11.72it/s]Test-loop:  82%|████████▏ | 219/268 [00:18<00:04, 11.66it/s]Test-loop:  82%|████████▏ | 221/268 [00:19<00:04, 11.74it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 11.74it/s]Test-loop:  84%|████████▍ | 225/268 [00:19<00:03, 11.67it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 11.71it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:03, 11.70it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:03, 11.73it/s]Test-loop:  87%|████████▋ | 233/268 [00:20<00:02, 11.68it/s]Test-loop:  88%|████████▊ | 235/268 [00:20<00:02, 11.59it/s]Test-loop:  88%|████████▊ | 237/268 [00:20<00:02, 11.74it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 11.89it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:02, 11.92it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:02, 12.06it/s]Test-loop:  91%|█████████▏| 245/268 [00:21<00:01, 12.00it/s]Test-loop:  92%|█████████▏| 247/268 [00:21<00:01, 11.96it/s]Test-loop:  93%|█████████▎| 249/268 [00:21<00:01, 11.93it/s]Test-loop:  94%|█████████▎| 251/268 [00:21<00:01, 11.87it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 11.93it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:01, 11.96it/s]Test-loop:  96%|█████████▌| 257/268 [00:22<00:00, 11.85it/s]Test-loop:  97%|█████████▋| 259/268 [00:22<00:00, 11.91it/s]Test-loop:  97%|█████████▋| 261/268 [00:22<00:00, 12.02it/s]Test-loop:  98%|█████████▊| 263/268 [00:22<00:00, 12.14it/s]Test-loop:  99%|█████████▉| 265/268 [00:22<00:00, 12.11it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 11.97it/s]Test-loop: 100%|██████████| 268/268 [00:23<00:00, 11.64it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:35,  1.24it/s]Test-loop:   1%|          | 3/268 [00:01<01:22,  3.23it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:56,  4.67it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:46,  5.65it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:40,  6.38it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:37,  6.84it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:35,  7.12it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:34,  7.37it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:32,  7.64it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:32,  7.68it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:31,  7.83it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:31,  7.79it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:31,  7.78it/s]Test-loop:  10%|█         | 27/268 [00:04<00:30,  7.77it/s]Test-loop:  11%|█         | 29/268 [00:04<00:30,  7.89it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:29,  7.95it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:28,  8.39it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:28,  8.05it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.88it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:28,  7.94it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:29,  7.76it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:29,  7.72it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:28,  7.82it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:27,  7.89it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:27,  7.91it/s]Test-loop:  19%|█▉        | 51/268 [00:07<00:27,  8.02it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:26,  8.09it/s]Test-loop:  21%|██        | 55/268 [00:07<00:26,  7.99it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:26,  8.01it/s]Test-loop:  22%|██▏       | 59/268 [00:08<00:26,  7.88it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:26,  7.91it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:25,  8.00it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:25,  7.97it/s]Test-loop:  25%|██▌       | 67/268 [00:09<00:25,  7.87it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:25,  7.85it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:24,  7.94it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:24,  8.06it/s]Test-loop:  28%|██▊       | 75/268 [00:10<00:23,  8.19it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:23,  8.20it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  8.06it/s]Test-loop:  30%|███       | 81/268 [00:10<00:23,  8.00it/s]Test-loop:  31%|███       | 83/268 [00:11<00:23,  8.02it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:22,  8.14it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  8.18it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  8.14it/s]Test-loop:  34%|███▍      | 91/268 [00:12<00:21,  8.18it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:21,  8.10it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.05it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  7.96it/s]Test-loop:  37%|███▋      | 99/268 [00:13<00:21,  8.01it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.18it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  8.09it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:20,  7.92it/s]Test-loop:  40%|███▉      | 107/268 [00:14<00:20,  7.86it/s]Test-loop:  41%|████      | 109/268 [00:14<00:20,  7.94it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  7.85it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:19,  7.84it/s]Test-loop:  43%|████▎     | 115/268 [00:15<00:20,  7.62it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:19,  7.61it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:19,  7.84it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:18,  8.00it/s]Test-loop:  46%|████▌     | 123/268 [00:16<00:18,  8.02it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:18,  7.86it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  7.96it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:17,  7.94it/s]Test-loop:  49%|████▉     | 131/268 [00:17<00:17,  7.92it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.04it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  7.92it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:16,  8.02it/s]Test-loop:  52%|█████▏    | 139/268 [00:18<00:16,  7.86it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:16,  7.83it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  8.05it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:15,  8.03it/s]Test-loop:  55%|█████▍    | 147/268 [00:19<00:15,  7.88it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:15,  7.93it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  7.87it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:14,  7.96it/s]Test-loop:  58%|█████▊    | 155/268 [00:20<00:14,  7.99it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:14,  7.89it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  7.87it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:13,  7.76it/s]Test-loop:  61%|██████    | 163/268 [00:21<00:13,  7.63it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:13,  7.58it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:13,  7.65it/s]Test-loop:  63%|██████▎   | 169/268 [00:21<00:12,  7.85it/s]Test-loop:  64%|██████▍   | 171/268 [00:22<00:12,  7.80it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:12,  7.86it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  7.77it/s]Test-loop:  66%|██████▌   | 177/268 [00:23<00:11,  7.75it/s]Test-loop:  67%|██████▋   | 179/268 [00:23<00:11,  7.76it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:11,  7.82it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  8.08it/s]Test-loop:  69%|██████▉   | 185/268 [00:24<00:10,  7.93it/s]Test-loop:  70%|██████▉   | 187/268 [00:24<00:10,  7.74it/s]Test-loop:  71%|███████   | 189/268 [00:24<00:10,  7.83it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  7.84it/s]Test-loop:  72%|███████▏  | 193/268 [00:25<00:09,  7.99it/s]Test-loop:  73%|███████▎  | 195/268 [00:25<00:08,  8.18it/s]Test-loop:  74%|███████▎  | 197/268 [00:25<00:08,  8.29it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  8.25it/s]Test-loop:  75%|███████▌  | 201/268 [00:26<00:08,  7.94it/s]Test-loop:  76%|███████▌  | 203/268 [00:26<00:08,  7.89it/s]Test-loop:  76%|███████▋  | 205/268 [00:26<00:07,  8.13it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  8.22it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:07,  8.14it/s]Test-loop:  79%|███████▊  | 211/268 [00:27<00:06,  8.15it/s]Test-loop:  79%|███████▉  | 213/268 [00:27<00:06,  8.14it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  8.18it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:06,  8.12it/s]Test-loop:  82%|████████▏ | 219/268 [00:28<00:06,  8.02it/s]Test-loop:  82%|████████▏ | 221/268 [00:28<00:05,  8.21it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  8.45it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.45it/s]Test-loop:  85%|████████▍ | 227/268 [00:29<00:05,  8.13it/s]Test-loop:  85%|████████▌ | 229/268 [00:29<00:04,  7.98it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  7.96it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  8.00it/s]Test-loop:  88%|████████▊ | 235/268 [00:30<00:04,  7.86it/s]Test-loop:  88%|████████▊ | 237/268 [00:30<00:03,  7.91it/s]Test-loop:  89%|████████▉ | 239/268 [00:30<00:03,  8.08it/s]Test-loop:  90%|████████▉ | 241/268 [00:30<00:03,  8.11it/s]Test-loop:  91%|█████████ | 243/268 [00:31<00:03,  8.26it/s]Test-loop:  91%|█████████▏| 245/268 [00:31<00:02,  8.30it/s]Test-loop:  92%|█████████▏| 247/268 [00:31<00:02,  8.18it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  7.98it/s]Test-loop:  94%|█████████▎| 251/268 [00:32<00:02,  7.93it/s]Test-loop:  94%|█████████▍| 253/268 [00:32<00:01,  7.91it/s]Test-loop:  95%|█████████▌| 255/268 [00:32<00:01,  7.92it/s]Test-loop:  96%|█████████▌| 257/268 [00:32<00:01,  7.91it/s]Test-loop:  97%|█████████▋| 259/268 [00:33<00:01,  7.98it/s]Test-loop:  97%|█████████▋| 261/268 [00:33<00:00,  8.04it/s]Test-loop:  98%|█████████▊| 263/268 [00:33<00:00,  7.88it/s]Test-loop:  99%|█████████▉| 265/268 [00:33<00:00,  7.89it/s]Test-loop: 100%|█████████▉| 267/268 [00:34<00:00,  7.60it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  7.81it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3000/17098 [00:00<00:00, 29993.59it/s]Loading Data:  35%|███▌      | 6045/17098 [00:00<00:00, 30255.95it/s]Loading Data:  53%|█████▎    | 9098/17098 [00:00<00:00, 30376.39it/s]Loading Data:  71%|███████   | 12164/17098 [00:00<00:00, 30487.23it/s]Loading Data:  89%|████████▉ | 15223/17098 [00:00<00:00, 30522.14it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30462.54it/s]
Loading Data:   0%|          | 0/2849 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2849/2849 [00:00<00:00, 30196.96it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3013/17098 [00:00<00:00, 30128.02it/s]Loading Data:  35%|███▌      | 6048/17098 [00:00<00:00, 30252.88it/s]Loading Data:  53%|█████▎    | 9091/17098 [00:00<00:00, 30332.31it/s]Loading Data:  71%|███████   | 12135/17098 [00:00<00:00, 30374.46it/s]Loading Data:  89%|████████▊ | 15173/17098 [00:00<00:00, 30359.32it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30337.08it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:29,  1.50it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.43it/s]Test-loop:  11%|█         | 5/45 [00:00<00:05,  6.71it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.49it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.76it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.69it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 11.33it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.83it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 12.24it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 12.44it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 12.53it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 12.72it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.70it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 12.74it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 12.71it/s]Test-loop:  69%|██████▉   | 31/45 [00:02<00:01, 12.71it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.73it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.87it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 12.80it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.92it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.88it/s]Test-loop:  96%|█████████▌| 43/45 [00:03<00:00, 12.94it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 13.71it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 11.07it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:59,  1.48it/s]Test-loop:   1%|          | 3/268 [00:00<01:02,  4.26it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:41,  6.36it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:32,  8.06it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:27,  9.31it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:25, 10.25it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:23, 11.02it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:21, 11.70it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:20, 12.06it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:20, 12.22it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:19, 12.37it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:19, 12.48it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:19, 12.49it/s]Test-loop:  10%|█         | 27/268 [00:02<00:19, 12.60it/s]Test-loop:  11%|█         | 29/268 [00:02<00:18, 12.80it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:18, 12.90it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:18, 12.93it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:17, 12.97it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:17, 13.13it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:17, 13.23it/s]Test-loop:  15%|█▌        | 41/268 [00:03<00:17, 13.17it/s]Test-loop:  16%|█▌        | 43/268 [00:03<00:17, 13.22it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:16, 13.31it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:16, 13.10it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:16, 12.99it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:16, 12.98it/s]Test-loop:  20%|█▉        | 53/268 [00:04<00:16, 13.12it/s]Test-loop:  21%|██        | 55/268 [00:04<00:16, 13.16it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:15, 13.24it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:15, 13.10it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:15, 13.01it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:15, 12.98it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:15, 12.86it/s]Test-loop:  25%|██▌       | 67/268 [00:05<00:15, 12.90it/s]Test-loop:  26%|██▌       | 69/268 [00:05<00:15, 12.96it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:15, 12.98it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:15, 12.86it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:14, 13.02it/s]Test-loop:  29%|██▊       | 77/268 [00:06<00:14, 13.41it/s]Test-loop:  29%|██▉       | 79/268 [00:06<00:13, 13.73it/s]Test-loop:  30%|███       | 81/268 [00:06<00:13, 13.98it/s]Test-loop:  31%|███       | 83/268 [00:06<00:13, 13.88it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:13, 14.01it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:12, 13.93it/s]Test-loop:  33%|███▎      | 89/268 [00:07<00:12, 13.95it/s]Test-loop:  34%|███▍      | 91/268 [00:07<00:12, 14.01it/s]Test-loop:  35%|███▍      | 93/268 [00:07<00:12, 13.89it/s]Test-loop:  35%|███▌      | 95/268 [00:07<00:12, 13.58it/s]Test-loop:  36%|███▌      | 97/268 [00:07<00:12, 13.52it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:12, 13.30it/s]Test-loop:  38%|███▊      | 101/268 [00:08<00:12, 13.28it/s]Test-loop:  38%|███▊      | 103/268 [00:08<00:12, 13.35it/s]Test-loop:  39%|███▉      | 105/268 [00:08<00:12, 13.34it/s]Test-loop:  40%|███▉      | 107/268 [00:08<00:12, 13.16it/s]Test-loop:  41%|████      | 109/268 [00:08<00:12, 13.06it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:12, 12.95it/s]Test-loop:  42%|████▏     | 113/268 [00:09<00:12, 12.89it/s]Test-loop:  43%|████▎     | 115/268 [00:09<00:11, 12.87it/s]Test-loop:  44%|████▎     | 117/268 [00:09<00:11, 12.85it/s]Test-loop:  44%|████▍     | 119/268 [00:09<00:11, 13.09it/s]Test-loop:  45%|████▌     | 121/268 [00:09<00:11, 13.04it/s]Test-loop:  46%|████▌     | 123/268 [00:09<00:11, 12.92it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:11, 12.93it/s]Test-loop:  47%|████▋     | 127/268 [00:10<00:10, 13.18it/s]Test-loop:  48%|████▊     | 129/268 [00:10<00:10, 13.51it/s]Test-loop:  49%|████▉     | 131/268 [00:10<00:09, 13.77it/s]Test-loop:  50%|████▉     | 133/268 [00:10<00:09, 14.00it/s]Test-loop:  50%|█████     | 135/268 [00:10<00:09, 14.03it/s]Test-loop:  51%|█████     | 137/268 [00:10<00:09, 14.11it/s]Test-loop:  52%|█████▏    | 139/268 [00:11<00:09, 14.08it/s]Test-loop:  53%|█████▎    | 141/268 [00:11<00:09, 13.95it/s]Test-loop:  53%|█████▎    | 143/268 [00:11<00:08, 13.95it/s]Test-loop:  54%|█████▍    | 145/268 [00:11<00:08, 13.79it/s]Test-loop:  55%|█████▍    | 147/268 [00:11<00:08, 13.76it/s]Test-loop:  56%|█████▌    | 149/268 [00:11<00:08, 13.64it/s]Test-loop:  56%|█████▋    | 151/268 [00:12<00:08, 13.47it/s]Test-loop:  57%|█████▋    | 153/268 [00:12<00:08, 13.36it/s]Test-loop:  58%|█████▊    | 155/268 [00:12<00:08, 13.25it/s]Test-loop:  59%|█████▊    | 157/268 [00:12<00:08, 13.06it/s]Test-loop:  59%|█████▉    | 159/268 [00:12<00:08, 12.95it/s]Test-loop:  60%|██████    | 161/268 [00:12<00:08, 12.88it/s]Test-loop:  61%|██████    | 163/268 [00:12<00:08, 12.85it/s]Test-loop:  62%|██████▏   | 165/268 [00:13<00:08, 12.86it/s]Test-loop:  62%|██████▏   | 167/268 [00:13<00:07, 12.89it/s]Test-loop:  63%|██████▎   | 169/268 [00:13<00:07, 12.87it/s]Test-loop:  64%|██████▍   | 171/268 [00:13<00:07, 12.84it/s]Test-loop:  65%|██████▍   | 173/268 [00:13<00:07, 12.80it/s]Test-loop:  65%|██████▌   | 175/268 [00:13<00:07, 12.87it/s]Test-loop:  66%|██████▌   | 177/268 [00:14<00:07, 12.96it/s]Test-loop:  67%|██████▋   | 179/268 [00:14<00:06, 12.87it/s]Test-loop:  68%|██████▊   | 181/268 [00:14<00:06, 12.92it/s]Test-loop:  68%|██████▊   | 183/268 [00:14<00:06, 12.95it/s]Test-loop:  69%|██████▉   | 185/268 [00:14<00:06, 13.07it/s]Test-loop:  70%|██████▉   | 187/268 [00:14<00:06, 13.05it/s]Test-loop:  71%|███████   | 189/268 [00:14<00:05, 13.17it/s]Test-loop:  71%|███████▏  | 191/268 [00:15<00:05, 13.21it/s]Test-loop:  72%|███████▏  | 193/268 [00:15<00:05, 13.22it/s]Test-loop:  73%|███████▎  | 195/268 [00:15<00:05, 13.20it/s]Test-loop:  74%|███████▎  | 197/268 [00:15<00:05, 13.12it/s]Test-loop:  74%|███████▍  | 199/268 [00:15<00:05, 13.13it/s]Test-loop:  75%|███████▌  | 201/268 [00:15<00:05, 13.13it/s]Test-loop:  76%|███████▌  | 203/268 [00:16<00:04, 13.10it/s]Test-loop:  76%|███████▋  | 205/268 [00:16<00:04, 13.05it/s]Test-loop:  77%|███████▋  | 207/268 [00:16<00:04, 13.00it/s]Test-loop:  78%|███████▊  | 209/268 [00:16<00:04, 12.94it/s]Test-loop:  79%|███████▊  | 211/268 [00:16<00:04, 12.91it/s]Test-loop:  79%|███████▉  | 213/268 [00:16<00:04, 12.87it/s]Test-loop:  80%|████████  | 215/268 [00:16<00:04, 12.79it/s]Test-loop:  81%|████████  | 217/268 [00:17<00:03, 12.93it/s]Test-loop:  82%|████████▏ | 219/268 [00:17<00:03, 12.87it/s]Test-loop:  82%|████████▏ | 221/268 [00:17<00:03, 12.84it/s]Test-loop:  83%|████████▎ | 223/268 [00:17<00:03, 12.87it/s]Test-loop:  84%|████████▍ | 225/268 [00:17<00:03, 12.81it/s]Test-loop:  85%|████████▍ | 227/268 [00:17<00:03, 12.94it/s]Test-loop:  85%|████████▌ | 229/268 [00:18<00:03, 12.96it/s]Test-loop:  86%|████████▌ | 231/268 [00:18<00:02, 13.02it/s]Test-loop:  87%|████████▋ | 233/268 [00:18<00:02, 12.85it/s]Test-loop:  88%|████████▊ | 235/268 [00:18<00:02, 13.05it/s]Test-loop:  88%|████████▊ | 237/268 [00:18<00:02, 13.33it/s]Test-loop:  89%|████████▉ | 239/268 [00:18<00:02, 13.68it/s]Test-loop:  90%|████████▉ | 241/268 [00:18<00:01, 13.85it/s]Test-loop:  91%|█████████ | 243/268 [00:19<00:01, 13.76it/s]Test-loop:  91%|█████████▏| 245/268 [00:19<00:01, 13.43it/s]Test-loop:  92%|█████████▏| 247/268 [00:19<00:01, 13.19it/s]Test-loop:  93%|█████████▎| 249/268 [00:19<00:01, 13.06it/s]Test-loop:  94%|█████████▎| 251/268 [00:19<00:01, 12.99it/s]Test-loop:  94%|█████████▍| 253/268 [00:19<00:01, 13.11it/s]Test-loop:  95%|█████████▌| 255/268 [00:19<00:00, 13.08it/s]Test-loop:  96%|█████████▌| 257/268 [00:20<00:00, 13.09it/s]Test-loop:  97%|█████████▋| 259/268 [00:20<00:00, 12.98it/s]Test-loop:  97%|█████████▋| 261/268 [00:20<00:00, 12.95it/s]Test-loop:  98%|█████████▊| 263/268 [00:20<00:00, 13.03it/s]Test-loop:  99%|█████████▉| 265/268 [00:20<00:00, 13.08it/s]Test-loop: 100%|█████████▉| 267/268 [00:20<00:00, 12.97it/s]Test-loop: 100%|██████████| 268/268 [00:21<00:00, 12.76it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:30,  1.27it/s]Test-loop:   1%|          | 3/268 [00:01<01:18,  3.38it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:54,  4.81it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:44,  5.92it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:38,  6.70it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:36,  7.09it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:33,  7.59it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:33,  7.59it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:32,  7.68it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:31,  7.92it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:30,  8.01it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:30,  8.10it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:29,  8.18it/s]Test-loop:  10%|█         | 27/268 [00:03<00:29,  8.14it/s]Test-loop:  11%|█         | 29/268 [00:04<00:28,  8.31it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:28,  8.21it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:29,  8.09it/s]Test-loop:  13%|█▎        | 35/268 [00:04<00:29,  7.92it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:28,  8.06it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:27,  8.18it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:27,  8.30it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:26,  8.37it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:26,  8.38it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:26,  8.29it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:26,  8.22it/s]Test-loop:  19%|█▉        | 51/268 [00:06<00:26,  8.23it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:26,  8.14it/s]Test-loop:  21%|██        | 55/268 [00:07<00:25,  8.32it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:25,  8.26it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:25,  8.25it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:24,  8.31it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:24,  8.41it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:23,  8.60it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:23,  8.60it/s]Test-loop:  26%|██▌       | 69/268 [00:08<00:22,  8.67it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:22,  8.69it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:22,  8.48it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:22,  8.45it/s]Test-loop:  29%|██▊       | 77/268 [00:09<00:23,  8.23it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  8.15it/s]Test-loop:  30%|███       | 81/268 [00:10<00:22,  8.23it/s]Test-loop:  31%|███       | 83/268 [00:10<00:22,  8.25it/s]Test-loop:  32%|███▏      | 85/268 [00:10<00:22,  8.06it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  8.12it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  8.09it/s]Test-loop:  34%|███▍      | 91/268 [00:11<00:21,  8.24it/s]Test-loop:  35%|███▍      | 93/268 [00:11<00:21,  8.26it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:20,  8.28it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:20,  8.41it/s]Test-loop:  37%|███▋      | 99/268 [00:12<00:20,  8.42it/s]Test-loop:  38%|███▊      | 101/268 [00:12<00:19,  8.54it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:18,  8.69it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:19,  8.46it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:19,  8.32it/s]Test-loop:  41%|████      | 109/268 [00:13<00:19,  8.22it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  8.18it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:18,  8.18it/s]Test-loop:  43%|████▎     | 115/268 [00:14<00:18,  8.45it/s]Test-loop:  44%|████▎     | 117/268 [00:14<00:18,  8.36it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:17,  8.39it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:17,  8.53it/s]Test-loop:  46%|████▌     | 123/268 [00:15<00:16,  8.55it/s]Test-loop:  47%|████▋     | 125/268 [00:15<00:16,  8.44it/s]Test-loop:  47%|████▋     | 127/268 [00:15<00:16,  8.46it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:16,  8.30it/s]Test-loop:  49%|████▉     | 131/268 [00:16<00:16,  8.39it/s]Test-loop:  50%|████▉     | 133/268 [00:16<00:15,  8.71it/s]Test-loop:  50%|█████     | 135/268 [00:16<00:15,  8.55it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:15,  8.45it/s]Test-loop:  52%|█████▏    | 139/268 [00:17<00:15,  8.44it/s]Test-loop:  53%|█████▎    | 141/268 [00:17<00:15,  8.35it/s]Test-loop:  53%|█████▎    | 143/268 [00:17<00:15,  8.28it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:14,  8.27it/s]Test-loop:  55%|█████▍    | 147/268 [00:18<00:14,  8.25it/s]Test-loop:  56%|█████▌    | 149/268 [00:18<00:14,  8.27it/s]Test-loop:  56%|█████▋    | 151/268 [00:18<00:14,  8.28it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:13,  8.24it/s]Test-loop:  58%|█████▊    | 155/268 [00:19<00:13,  8.36it/s]Test-loop:  59%|█████▊    | 157/268 [00:19<00:13,  8.38it/s]Test-loop:  59%|█████▉    | 159/268 [00:19<00:13,  8.33it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:12,  8.29it/s]Test-loop:  61%|██████    | 163/268 [00:20<00:12,  8.28it/s]Test-loop:  62%|██████▏   | 165/268 [00:20<00:12,  8.48it/s]Test-loop:  62%|██████▏   | 167/268 [00:20<00:12,  8.42it/s]Test-loop:  63%|██████▎   | 169/268 [00:20<00:11,  8.40it/s]Test-loop:  64%|██████▍   | 171/268 [00:21<00:11,  8.46it/s]Test-loop:  65%|██████▍   | 173/268 [00:21<00:11,  8.35it/s]Test-loop:  65%|██████▌   | 175/268 [00:21<00:11,  8.15it/s]Test-loop:  66%|██████▌   | 177/268 [00:21<00:11,  8.11it/s]Test-loop:  67%|██████▋   | 179/268 [00:22<00:10,  8.19it/s]Test-loop:  68%|██████▊   | 181/268 [00:22<00:10,  8.24it/s]Test-loop:  68%|██████▊   | 183/268 [00:22<00:10,  8.30it/s]Test-loop:  69%|██████▉   | 185/268 [00:22<00:09,  8.37it/s]Test-loop:  70%|██████▉   | 187/268 [00:23<00:09,  8.21it/s]Test-loop:  71%|███████   | 189/268 [00:23<00:09,  8.22it/s]Test-loop:  71%|███████▏  | 191/268 [00:23<00:09,  8.40it/s]Test-loop:  72%|███████▏  | 193/268 [00:23<00:09,  8.28it/s]Test-loop:  73%|███████▎  | 195/268 [00:24<00:08,  8.39it/s]Test-loop:  74%|███████▎  | 197/268 [00:24<00:08,  8.23it/s]Test-loop:  74%|███████▍  | 199/268 [00:24<00:08,  8.26it/s]Test-loop:  75%|███████▌  | 201/268 [00:24<00:07,  8.40it/s]Test-loop:  76%|███████▌  | 203/268 [00:25<00:07,  8.36it/s]Test-loop:  76%|███████▋  | 205/268 [00:25<00:07,  8.59it/s]Test-loop:  77%|███████▋  | 207/268 [00:25<00:07,  8.49it/s]Test-loop:  78%|███████▊  | 209/268 [00:25<00:07,  8.29it/s]Test-loop:  79%|███████▊  | 211/268 [00:26<00:06,  8.39it/s]Test-loop:  79%|███████▉  | 213/268 [00:26<00:06,  8.38it/s]Test-loop:  80%|████████  | 215/268 [00:26<00:06,  8.36it/s]Test-loop:  81%|████████  | 217/268 [00:26<00:06,  8.43it/s]Test-loop:  82%|████████▏ | 219/268 [00:26<00:05,  8.36it/s]Test-loop:  82%|████████▏ | 221/268 [00:27<00:05,  8.36it/s]Test-loop:  83%|████████▎ | 223/268 [00:27<00:05,  8.47it/s]Test-loop:  84%|████████▍ | 225/268 [00:27<00:05,  8.32it/s]Test-loop:  85%|████████▍ | 227/268 [00:27<00:04,  8.40it/s]Test-loop:  85%|████████▌ | 229/268 [00:28<00:04,  8.39it/s]Test-loop:  86%|████████▌ | 231/268 [00:28<00:04,  8.31it/s]Test-loop:  87%|████████▋ | 233/268 [00:28<00:04,  8.33it/s]Test-loop:  88%|████████▊ | 235/268 [00:28<00:03,  8.35it/s]Test-loop:  88%|████████▊ | 237/268 [00:29<00:03,  8.37it/s]Test-loop:  89%|████████▉ | 239/268 [00:29<00:03,  8.17it/s]Test-loop:  90%|████████▉ | 241/268 [00:29<00:03,  8.28it/s]Test-loop:  91%|█████████ | 243/268 [00:29<00:03,  8.23it/s]Test-loop:  91%|█████████▏| 245/268 [00:30<00:02,  8.29it/s]Test-loop:  92%|█████████▏| 247/268 [00:30<00:02,  8.13it/s]Test-loop:  93%|█████████▎| 249/268 [00:30<00:02,  8.27it/s]Test-loop:  94%|█████████▎| 251/268 [00:30<00:02,  8.38it/s]Test-loop:  94%|█████████▍| 253/268 [00:31<00:01,  8.36it/s]Test-loop:  95%|█████████▌| 255/268 [00:31<00:01,  8.42it/s]Test-loop:  96%|█████████▌| 257/268 [00:31<00:01,  8.46it/s]Test-loop:  97%|█████████▋| 259/268 [00:31<00:01,  8.63it/s]Test-loop:  97%|█████████▋| 261/268 [00:32<00:00,  8.47it/s]Test-loop:  98%|█████████▊| 263/268 [00:32<00:00,  8.49it/s]Test-loop:  99%|█████████▉| 265/268 [00:32<00:00,  8.38it/s]Test-loop: 100%|█████████▉| 267/268 [00:32<00:00,  8.30it/s]Test-loop: 100%|██████████| 268/268 [00:32<00:00,  8.16it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  17%|█▋        | 2992/17098 [00:00<00:00, 29911.76it/s]Loading Data:  35%|███▌      | 6046/17098 [00:00<00:00, 30277.47it/s]Loading Data:  53%|█████▎    | 9100/17098 [00:00<00:00, 30395.85it/s]Loading Data:  71%|███████   | 12155/17098 [00:00<00:00, 30452.44it/s]Loading Data:  89%|████████▉ | 15219/17098 [00:00<00:00, 30518.11it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30442.12it/s]
Loading Data:   0%|          | 0/2849 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2849/2849 [00:00<00:00, 30336.02it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3009/17098 [00:00<00:00, 30087.88it/s]Loading Data:  35%|███▌      | 6057/17098 [00:00<00:00, 30312.85it/s]Loading Data:  53%|█████▎    | 9099/17098 [00:00<00:00, 30358.65it/s]Loading Data:  71%|███████   | 12155/17098 [00:00<00:00, 30437.94it/s]Loading Data:  89%|████████▉ | 15199/17098 [00:00<00:00, 30330.28it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30336.35it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:29,  1.52it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.43it/s]Test-loop:  11%|█         | 5/45 [00:00<00:05,  6.68it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.49it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.97it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 11.11it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 11.87it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 12.62it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 12.98it/s]Test-loop:  42%|████▏     | 19/45 [00:01<00:01, 13.27it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 13.45it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 13.48it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 13.68it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 13.73it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 13.72it/s]Test-loop:  69%|██████▉   | 31/45 [00:02<00:01, 13.84it/s]Test-loop:  73%|███████▎  | 33/45 [00:02<00:00, 13.90it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 13.90it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 13.76it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 13.89it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 13.96it/s]Test-loop:  96%|█████████▌| 43/45 [00:03<00:00, 14.00it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 14.53it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 11.67it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:52,  1.54it/s]Test-loop:   1%|          | 3/268 [00:00<01:00,  4.41it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:38,  6.76it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:29,  8.72it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:25, 10.31it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:22, 11.50it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:20, 12.28it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:19, 12.72it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:19, 13.10it/s]Test-loop:   7%|▋         | 19/268 [00:01<00:18, 13.40it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:18, 13.67it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:17, 13.67it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:17, 13.72it/s]Test-loop:  10%|█         | 27/268 [00:02<00:17, 13.82it/s]Test-loop:  11%|█         | 29/268 [00:02<00:17, 13.78it/s]Test-loop:  12%|█▏        | 31/268 [00:02<00:17, 13.88it/s]Test-loop:  12%|█▏        | 33/268 [00:02<00:16, 13.86it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:16, 13.87it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:16, 13.88it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:16, 13.84it/s]Test-loop:  15%|█▌        | 41/268 [00:03<00:16, 13.84it/s]Test-loop:  16%|█▌        | 43/268 [00:03<00:16, 13.89it/s]Test-loop:  17%|█▋        | 45/268 [00:03<00:15, 14.00it/s]Test-loop:  18%|█▊        | 47/268 [00:03<00:15, 13.98it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:15, 13.98it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:15, 14.21it/s]Test-loop:  20%|█▉        | 53/268 [00:04<00:14, 14.45it/s]Test-loop:  21%|██        | 55/268 [00:04<00:14, 14.65it/s]Test-loop:  21%|██▏       | 57/268 [00:04<00:14, 14.78it/s]Test-loop:  22%|██▏       | 59/268 [00:04<00:14, 14.88it/s]Test-loop:  23%|██▎       | 61/268 [00:04<00:13, 14.95it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:13, 14.89it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:13, 14.60it/s]Test-loop:  25%|██▌       | 67/268 [00:05<00:14, 14.34it/s]Test-loop:  26%|██▌       | 69/268 [00:05<00:13, 14.32it/s]Test-loop:  26%|██▋       | 71/268 [00:05<00:13, 14.15it/s]Test-loop:  27%|██▋       | 73/268 [00:05<00:13, 14.17it/s]Test-loop:  28%|██▊       | 75/268 [00:05<00:13, 14.10it/s]Test-loop:  29%|██▊       | 77/268 [00:06<00:13, 14.22it/s]Test-loop:  29%|██▉       | 79/268 [00:06<00:13, 14.32it/s]Test-loop:  30%|███       | 81/268 [00:06<00:13, 14.29it/s]Test-loop:  31%|███       | 83/268 [00:06<00:13, 14.20it/s]Test-loop:  32%|███▏      | 85/268 [00:06<00:12, 14.18it/s]Test-loop:  32%|███▏      | 87/268 [00:06<00:12, 14.21it/s]Test-loop:  33%|███▎      | 89/268 [00:06<00:12, 14.13it/s]Test-loop:  34%|███▍      | 91/268 [00:07<00:12, 14.21it/s]Test-loop:  35%|███▍      | 93/268 [00:07<00:12, 14.32it/s]Test-loop:  35%|███▌      | 95/268 [00:07<00:12, 14.16it/s]Test-loop:  36%|███▌      | 97/268 [00:07<00:12, 14.07it/s]Test-loop:  37%|███▋      | 99/268 [00:07<00:11, 14.12it/s]Test-loop:  38%|███▊      | 101/268 [00:07<00:11, 14.04it/s]Test-loop:  38%|███▊      | 103/268 [00:07<00:11, 13.99it/s]Test-loop:  39%|███▉      | 105/268 [00:07<00:11, 14.22it/s]Test-loop:  40%|███▉      | 107/268 [00:08<00:11, 14.36it/s]Test-loop:  41%|████      | 109/268 [00:08<00:11, 14.44it/s]Test-loop:  41%|████▏     | 111/268 [00:08<00:10, 14.34it/s]Test-loop:  42%|████▏     | 113/268 [00:08<00:10, 14.19it/s]Test-loop:  43%|████▎     | 115/268 [00:08<00:10, 14.05it/s]Test-loop:  44%|████▎     | 117/268 [00:08<00:10, 14.08it/s]Test-loop:  44%|████▍     | 119/268 [00:08<00:10, 14.01it/s]Test-loop:  45%|████▌     | 121/268 [00:09<00:10, 14.09it/s]Test-loop:  46%|████▌     | 123/268 [00:09<00:10, 14.14it/s]Test-loop:  47%|████▋     | 125/268 [00:09<00:10, 14.25it/s]Test-loop:  47%|████▋     | 127/268 [00:09<00:09, 14.14it/s]Test-loop:  48%|████▊     | 129/268 [00:09<00:09, 14.02it/s]Test-loop:  49%|████▉     | 131/268 [00:09<00:09, 13.91it/s]Test-loop:  50%|████▉     | 133/268 [00:09<00:09, 14.05it/s]Test-loop:  50%|█████     | 135/268 [00:10<00:09, 14.04it/s]Test-loop:  51%|█████     | 137/268 [00:10<00:09, 13.88it/s]Test-loop:  52%|█████▏    | 139/268 [00:10<00:09, 13.90it/s]Test-loop:  53%|█████▎    | 141/268 [00:10<00:09, 13.75it/s]Test-loop:  53%|█████▎    | 143/268 [00:10<00:09, 13.65it/s]Test-loop:  54%|█████▍    | 145/268 [00:10<00:09, 13.54it/s]Test-loop:  55%|█████▍    | 147/268 [00:11<00:08, 13.55it/s]Test-loop:  56%|█████▌    | 149/268 [00:11<00:08, 13.72it/s]Test-loop:  56%|█████▋    | 151/268 [00:11<00:08, 13.74it/s]Test-loop:  57%|█████▋    | 153/268 [00:11<00:08, 13.73it/s]Test-loop:  58%|█████▊    | 155/268 [00:11<00:08, 13.88it/s]Test-loop:  59%|█████▊    | 157/268 [00:11<00:08, 13.78it/s]Test-loop:  59%|█████▉    | 159/268 [00:11<00:07, 13.80it/s]Test-loop:  60%|██████    | 161/268 [00:12<00:07, 13.93it/s]Test-loop:  61%|██████    | 163/268 [00:12<00:07, 13.89it/s]Test-loop:  62%|██████▏   | 165/268 [00:12<00:07, 13.82it/s]Test-loop:  62%|██████▏   | 167/268 [00:12<00:07, 13.71it/s]Test-loop:  63%|██████▎   | 169/268 [00:12<00:07, 13.81it/s]Test-loop:  64%|██████▍   | 171/268 [00:12<00:06, 13.88it/s]Test-loop:  65%|██████▍   | 173/268 [00:12<00:06, 13.85it/s]Test-loop:  65%|██████▌   | 175/268 [00:13<00:06, 13.73it/s]Test-loop:  66%|██████▌   | 177/268 [00:13<00:06, 13.80it/s]Test-loop:  67%|██████▋   | 179/268 [00:13<00:06, 13.84it/s]Test-loop:  68%|██████▊   | 181/268 [00:13<00:06, 13.87it/s]Test-loop:  68%|██████▊   | 183/268 [00:13<00:06, 13.93it/s]Test-loop:  69%|██████▉   | 185/268 [00:13<00:05, 13.97it/s]Test-loop:  70%|██████▉   | 187/268 [00:13<00:05, 13.95it/s]Test-loop:  71%|███████   | 189/268 [00:14<00:05, 13.93it/s]Test-loop:  71%|███████▏  | 191/268 [00:14<00:05, 14.10it/s]Test-loop:  72%|███████▏  | 193/268 [00:14<00:05, 14.02it/s]Test-loop:  73%|███████▎  | 195/268 [00:14<00:05, 13.99it/s]Test-loop:  74%|███████▎  | 197/268 [00:14<00:05, 14.06it/s]Test-loop:  74%|███████▍  | 199/268 [00:14<00:04, 14.22it/s]Test-loop:  75%|███████▌  | 201/268 [00:14<00:04, 14.47it/s]Test-loop:  76%|███████▌  | 203/268 [00:14<00:04, 14.65it/s]Test-loop:  76%|███████▋  | 205/268 [00:15<00:04, 14.53it/s]Test-loop:  77%|███████▋  | 207/268 [00:15<00:04, 14.70it/s]Test-loop:  78%|███████▊  | 209/268 [00:15<00:03, 14.82it/s]Test-loop:  79%|███████▊  | 211/268 [00:15<00:03, 14.90it/s]Test-loop:  79%|███████▉  | 213/268 [00:15<00:03, 14.96it/s]Test-loop:  80%|████████  | 215/268 [00:15<00:03, 15.00it/s]Test-loop:  81%|████████  | 217/268 [00:15<00:03, 15.04it/s]Test-loop:  82%|████████▏ | 219/268 [00:16<00:03, 15.06it/s]Test-loop:  82%|████████▏ | 221/268 [00:16<00:03, 15.07it/s]Test-loop:  83%|████████▎ | 223/268 [00:16<00:02, 15.08it/s]Test-loop:  84%|████████▍ | 225/268 [00:16<00:02, 15.09it/s]Test-loop:  85%|████████▍ | 227/268 [00:16<00:02, 15.09it/s]Test-loop:  85%|████████▌ | 229/268 [00:16<00:02, 15.09it/s]Test-loop:  86%|████████▌ | 231/268 [00:16<00:02, 15.09it/s]Test-loop:  87%|████████▋ | 233/268 [00:16<00:02, 15.08it/s]Test-loop:  88%|████████▊ | 235/268 [00:17<00:02, 15.09it/s]Test-loop:  88%|████████▊ | 237/268 [00:17<00:02, 15.09it/s]Test-loop:  89%|████████▉ | 239/268 [00:17<00:01, 15.09it/s]Test-loop:  90%|████████▉ | 241/268 [00:17<00:01, 15.09it/s]Test-loop:  91%|█████████ | 243/268 [00:17<00:01, 15.10it/s]Test-loop:  91%|█████████▏| 245/268 [00:17<00:01, 15.11it/s]Test-loop:  92%|█████████▏| 247/268 [00:17<00:01, 15.11it/s]Test-loop:  93%|█████████▎| 249/268 [00:18<00:01, 15.10it/s]Test-loop:  94%|█████████▎| 251/268 [00:18<00:01, 15.10it/s]Test-loop:  94%|█████████▍| 253/268 [00:18<00:00, 15.10it/s]Test-loop:  95%|█████████▌| 255/268 [00:18<00:00, 15.10it/s]Test-loop:  96%|█████████▌| 257/268 [00:18<00:00, 15.11it/s]Test-loop:  97%|█████████▋| 259/268 [00:18<00:00, 15.10it/s]Test-loop:  97%|█████████▋| 261/268 [00:18<00:00, 15.11it/s]Test-loop:  98%|█████████▊| 263/268 [00:18<00:00, 15.11it/s]Test-loop:  99%|█████████▉| 265/268 [00:19<00:00, 15.12it/s]Test-loop: 100%|█████████▉| 267/268 [00:19<00:00, 15.16it/s]Test-loop: 100%|██████████| 268/268 [00:19<00:00, 13.86it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:15,  1.37it/s]Test-loop:   1%|          | 3/268 [00:00<01:11,  3.69it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:51,  5.14it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:42,  6.14it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:37,  6.91it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:34,  7.45it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:32,  7.92it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:30,  8.23it/s]Test-loop:   6%|▌         | 16/268 [00:02<00:30,  8.31it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:29,  8.41it/s]Test-loop:   7%|▋         | 18/268 [00:02<00:29,  8.43it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:30,  8.20it/s]Test-loop:   7%|▋         | 20/268 [00:02<00:29,  8.53it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:29,  8.43it/s]Test-loop:   8%|▊         | 22/268 [00:03<00:28,  8.64it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:30,  8.16it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:30,  8.09it/s]Test-loop:  10%|█         | 27/268 [00:03<00:29,  8.16it/s]Test-loop:  11%|█         | 29/268 [00:04<00:28,  8.33it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:27,  8.57it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:27,  8.48it/s]Test-loop:  13%|█▎        | 35/268 [00:04<00:26,  8.69it/s]Test-loop:  14%|█▍        | 37/268 [00:04<00:26,  8.73it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:27,  8.47it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:26,  8.44it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:26,  8.55it/s]Test-loop:  17%|█▋        | 45/268 [00:05<00:26,  8.49it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:25,  8.72it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:24,  8.84it/s]Test-loop:  19%|█▉        | 51/268 [00:06<00:24,  8.75it/s]Test-loop:  20%|█▉        | 53/268 [00:06<00:24,  8.64it/s]Test-loop:  21%|██        | 55/268 [00:07<00:25,  8.36it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:24,  8.51it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:23,  8.74it/s]Test-loop:  23%|██▎       | 61/268 [00:07<00:23,  8.93it/s]Test-loop:  24%|██▎       | 63/268 [00:07<00:22,  9.04it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:22,  9.00it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:22,  8.79it/s]Test-loop:  26%|██▌       | 69/268 [00:08<00:22,  8.79it/s]Test-loop:  26%|██▋       | 71/268 [00:08<00:22,  8.77it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:22,  8.63it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:22,  8.74it/s]Test-loop:  29%|██▊       | 77/268 [00:09<00:22,  8.68it/s]Test-loop:  29%|██▉       | 79/268 [00:09<00:22,  8.51it/s]Test-loop:  30%|███       | 81/268 [00:09<00:21,  8.64it/s]Test-loop:  31%|███       | 83/268 [00:10<00:21,  8.55it/s]Test-loop:  32%|███▏      | 85/268 [00:10<00:20,  8.76it/s]Test-loop:  32%|███▏      | 87/268 [00:10<00:20,  8.64it/s]Test-loop:  33%|███▎      | 89/268 [00:10<00:20,  8.55it/s]Test-loop:  34%|███▍      | 91/268 [00:11<00:20,  8.56it/s]Test-loop:  35%|███▍      | 93/268 [00:11<00:20,  8.68it/s]Test-loop:  35%|███▌      | 95/268 [00:11<00:19,  8.67it/s]Test-loop:  36%|███▌      | 97/268 [00:11<00:20,  8.39it/s]Test-loop:  37%|███▋      | 99/268 [00:12<00:20,  8.39it/s]Test-loop:  38%|███▊      | 101/268 [00:12<00:19,  8.48it/s]Test-loop:  38%|███▊      | 103/268 [00:12<00:19,  8.53it/s]Test-loop:  39%|███▉      | 105/268 [00:12<00:19,  8.42it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:18,  8.58it/s]Test-loop:  41%|████      | 109/268 [00:13<00:18,  8.65it/s]Test-loop:  41%|████▏     | 111/268 [00:13<00:18,  8.49it/s]Test-loop:  42%|████▏     | 113/268 [00:13<00:18,  8.59it/s]Test-loop:  43%|████▎     | 115/268 [00:13<00:17,  8.52it/s]Test-loop:  44%|████▎     | 117/268 [00:14<00:17,  8.46it/s]Test-loop:  44%|████▍     | 119/268 [00:14<00:17,  8.39it/s]Test-loop:  45%|████▌     | 121/268 [00:14<00:17,  8.61it/s]Test-loop:  46%|████▌     | 123/268 [00:14<00:16,  8.78it/s]Test-loop:  47%|████▋     | 125/268 [00:15<00:16,  8.57it/s]Test-loop:  47%|████▋     | 126/268 [00:15<00:16,  8.76it/s]Test-loop:  47%|████▋     | 127/268 [00:15<00:16,  8.38it/s]Test-loop:  48%|████▊     | 129/268 [00:15<00:15,  8.81it/s]Test-loop:  49%|████▊     | 130/268 [00:15<00:15,  9.01it/s]Test-loop:  49%|████▉     | 131/268 [00:15<00:16,  8.52it/s]Test-loop:  50%|████▉     | 133/268 [00:16<00:15,  8.54it/s]Test-loop:  50%|█████     | 135/268 [00:16<00:15,  8.72it/s]Test-loop:  51%|█████     | 137/268 [00:16<00:15,  8.65it/s]Test-loop:  52%|█████▏    | 139/268 [00:16<00:14,  8.72it/s]Test-loop:  53%|█████▎    | 141/268 [00:16<00:14,  8.72it/s]Test-loop:  53%|█████▎    | 143/268 [00:17<00:14,  8.68it/s]Test-loop:  54%|█████▍    | 145/268 [00:17<00:13,  8.83it/s]Test-loop:  55%|█████▍    | 147/268 [00:17<00:13,  8.87it/s]Test-loop:  56%|█████▌    | 149/268 [00:17<00:13,  8.71it/s]Test-loop:  56%|█████▌    | 150/268 [00:17<00:13,  8.91it/s]Test-loop:  56%|█████▋    | 151/268 [00:18<00:13,  8.74it/s]Test-loop:  57%|█████▋    | 152/268 [00:18<00:13,  8.86it/s]Test-loop:  57%|█████▋    | 153/268 [00:18<00:12,  9.09it/s]Test-loop:  57%|█████▋    | 154/268 [00:18<00:12,  8.83it/s]Test-loop:  58%|█████▊    | 156/268 [00:18<00:12,  8.87it/s]Test-loop:  59%|█████▉    | 158/268 [00:18<00:12,  8.77it/s]Test-loop:  60%|█████▉    | 160/268 [00:19<00:12,  8.81it/s]Test-loop:  60%|██████    | 162/268 [00:19<00:12,  8.79it/s]Test-loop:  61%|██████    | 164/268 [00:19<00:12,  8.58it/s]Test-loop:  62%|██████▏   | 166/268 [00:19<00:11,  8.73it/s]Test-loop:  63%|██████▎   | 168/268 [00:20<00:11,  8.77it/s]Test-loop:  63%|██████▎   | 170/268 [00:20<00:11,  8.79it/s]Test-loop:  64%|██████▍   | 172/268 [00:20<00:11,  8.68it/s]Test-loop:  65%|██████▍   | 174/268 [00:20<00:10,  8.94it/s]Test-loop:  65%|██████▌   | 175/268 [00:20<00:10,  9.09it/s]Test-loop:  66%|██████▌   | 176/268 [00:20<00:10,  9.05it/s]Test-loop:  66%|██████▋   | 178/268 [00:21<00:10,  8.61it/s]Test-loop:  67%|██████▋   | 180/268 [00:21<00:09,  8.81it/s]Test-loop:  68%|██████▊   | 182/268 [00:21<00:09,  8.75it/s]Test-loop:  69%|██████▊   | 184/268 [00:21<00:09,  8.82it/s]Test-loop:  69%|██████▉   | 186/268 [00:22<00:09,  8.87it/s]Test-loop:  70%|███████   | 188/268 [00:22<00:09,  8.73it/s]Test-loop:  71%|███████   | 190/268 [00:22<00:08,  8.71it/s]Test-loop:  72%|███████▏  | 192/268 [00:22<00:08,  8.80it/s]Test-loop:  72%|███████▏  | 194/268 [00:22<00:08,  9.00it/s]Test-loop:  73%|███████▎  | 196/268 [00:23<00:08,  8.83it/s]Test-loop:  74%|███████▍  | 198/268 [00:23<00:08,  8.73it/s]Test-loop:  75%|███████▍  | 200/268 [00:23<00:07,  8.75it/s]Test-loop:  75%|███████▌  | 202/268 [00:23<00:07,  8.81it/s]Test-loop:  76%|███████▌  | 204/268 [00:24<00:07,  8.71it/s]Test-loop:  77%|███████▋  | 206/268 [00:24<00:07,  8.77it/s]Test-loop:  78%|███████▊  | 208/268 [00:24<00:06,  8.65it/s]Test-loop:  78%|███████▊  | 210/268 [00:24<00:06,  8.55it/s]Test-loop:  79%|███████▉  | 212/268 [00:25<00:06,  8.68it/s]Test-loop:  80%|███████▉  | 214/268 [00:25<00:06,  8.62it/s]Test-loop:  81%|████████  | 216/268 [00:25<00:05,  8.75it/s]Test-loop:  81%|████████▏ | 218/268 [00:25<00:05,  8.67it/s]Test-loop:  82%|████████▏ | 220/268 [00:25<00:05,  8.84it/s]Test-loop:  83%|████████▎ | 222/268 [00:26<00:05,  8.64it/s]Test-loop:  84%|████████▎ | 224/268 [00:26<00:05,  8.75it/s]Test-loop:  84%|████████▍ | 226/268 [00:26<00:04,  8.87it/s]Test-loop:  85%|████████▌ | 228/268 [00:26<00:04,  8.85it/s]Test-loop:  86%|████████▌ | 230/268 [00:27<00:04,  8.82it/s]Test-loop:  87%|████████▋ | 232/268 [00:27<00:04,  8.72it/s]Test-loop:  87%|████████▋ | 234/268 [00:27<00:03,  8.76it/s]Test-loop:  88%|████████▊ | 236/268 [00:27<00:03,  8.88it/s]Test-loop:  89%|████████▉ | 238/268 [00:28<00:03,  8.85it/s]Test-loop:  90%|████████▉ | 240/268 [00:28<00:03,  8.82it/s]Test-loop:  90%|█████████ | 242/268 [00:28<00:02,  9.00it/s]Test-loop:  91%|█████████ | 244/268 [00:28<00:02,  9.01it/s]Test-loop:  92%|█████████▏| 246/268 [00:28<00:02,  9.03it/s]Test-loop:  93%|█████████▎| 248/268 [00:29<00:02,  8.99it/s]Test-loop:  93%|█████████▎| 250/268 [00:29<00:02,  8.98it/s]Test-loop:  94%|█████████▍| 252/268 [00:29<00:01,  9.08it/s]Test-loop:  95%|█████████▍| 254/268 [00:29<00:01,  9.16it/s]Test-loop:  96%|█████████▌| 256/268 [00:29<00:01,  9.19it/s]Test-loop:  96%|█████████▋| 258/268 [00:30<00:01,  9.07it/s]Test-loop:  97%|█████████▋| 260/268 [00:30<00:00,  8.94it/s]Test-loop:  98%|█████████▊| 262/268 [00:30<00:00,  8.70it/s]Test-loop:  99%|█████████▊| 264/268 [00:30<00:00,  8.56it/s]Test-loop:  99%|█████████▉| 266/268 [00:31<00:00,  8.65it/s]Test-loop: 100%|██████████| 268/268 [00:31<00:00, 10.09it/s]Test-loop: 100%|██████████| 268/268 [00:31<00:00,  8.56it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3038/17098 [00:00<00:00, 30374.38it/s]Loading Data:  36%|███▌      | 6118/17098 [00:00<00:00, 30623.03it/s]Loading Data:  54%|█████▎    | 9181/17098 [00:00<00:00, 30565.90it/s]Loading Data:  72%|███████▏  | 12289/17098 [00:00<00:00, 30764.83it/s]Loading Data:  90%|████████▉ | 15366/17098 [00:00<00:00, 30764.96it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30713.89it/s]
Loading Data:   0%|          | 0/2849 [00:00<?, ?it/s]Loading Data: 100%|██████████| 2849/2849 [00:00<00:00, 30411.99it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:  18%|█▊        | 3051/17098 [00:00<00:00, 30505.74it/s]Loading Data:  36%|███▌      | 6121/17098 [00:00<00:00, 30614.10it/s]Loading Data:  54%|█████▍    | 9196/17098 [00:00<00:00, 30673.45it/s]Loading Data:  72%|███████▏  | 12264/17098 [00:00<00:00, 30655.82it/s]Loading Data:  90%|████████▉ | 15330/17098 [00:00<00:00, 30596.13it/s]Loading Data: 100%|██████████| 17098/17098 [00:00<00:00, 30620.48it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type           | Params
----------------------------------------------
0 | model      | ResNet         | 23.5 M
1 | loss_func  | BCELoss        | 0     
2 | accu_func  | BinaryAccuracy | 0     
3 | auroc_func | BinaryAUROC    | 0     
----------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.040    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:28,  1.55it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.44it/s]Test-loop:  11%|█         | 5/45 [00:00<00:06,  6.54it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.22it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.66it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.78it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 11.59it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 12.21it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 12.75it/s]Test-loop:  42%|████▏     | 19/45 [00:01<00:01, 13.26it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 13.71it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 13.98it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 14.04it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 14.02it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 13.88it/s]Test-loop:  69%|██████▉   | 31/45 [00:02<00:01, 13.88it/s]Test-loop:  73%|███████▎  | 33/45 [00:02<00:00, 13.81it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 13.69it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 13.40it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 13.37it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 13.38it/s]Test-loop:  96%|█████████▌| 43/45 [00:03<00:00, 13.36it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 14.03it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 11.52it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:58,  1.50it/s]Test-loop:   1%|          | 3/268 [00:00<01:02,  4.22it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:40,  6.43it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:31,  8.25it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:26,  9.68it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:23, 10.71it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:22, 11.53it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:21, 12.02it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:20, 12.45it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:19, 12.65it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:19, 12.74it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:19, 12.81it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:18, 13.02it/s]Test-loop:  10%|█         | 27/268 [00:02<00:18, 13.14it/s]Test-loop:  11%|█         | 29/268 [00:02<00:18, 13.04it/s]Test-loop:  12%|█▏        | 31/268 [00:02<00:18, 13.15it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:17, 13.30it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:17, 13.23it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:17, 13.36it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:17, 13.29it/s]Test-loop:  15%|█▌        | 41/268 [00:03<00:17, 13.30it/s]Test-loop:  16%|█▌        | 43/268 [00:03<00:16, 13.44it/s]Test-loop:  17%|█▋        | 45/268 [00:03<00:16, 13.48it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:16, 13.57it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:16, 13.43it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:16, 13.51it/s]Test-loop:  20%|█▉        | 53/268 [00:04<00:15, 13.70it/s]Test-loop:  21%|██        | 55/268 [00:04<00:16, 13.29it/s]Test-loop:  21%|██▏       | 57/268 [00:04<00:15, 13.36it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:15, 13.45it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:15, 13.75it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:14, 13.70it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:14, 13.63it/s]Test-loop:  25%|██▌       | 67/268 [00:05<00:14, 13.60it/s]Test-loop:  26%|██▌       | 69/268 [00:05<00:14, 13.51it/s]Test-loop:  26%|██▋       | 71/268 [00:05<00:14, 13.42it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:14, 13.36it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:14, 13.47it/s]Test-loop:  29%|██▊       | 77/268 [00:06<00:14, 13.53it/s]Test-loop:  29%|██▉       | 79/268 [00:06<00:13, 13.53it/s]Test-loop:  30%|███       | 81/268 [00:06<00:13, 13.38it/s]Test-loop:  31%|███       | 83/268 [00:06<00:13, 13.25it/s]Test-loop:  32%|███▏      | 85/268 [00:06<00:13, 13.14it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:13, 13.16it/s]Test-loop:  33%|███▎      | 89/268 [00:07<00:13, 13.22it/s]Test-loop:  34%|███▍      | 91/268 [00:07<00:13, 13.42it/s]Test-loop:  35%|███▍      | 93/268 [00:07<00:13, 13.30it/s]Test-loop:  35%|███▌      | 95/268 [00:07<00:13, 13.14it/s]Test-loop:  36%|███▌      | 97/268 [00:07<00:13, 12.94it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:13, 12.85it/s]Test-loop:  38%|███▊      | 101/268 [00:08<00:12, 12.97it/s]Test-loop:  38%|███▊      | 103/268 [00:08<00:12, 12.88it/s]Test-loop:  39%|███▉      | 105/268 [00:08<00:12, 12.89it/s]Test-loop:  40%|███▉      | 107/268 [00:08<00:12, 12.91it/s]Test-loop:  41%|████      | 109/268 [00:08<00:12, 12.98it/s]Test-loop:  41%|████▏     | 111/268 [00:08<00:12, 12.95it/s]Test-loop:  42%|████▏     | 113/268 [00:09<00:11, 13.14it/s]Test-loop:  43%|████▎     | 115/268 [00:09<00:11, 13.39it/s]Test-loop:  44%|████▎     | 117/268 [00:09<00:11, 13.69it/s]Test-loop:  44%|████▍     | 119/268 [00:09<00:10, 13.85it/s]Test-loop:  45%|████▌     | 121/268 [00:09<00:10, 13.82it/s]Test-loop:  46%|████▌     | 123/268 [00:09<00:10, 13.23it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:10, 13.16it/s]Test-loop:  47%|████▋     | 127/268 [00:10<00:10, 13.15it/s]Test-loop:  48%|████▊     | 129/268 [00:10<00:10, 13.18it/s]Test-loop:  49%|████▉     | 131/268 [00:10<00:10, 13.27it/s]Test-loop:  50%|████▉     | 133/268 [00:10<00:10, 13.43it/s]Test-loop:  50%|█████     | 135/268 [00:10<00:09, 13.46it/s]Test-loop:  51%|█████     | 137/268 [00:10<00:09, 13.49it/s]Test-loop:  52%|█████▏    | 139/268 [00:11<00:09, 13.43it/s]Test-loop:  53%|█████▎    | 141/268 [00:11<00:09, 13.48it/s]Test-loop:  53%|█████▎    | 143/268 [00:11<00:09, 13.30it/s]Test-loop:  54%|█████▍    | 145/268 [00:11<00:09, 13.16it/s]Test-loop:  55%|█████▍    | 147/268 [00:11<00:09, 13.21it/s]Test-loop:  56%|█████▌    | 149/268 [00:11<00:08, 13.26it/s]Test-loop:  56%|█████▋    | 151/268 [00:11<00:08, 13.34it/s]Test-loop:  57%|█████▋    | 153/268 [00:12<00:08, 13.39it/s]Test-loop:  58%|█████▊    | 155/268 [00:12<00:08, 13.52it/s]Test-loop:  59%|█████▊    | 157/268 [00:12<00:08, 13.46it/s]Test-loop:  59%|█████▉    | 159/268 [00:12<00:08, 13.37it/s]Test-loop:  60%|██████    | 161/268 [00:12<00:08, 13.35it/s]Test-loop:  61%|██████    | 163/268 [00:12<00:07, 13.51it/s]Test-loop:  62%|██████▏   | 165/268 [00:12<00:07, 13.51it/s]Test-loop:  62%|██████▏   | 167/268 [00:13<00:07, 13.39it/s]Test-loop:  63%|██████▎   | 169/268 [00:13<00:07, 13.28it/s]Test-loop:  64%|██████▍   | 171/268 [00:13<00:07, 13.41it/s]Test-loop:  65%|██████▍   | 173/268 [00:13<00:07, 13.35it/s]Test-loop:  65%|██████▌   | 175/268 [00:13<00:06, 13.46it/s]Test-loop:  66%|██████▌   | 177/268 [00:13<00:06, 13.57it/s]Test-loop:  67%|██████▋   | 179/268 [00:14<00:06, 13.53it/s]Test-loop:  68%|██████▊   | 181/268 [00:14<00:06, 13.48it/s]Test-loop:  68%|██████▊   | 183/268 [00:14<00:06, 13.39it/s]Test-loop:  69%|██████▉   | 185/268 [00:14<00:06, 13.33it/s]Test-loop:  70%|██████▉   | 187/268 [00:14<00:06, 13.41it/s]Test-loop:  71%|███████   | 189/268 [00:14<00:05, 13.36it/s]Test-loop:  71%|███████▏  | 191/268 [00:14<00:05, 13.33it/s]Test-loop:  72%|███████▏  | 193/268 [00:15<00:05, 13.34it/s]Test-loop:  73%|███████▎  | 195/268 [00:15<00:05, 13.20it/s]Test-loop:  74%|███████▎  | 197/268 [00:15<00:05, 13.24it/s]Test-loop:  74%|███████▍  | 199/268 [00:15<00:05, 13.22it/s]Test-loop:  75%|███████▌  | 201/268 [00:15<00:05, 13.14it/s]Test-loop:  76%|███████▌  | 203/268 [00:15<00:04, 13.18it/s]Test-loop:  76%|███████▋  | 205/268 [00:15<00:04, 13.27it/s]Test-loop:  77%|███████▋  | 207/268 [00:16<00:04, 13.26it/s]Test-loop:  78%|███████▊  | 209/268 [00:16<00:04, 13.17it/s]Test-loop:  79%|███████▊  | 211/268 [00:16<00:04, 13.12it/s]Test-loop:  79%|███████▉  | 213/268 [00:16<00:04, 13.21it/s]Test-loop:  80%|████████  | 215/268 [00:16<00:04, 12.99it/s]Test-loop:  81%|████████  | 217/268 [00:16<00:03, 13.00it/s]Test-loop:  82%|████████▏ | 219/268 [00:17<00:03, 13.09it/s]Test-loop:  82%|████████▏ | 221/268 [00:17<00:03, 13.10it/s]Test-loop:  83%|████████▎ | 223/268 [00:17<00:03, 13.18it/s]Test-loop:  84%|████████▍ | 225/268 [00:17<00:03, 13.26it/s]Test-loop:  85%|████████▍ | 227/268 [00:17<00:03, 13.12it/s]Test-loop:  85%|████████▌ | 229/268 [00:17<00:02, 13.26it/s]Test-loop:  86%|████████▌ | 231/268 [00:17<00:02, 13.16it/s]Test-loop:  87%|████████▋ | 233/268 [00:18<00:02, 13.27it/s]Test-loop:  88%|████████▊ | 235/268 [00:18<00:02, 13.22it/s]Test-loop:  88%|████████▊ | 237/268 [00:18<00:02, 13.24it/s]Test-loop:  89%|████████▉ | 239/268 [00:18<00:02, 13.26it/s]Test-loop:  90%|████████▉ | 241/268 [00:18<00:02, 13.11it/s]Test-loop:  91%|█████████ | 243/268 [00:18<00:01, 13.17it/s]Test-loop:  91%|█████████▏| 245/268 [00:19<00:01, 13.34it/s]Test-loop:  92%|█████████▏| 247/268 [00:19<00:01, 13.35it/s]Test-loop:  93%|█████████▎| 249/268 [00:19<00:01, 13.34it/s]Test-loop:  94%|█████████▎| 251/268 [00:19<00:01, 13.50it/s]Test-loop:  94%|█████████▍| 253/268 [00:19<00:01, 13.44it/s]Test-loop:  95%|█████████▌| 255/268 [00:19<00:00, 13.29it/s]Test-loop:  96%|█████████▌| 257/268 [00:19<00:00, 13.35it/s]Test-loop:  97%|█████████▋| 259/268 [00:20<00:00, 13.28it/s]Test-loop:  97%|█████████▋| 261/268 [00:20<00:00, 13.32it/s]Test-loop:  98%|█████████▊| 263/268 [00:20<00:00, 13.37it/s]Test-loop:  99%|█████████▉| 265/268 [00:20<00:00, 13.36it/s]Test-loop: 100%|█████████▉| 267/268 [00:20<00:00, 13.32it/s]Test-loop: 100%|██████████| 268/268 [00:20<00:00, 12.90it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:31,  1.26it/s]Test-loop:   1%|          | 3/268 [00:01<01:18,  3.37it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:54,  4.84it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:45,  5.74it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:39,  6.56it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:36,  7.11it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:34,  7.44it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:32,  7.81it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:30,  8.16it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:30,  8.29it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:29,  8.51it/s]