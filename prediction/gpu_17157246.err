Loaded module: cuda/12.0
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:   5%|▍         | 834/17100 [00:00<00:01, 8334.52it/s]Loading Data:  10%|▉         | 1682/17100 [00:00<00:01, 8419.42it/s]Loading Data:  15%|█▍        | 2531/17100 [00:00<00:01, 8447.72it/s]Loading Data:  20%|█▉        | 3380/17100 [00:00<00:01, 8461.41it/s]Loading Data:  25%|██▍       | 4227/17100 [00:00<00:01, 8459.21it/s]Loading Data:  30%|██▉       | 5075/17100 [00:00<00:01, 8464.77it/s]Loading Data:  35%|███▍      | 5926/17100 [00:00<00:01, 8477.78it/s]Loading Data:  40%|███▉      | 6775/17100 [00:00<00:01, 8480.30it/s]Loading Data:  45%|████▍     | 7624/17100 [00:00<00:01, 8477.92it/s]Loading Data:  50%|████▉     | 8472/17100 [00:01<00:01, 8471.31it/s]Loading Data:  55%|█████▍    | 9320/17100 [00:01<00:00, 8458.72it/s]Loading Data:  59%|█████▉    | 10166/17100 [00:01<00:00, 8442.06it/s]Loading Data:  64%|██████▍   | 11011/17100 [00:01<00:00, 8439.58it/s]Loading Data:  69%|██████▉   | 11855/17100 [00:01<00:00, 8438.03it/s]Loading Data:  74%|███████▍  | 12699/17100 [00:01<00:00, 8438.37it/s]Loading Data:  79%|███████▉  | 13545/17100 [00:01<00:00, 8443.73it/s]Loading Data:  84%|████████▍ | 14390/17100 [00:01<00:00, 8435.90it/s]Loading Data:  89%|████████▉ | 15236/17100 [00:01<00:00, 8441.13it/s]Loading Data:  94%|█████████▍| 16081/17100 [00:01<00:00, 8428.75it/s]Loading Data:  99%|█████████▉| 16924/17100 [00:02<00:00, 8414.19it/s]Loading Data: 100%|██████████| 17100/17100 [00:02<00:00, 8439.77it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data:  29%|██▉       | 838/2850 [00:00<00:00, 8371.29it/s]Loading Data:  59%|█████▉    | 1677/2850 [00:00<00:00, 8381.55it/s]Loading Data:  88%|████████▊ | 2517/2850 [00:00<00:00, 8387.45it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 8385.88it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:   5%|▍         | 839/17098 [00:00<00:01, 8380.40it/s]Loading Data:  10%|▉         | 1683/17098 [00:00<00:01, 8413.87it/s]Loading Data:  15%|█▍        | 2525/17098 [00:00<00:01, 8416.37it/s]Loading Data:  20%|█▉        | 3368/17098 [00:00<00:01, 8413.18it/s]Loading Data:  25%|██▍       | 4210/17098 [00:00<00:01, 8404.70it/s]Loading Data:  30%|██▉       | 5053/17098 [00:00<00:01, 8412.59it/s]Loading Data:  34%|███▍      | 5898/17098 [00:00<00:01, 8421.95it/s]Loading Data:  39%|███▉      | 6741/17098 [00:00<00:01, 8400.88it/s]Loading Data:  44%|████▍     | 7583/17098 [00:00<00:01, 8405.53it/s]Loading Data:  49%|████▉     | 8424/17098 [00:01<00:01, 8400.13it/s]Loading Data:  54%|█████▍    | 9267/17098 [00:01<00:00, 8407.96it/s]Loading Data:  59%|█████▉    | 10112/17098 [00:01<00:00, 8418.48it/s]Loading Data:  64%|██████▍   | 10954/17098 [00:01<00:00, 8415.00it/s]Loading Data:  69%|██████▉   | 11796/17098 [00:01<00:00, 8416.16it/s]Loading Data:  74%|███████▍  | 12640/17098 [00:01<00:00, 8423.19it/s]Loading Data:  79%|███████▉  | 13485/17098 [00:01<00:00, 8428.33it/s]Loading Data:  84%|████████▍ | 14328/17098 [00:01<00:00, 8427.41it/s]Loading Data:  89%|████████▊ | 15171/17098 [00:01<00:00, 8415.67it/s]Loading Data:  94%|█████████▎| 16014/17098 [00:01<00:00, 8419.22it/s]Loading Data:  99%|█████████▊| 16858/17098 [00:02<00:00, 8425.11it/s]Loading Data: 100%|██████████| 17098/17098 [00:02<00:00, 8415.83it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type               | Params
--------------------------------------------------
0 | model      | ResNet             | 23.5 M
1 | loss_func  | BCELoss            | 0     
2 | accu_func  | MultilabelAccuracy | 0     
3 | auroc_func | MultilabelAUROC    | 0     
--------------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.130    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:17,  2.46it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:07,  5.97it/s]Test-loop:  11%|█         | 5/45 [00:00<00:04,  8.12it/s]Test-loop:  16%|█▌        | 7/45 [00:00<00:03,  9.78it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03, 11.09it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:02, 11.84it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 12.22it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 12.51it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 13.17it/s]Test-loop:  42%|████▏     | 19/45 [00:01<00:01, 13.66it/s]Test-loop:  47%|████▋     | 21/45 [00:01<00:01, 14.11it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 14.44it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 14.31it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 13.95it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 13.77it/s]Test-loop:  69%|██████▉   | 31/45 [00:02<00:01, 13.89it/s]Test-loop:  73%|███████▎  | 33/45 [00:02<00:00, 13.84it/s]Test-loop:  78%|███████▊  | 35/45 [00:02<00:00, 13.66it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 13.47it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 13.28it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 13.45it/s]Test-loop:  96%|█████████▌| 43/45 [00:03<00:00, 13.47it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 14.16it/s]Test-loop: 100%|██████████| 45/45 [00:03<00:00, 12.30it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<01:56,  2.28it/s]Test-loop:   1%|          | 3/268 [00:00<00:47,  5.54it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:35,  7.45it/s]Test-loop:   3%|▎         | 7/268 [00:00<00:30,  8.58it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:27,  9.50it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:24, 10.32it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:23, 10.69it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:23, 10.98it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:22, 11.10it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:21, 11.32it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:21, 11.58it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:20, 11.69it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:20, 11.63it/s]Test-loop:  10%|█         | 27/268 [00:02<00:20, 11.70it/s]Test-loop:  11%|█         | 29/268 [00:02<00:20, 11.71it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:20, 11.74it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:20, 11.64it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:19, 11.72it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:19, 11.81it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:19, 11.90it/s]Test-loop:  15%|█▌        | 41/268 [00:03<00:18, 11.96it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:18, 11.93it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:18, 11.91it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:18, 11.70it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:18, 11.83it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:18, 11.90it/s]Test-loop:  20%|█▉        | 53/268 [00:04<00:17, 11.96it/s]Test-loop:  21%|██        | 55/268 [00:05<00:17, 11.89it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:17, 11.95it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:17, 12.14it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:16, 12.28it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:16, 12.35it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:16, 12.26it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:16, 12.13it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:16, 12.07it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:16, 12.06it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:16, 11.94it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:16, 11.95it/s]Test-loop:  29%|██▊       | 77/268 [00:06<00:15, 12.01it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:15, 11.86it/s]Test-loop:  30%|███       | 81/268 [00:07<00:15, 11.86it/s]Test-loop:  31%|███       | 83/268 [00:07<00:15, 11.98it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:15, 12.03it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:15, 12.01it/s]Test-loop:  33%|███▎      | 89/268 [00:07<00:15, 11.82it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:14, 11.88it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:14, 11.70it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:14, 11.83it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:14, 11.93it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:14, 11.91it/s]Test-loop:  38%|███▊      | 101/268 [00:08<00:14, 11.80it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:13, 11.94it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:13, 12.05it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:13, 12.20it/s]Test-loop:  41%|████      | 109/268 [00:09<00:12, 12.59it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:12, 12.90it/s]Test-loop:  42%|████▏     | 113/268 [00:09<00:11, 13.10it/s]Test-loop:  43%|████▎     | 115/268 [00:09<00:12, 12.71it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 12.48it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 12.24it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:12, 12.00it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:12, 11.80it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:12, 11.78it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 11.94it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 11.89it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 12.10it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:11, 12.20it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:10, 12.15it/s]Test-loop:  51%|█████     | 137/268 [00:11<00:11, 11.86it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:10, 11.79it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:11, 11.47it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:11, 11.18it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:11, 11.10it/s]Test-loop:  55%|█████▍    | 147/268 [00:12<00:10, 11.37it/s]Test-loop:  56%|█████▌    | 149/268 [00:12<00:10, 11.17it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:10, 11.29it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 11.59it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 11.92it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:09, 12.04it/s]Test-loop:  59%|█████▉    | 159/268 [00:13<00:08, 12.13it/s]Test-loop:  60%|██████    | 161/268 [00:13<00:08, 11.99it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:08, 11.95it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 12.02it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 11.88it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:08, 11.92it/s]Test-loop:  64%|██████▍   | 171/268 [00:14<00:08, 11.89it/s]Test-loop:  65%|██████▍   | 173/268 [00:14<00:07, 11.96it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:07, 11.97it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 11.86it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 11.84it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:07, 11.99it/s]Test-loop:  68%|██████▊   | 183/268 [00:15<00:07, 12.05it/s]Test-loop:  69%|██████▉   | 185/268 [00:15<00:06, 12.00it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 12.03it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 11.93it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 11.84it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:06, 11.79it/s]Test-loop:  73%|███████▎  | 195/268 [00:16<00:06, 11.82it/s]Test-loop:  74%|███████▎  | 197/268 [00:16<00:06, 11.67it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:05, 11.66it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 11.85it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 11.90it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 12.31it/s]Test-loop:  77%|███████▋  | 207/268 [00:17<00:04, 12.44it/s]Test-loop:  78%|███████▊  | 209/268 [00:17<00:04, 12.28it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 12.25it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 12.14it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 11.90it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:04, 11.64it/s]Test-loop:  82%|████████▏ | 219/268 [00:18<00:04, 11.66it/s]Test-loop:  82%|████████▏ | 221/268 [00:18<00:04, 11.69it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 11.62it/s]Test-loop:  84%|████████▍ | 225/268 [00:19<00:03, 11.67it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 11.68it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:03, 11.76it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:03, 11.83it/s]Test-loop:  87%|████████▋ | 233/268 [00:19<00:02, 11.82it/s]Test-loop:  88%|████████▊ | 235/268 [00:20<00:02, 11.91it/s]Test-loop:  88%|████████▊ | 237/268 [00:20<00:02, 11.88it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 11.72it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:02, 11.63it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:02, 11.60it/s]Test-loop:  91%|█████████▏| 245/268 [00:20<00:01, 11.61it/s]Test-loop:  92%|█████████▏| 247/268 [00:21<00:01, 11.95it/s]Test-loop:  93%|█████████▎| 249/268 [00:21<00:01, 12.37it/s]Test-loop:  94%|█████████▎| 251/268 [00:21<00:01, 12.81it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 13.03it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:01, 12.82it/s]Test-loop:  96%|█████████▌| 257/268 [00:21<00:00, 12.78it/s]Test-loop:  97%|█████████▋| 259/268 [00:22<00:00, 12.57it/s]Test-loop:  97%|█████████▋| 261/268 [00:22<00:00, 12.33it/s]Test-loop:  98%|█████████▊| 263/268 [00:22<00:00, 12.17it/s]Test-loop:  99%|█████████▉| 265/268 [00:22<00:00, 12.04it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 12.10it/s]Test-loop: 100%|██████████| 268/268 [00:22<00:00, 11.73it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:15,  1.97it/s]Test-loop:   1%|          | 3/268 [00:00<00:58,  4.51it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:44,  5.89it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:39,  6.69it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:36,  7.12it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:35,  7.32it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:33,  7.57it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:32,  7.67it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:31,  7.86it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:31,  8.00it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:30,  8.12it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:29,  8.17it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:29,  8.35it/s]Test-loop:  10%|█         | 27/268 [00:03<00:28,  8.52it/s]Test-loop:  11%|█         | 29/268 [00:03<00:27,  8.56it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:27,  8.53it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:27,  8.49it/s]Test-loop:  13%|█▎        | 35/268 [00:04<00:27,  8.45it/s]Test-loop:  14%|█▍        | 37/268 [00:04<00:26,  8.62it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:26,  8.62it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:26,  8.58it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:26,  8.55it/s]Test-loop:  17%|█▋        | 45/268 [00:05<00:25,  8.72it/s]Test-loop:  18%|█▊        | 47/268 [00:05<00:25,  8.65it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:26,  8.41it/s]Test-loop:  19%|█▉        | 51/268 [00:06<00:25,  8.53it/s]Test-loop:  20%|█▉        | 53/268 [00:06<00:25,  8.28it/s]Test-loop:  21%|██        | 55/268 [00:06<00:25,  8.51it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:24,  8.59it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:24,  8.50it/s]Test-loop:  23%|██▎       | 61/268 [00:07<00:24,  8.56it/s]Test-loop:  24%|██▎       | 63/268 [00:07<00:24,  8.49it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:23,  8.54it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:23,  8.51it/s]Test-loop:  26%|██▌       | 69/268 [00:08<00:23,  8.64it/s]Test-loop:  26%|██▋       | 71/268 [00:08<00:22,  8.73it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:22,  8.70it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:22,  8.63it/s]Test-loop:  29%|██▊       | 77/268 [00:09<00:22,  8.46it/s]Test-loop:  29%|██▉       | 79/268 [00:09<00:21,  8.60it/s]Test-loop:  30%|███       | 81/268 [00:09<00:21,  8.81it/s]Test-loop:  31%|███       | 83/268 [00:10<00:21,  8.81it/s]Test-loop:  32%|███▏      | 85/268 [00:10<00:20,  8.72it/s]Test-loop:  32%|███▏      | 87/268 [00:10<00:21,  8.58it/s]Test-loop:  33%|███▎      | 89/268 [00:10<00:21,  8.39it/s]Test-loop:  34%|███▍      | 91/268 [00:11<00:21,  8.30it/s]Test-loop:  35%|███▍      | 93/268 [00:11<00:20,  8.34it/s]Test-loop:  35%|███▌      | 95/268 [00:11<00:20,  8.49it/s]Test-loop:  36%|███▌      | 97/268 [00:11<00:20,  8.41it/s]Test-loop:  37%|███▋      | 99/268 [00:12<00:20,  8.39it/s]Test-loop:  38%|███▊      | 101/268 [00:12<00:19,  8.48it/s]Test-loop:  38%|███▊      | 103/268 [00:12<00:19,  8.45it/s]Test-loop:  39%|███▉      | 105/268 [00:12<00:19,  8.43it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:18,  8.56it/s]Test-loop:  41%|████      | 109/268 [00:13<00:18,  8.62it/s]Test-loop:  41%|████▏     | 111/268 [00:13<00:18,  8.56it/s]Test-loop:  42%|████▏     | 113/268 [00:13<00:18,  8.56it/s]Test-loop:  43%|████▎     | 115/268 [00:13<00:17,  8.77it/s]Test-loop:  44%|████▎     | 117/268 [00:14<00:17,  8.61it/s]Test-loop:  44%|████▍     | 119/268 [00:14<00:17,  8.40it/s]Test-loop:  45%|████▌     | 121/268 [00:14<00:17,  8.45it/s]Test-loop:  46%|████▌     | 123/268 [00:14<00:16,  8.72it/s]Test-loop:  47%|████▋     | 125/268 [00:15<00:16,  8.63it/s]Test-loop:  47%|████▋     | 127/268 [00:15<00:16,  8.55it/s]Test-loop:  48%|████▊     | 129/268 [00:15<00:16,  8.54it/s]Test-loop:  49%|████▉     | 131/268 [00:15<00:15,  8.63it/s]Test-loop:  50%|████▉     | 133/268 [00:16<00:15,  8.56it/s]Test-loop:  50%|█████     | 135/268 [00:16<00:15,  8.40it/s]Test-loop:  51%|█████     | 137/268 [00:16<00:15,  8.34it/s]Test-loop:  52%|█████▏    | 139/268 [00:16<00:15,  8.29it/s]Test-loop:  53%|█████▎    | 141/268 [00:17<00:15,  8.30it/s]Test-loop:  53%|█████▎    | 143/268 [00:17<00:14,  8.34it/s]Test-loop:  54%|█████▍    | 145/268 [00:17<00:14,  8.58it/s]Test-loop:  55%|█████▍    | 147/268 [00:17<00:14,  8.64it/s]Test-loop:  56%|█████▌    | 149/268 [00:17<00:13,  8.60it/s]Test-loop:  56%|█████▋    | 151/268 [00:18<00:13,  8.52it/s]Test-loop:  57%|█████▋    | 153/268 [00:18<00:13,  8.62it/s]Test-loop:  58%|█████▊    | 155/268 [00:18<00:12,  8.70it/s]Test-loop:  59%|█████▊    | 157/268 [00:18<00:12,  8.80it/s]Test-loop:  59%|█████▉    | 159/268 [00:19<00:12,  8.93it/s]Test-loop:  60%|██████    | 161/268 [00:19<00:12,  8.78it/s]Test-loop:  61%|██████    | 163/268 [00:19<00:12,  8.66it/s]Test-loop:  62%|██████▏   | 165/268 [00:19<00:12,  8.41it/s]Test-loop:  62%|██████▏   | 167/268 [00:20<00:12,  8.41it/s]Test-loop:  63%|██████▎   | 169/268 [00:20<00:12,  8.21it/s]Test-loop:  64%|██████▍   | 171/268 [00:20<00:11,  8.17it/s]Test-loop:  65%|██████▍   | 173/268 [00:20<00:11,  8.27it/s]Test-loop:  65%|██████▌   | 175/268 [00:21<00:11,  8.26it/s]Test-loop:  66%|██████▌   | 177/268 [00:21<00:10,  8.30it/s]Test-loop:  67%|██████▋   | 179/268 [00:21<00:10,  8.22it/s]Test-loop:  68%|██████▊   | 181/268 [00:21<00:10,  8.57it/s]Test-loop:  68%|██████▊   | 183/268 [00:21<00:09,  8.61it/s]Test-loop:  69%|██████▉   | 185/268 [00:22<00:09,  8.64it/s]Test-loop:  70%|██████▉   | 187/268 [00:22<00:09,  8.77it/s]Test-loop:  71%|███████   | 189/268 [00:22<00:09,  8.77it/s]Test-loop:  71%|███████▏  | 191/268 [00:22<00:08,  8.77it/s]Test-loop:  72%|███████▏  | 193/268 [00:23<00:08,  8.76it/s]Test-loop:  73%|███████▎  | 195/268 [00:23<00:08,  8.61it/s]Test-loop:  74%|███████▎  | 197/268 [00:23<00:08,  8.43it/s]Test-loop:  74%|███████▍  | 199/268 [00:23<00:08,  8.49it/s]Test-loop:  75%|███████▌  | 201/268 [00:24<00:07,  8.62it/s]Test-loop:  76%|███████▌  | 203/268 [00:24<00:07,  8.61it/s]Test-loop:  76%|███████▋  | 205/268 [00:24<00:07,  8.70it/s]Test-loop:  77%|███████▋  | 207/268 [00:24<00:06,  8.84it/s]Test-loop:  78%|███████▊  | 209/268 [00:24<00:06,  8.93it/s]Test-loop:  79%|███████▊  | 211/268 [00:25<00:06,  8.73it/s]Test-loop:  79%|███████▉  | 213/268 [00:25<00:06,  8.91it/s]Test-loop:  80%|████████  | 215/268 [00:25<00:06,  8.69it/s]Test-loop:  81%|████████  | 217/268 [00:25<00:05,  8.70it/s]Test-loop:  82%|████████▏ | 219/268 [00:26<00:05,  8.71it/s]Test-loop:  82%|████████▏ | 221/268 [00:26<00:05,  8.53it/s]Test-loop:  83%|████████▎ | 223/268 [00:26<00:05,  8.45it/s]Test-loop:  84%|████████▍ | 225/268 [00:26<00:05,  8.42it/s]Test-loop:  85%|████████▍ | 227/268 [00:27<00:04,  8.56it/s]Test-loop:  85%|████████▌ | 229/268 [00:27<00:04,  8.78it/s]Test-loop:  86%|████████▌ | 231/268 [00:27<00:04,  8.77it/s]Test-loop:  87%|████████▋ | 233/268 [00:27<00:04,  8.57it/s]Test-loop:  88%|████████▊ | 235/268 [00:27<00:03,  8.56it/s]Test-loop:  88%|████████▊ | 237/268 [00:28<00:03,  8.61it/s]Test-loop:  89%|████████▉ | 239/268 [00:28<00:03,  8.71it/s]Test-loop:  90%|████████▉ | 241/268 [00:28<00:03,  8.94it/s]Test-loop:  91%|█████████ | 243/268 [00:28<00:02,  8.98it/s]Test-loop:  91%|█████████▏| 245/268 [00:29<00:02,  9.03it/s]Test-loop:  92%|█████████▏| 247/268 [00:29<00:02,  8.98it/s]Test-loop:  93%|█████████▎| 249/268 [00:29<00:02,  8.97it/s]Test-loop:  94%|█████████▎| 251/268 [00:29<00:01,  8.90it/s]Test-loop:  94%|█████████▍| 253/268 [00:29<00:01,  8.89it/s]Test-loop:  95%|█████████▌| 255/268 [00:30<00:01,  8.70it/s]Test-loop:  96%|█████████▌| 257/268 [00:30<00:01,  8.84it/s]Test-loop:  97%|█████████▋| 259/268 [00:30<00:01,  8.94it/s]Test-loop:  97%|█████████▋| 261/268 [00:30<00:00,  8.92it/s]Test-loop:  98%|█████████▊| 263/268 [00:31<00:00,  9.01it/s]Test-loop:  99%|█████████▉| 265/268 [00:31<00:00,  8.91it/s]Test-loop: 100%|█████████▉| 267/268 [00:31<00:00,  8.85it/s]Test-loop: 100%|██████████| 268/268 [00:31<00:00,  8.47it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:   5%|▍         | 827/17100 [00:00<00:01, 8262.29it/s]Loading Data:  10%|▉         | 1661/17100 [00:00<00:01, 8305.02it/s]Loading Data:  15%|█▍        | 2497/17100 [00:00<00:01, 8327.95it/s]Loading Data:  19%|█▉        | 3331/17100 [00:00<00:01, 8329.80it/s]Loading Data:  24%|██▍       | 4168/17100 [00:00<00:01, 8340.87it/s]Loading Data:  29%|██▉       | 5004/17100 [00:00<00:01, 8344.74it/s]Loading Data:  34%|███▍      | 5839/17100 [00:00<00:01, 8340.73it/s]Loading Data:  39%|███▉      | 6674/17100 [00:00<00:01, 8336.83it/s]Loading Data:  44%|████▍     | 7509/17100 [00:00<00:01, 8338.70it/s]Loading Data:  49%|████▉     | 8343/17100 [00:01<00:01, 8337.12it/s]Loading Data:  54%|█████▎    | 9177/17100 [00:01<00:00, 8313.30it/s]Loading Data:  59%|█████▊    | 10012/17100 [00:01<00:00, 8322.50it/s]Loading Data:  63%|██████▎   | 10849/17100 [00:01<00:00, 8335.90it/s]Loading Data:  68%|██████▊   | 11683/17100 [00:01<00:00, 8331.98it/s]Loading Data:  73%|███████▎  | 12517/17100 [00:01<00:00, 8324.56it/s]Loading Data:  78%|███████▊  | 13350/17100 [00:01<00:00, 8320.48it/s]Loading Data:  83%|████████▎ | 14186/17100 [00:01<00:00, 8332.00it/s]Loading Data:  88%|████████▊ | 15020/17100 [00:01<00:00, 8329.31it/s]Loading Data:  93%|█████████▎| 15853/17100 [00:01<00:00, 8329.25it/s]Loading Data:  98%|█████████▊| 16690/17100 [00:02<00:00, 8339.27it/s]Loading Data: 100%|██████████| 17100/17100 [00:02<00:00, 8329.51it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data:  29%|██▉       | 832/2850 [00:00<00:00, 8312.06it/s]Loading Data:  58%|█████▊    | 1664/2850 [00:00<00:00, 8302.17it/s]Loading Data:  88%|████████▊ | 2499/2850 [00:00<00:00, 8321.46it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 8316.35it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:   5%|▍         | 829/17098 [00:00<00:01, 8280.65it/s]Loading Data:  10%|▉         | 1664/17098 [00:00<00:01, 8318.06it/s]Loading Data:  15%|█▍        | 2502/17098 [00:00<00:01, 8343.60it/s]Loading Data:  20%|█▉        | 3337/17098 [00:00<00:01, 8340.89it/s]Loading Data:  24%|██▍       | 4174/17098 [00:00<00:01, 8350.17it/s]Loading Data:  29%|██▉       | 5012/17098 [00:00<00:01, 8357.00it/s]Loading Data:  34%|███▍      | 5848/17098 [00:00<00:01, 8351.08it/s]Loading Data:  39%|███▉      | 6684/17098 [00:00<00:01, 8332.95it/s]Loading Data:  44%|████▍     | 7522/17098 [00:00<00:01, 8346.00it/s]Loading Data:  49%|████▉     | 8361/17098 [00:01<00:01, 8356.87it/s]Loading Data:  54%|█████▍    | 9198/17098 [00:01<00:00, 8358.48it/s]Loading Data:  59%|█████▊    | 10034/17098 [00:01<00:00, 8355.29it/s]Loading Data:  64%|██████▎   | 10870/17098 [00:01<00:00, 8351.86it/s]Loading Data:  68%|██████▊   | 11706/17098 [00:01<00:00, 8346.34it/s]Loading Data:  73%|███████▎  | 12541/17098 [00:01<00:00, 8346.53it/s]Loading Data:  78%|███████▊  | 13380/17098 [00:01<00:00, 8359.23it/s]Loading Data:  83%|████████▎ | 14218/17098 [00:01<00:00, 8363.60it/s]Loading Data:  88%|████████▊ | 15055/17098 [00:01<00:00, 8353.69it/s]Loading Data:  93%|█████████▎| 15893/17098 [00:01<00:00, 8359.14it/s]Loading Data:  98%|█████████▊| 16735/17098 [00:02<00:00, 8376.46it/s]Loading Data: 100%|██████████| 17098/17098 [00:02<00:00, 8353.14it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type               | Params
--------------------------------------------------
0 | model      | ResNet             | 23.5 M
1 | loss_func  | BCELoss            | 0     
2 | accu_func  | MultilabelAccuracy | 0     
3 | auroc_func | MultilabelAUROC    | 0     
--------------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.130    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:23,  1.89it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:08,  5.05it/s]Test-loop:  11%|█         | 5/45 [00:00<00:05,  7.10it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.52it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.54it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.11it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:03, 10.54it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 10.93it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 11.21it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.45it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:02, 11.56it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 12.12it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.68it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 13.19it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 13.49it/s]Test-loop:  69%|██████▉   | 31/45 [00:02<00:01, 13.06it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.88it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.81it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 12.61it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.39it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.34it/s]Test-loop:  96%|█████████▌| 43/45 [00:03<00:00, 12.26it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 13.18it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.93it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:30,  1.77it/s]Test-loop:   1%|          | 3/268 [00:00<00:55,  4.74it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:39,  6.63it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:32,  7.97it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:29,  8.91it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:26,  9.70it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:24, 10.26it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:23, 10.66it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:22, 10.95it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:22, 11.22it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:21, 11.23it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:21, 11.34it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:21, 11.41it/s]Test-loop:  10%|█         | 27/268 [00:02<00:21, 11.36it/s]Test-loop:  11%|█         | 29/268 [00:03<00:21, 11.32it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:20, 11.35it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:20, 11.28it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:20, 11.33it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:20, 11.38it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:20, 11.40it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:20, 11.28it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:20, 11.12it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:19, 11.26it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:19, 11.37it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:19, 11.26it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:19, 11.25it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:18, 11.34it/s]Test-loop:  21%|██        | 55/268 [00:05<00:19, 11.21it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:18, 11.19it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:18, 11.33it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:18, 11.15it/s]Test-loop:  24%|██▎       | 63/268 [00:06<00:18, 11.22it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:18, 11.26it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:17, 11.27it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:17, 11.30it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:17, 11.40it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:17, 11.36it/s]Test-loop:  28%|██▊       | 75/268 [00:07<00:16, 11.36it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:16, 11.29it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:16, 11.40it/s]Test-loop:  30%|███       | 81/268 [00:07<00:16, 11.43it/s]Test-loop:  31%|███       | 83/268 [00:07<00:16, 11.30it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:16, 11.15it/s]Test-loop:  32%|███▏      | 87/268 [00:08<00:16, 11.15it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:16, 11.07it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:15, 11.14it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:15, 11.10it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:15, 11.18it/s]Test-loop:  36%|███▌      | 97/268 [00:09<00:15, 11.32it/s]Test-loop:  37%|███▋      | 99/268 [00:09<00:15, 11.19it/s]Test-loop:  38%|███▊      | 101/268 [00:09<00:14, 11.21it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:14, 11.26it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:14, 11.27it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:14, 11.48it/s]Test-loop:  41%|████      | 109/268 [00:10<00:13, 11.73it/s]Test-loop:  41%|████▏     | 111/268 [00:10<00:12, 12.12it/s]Test-loop:  42%|████▏     | 113/268 [00:10<00:12, 12.47it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:12, 12.37it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 12.01it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 11.90it/s]Test-loop:  45%|████▌     | 121/268 [00:11<00:12, 11.79it/s]Test-loop:  46%|████▌     | 123/268 [00:11<00:12, 11.68it/s]Test-loop:  47%|████▋     | 125/268 [00:11<00:12, 11.85it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 11.87it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 11.79it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 11.72it/s]Test-loop:  50%|████▉     | 133/268 [00:12<00:11, 11.79it/s]Test-loop:  50%|█████     | 135/268 [00:12<00:11, 11.91it/s]Test-loop:  51%|█████     | 137/268 [00:12<00:11, 11.82it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:10, 11.73it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:10, 11.70it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:10, 11.60it/s]Test-loop:  54%|█████▍    | 145/268 [00:13<00:10, 11.62it/s]Test-loop:  55%|█████▍    | 147/268 [00:13<00:10, 11.67it/s]Test-loop:  56%|█████▌    | 149/268 [00:13<00:10, 11.82it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:09, 11.83it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 11.83it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 11.96it/s]Test-loop:  59%|█████▊    | 157/268 [00:14<00:09, 11.82it/s]Test-loop:  59%|█████▉    | 159/268 [00:14<00:09, 11.65it/s]Test-loop:  60%|██████    | 161/268 [00:14<00:09, 11.59it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:08, 11.70it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 11.68it/s]Test-loop:  62%|██████▏   | 167/268 [00:15<00:08, 11.74it/s]Test-loop:  63%|██████▎   | 169/268 [00:15<00:08, 11.60it/s]Test-loop:  64%|██████▍   | 171/268 [00:15<00:08, 11.51it/s]Test-loop:  65%|██████▍   | 173/268 [00:15<00:08, 11.59it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:08, 11.56it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 11.69it/s]Test-loop:  67%|██████▋   | 179/268 [00:16<00:07, 11.93it/s]Test-loop:  68%|██████▊   | 181/268 [00:16<00:07, 12.02it/s]Test-loop:  68%|██████▊   | 183/268 [00:16<00:07, 11.95it/s]Test-loop:  69%|██████▉   | 185/268 [00:16<00:06, 11.95it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 11.92it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 11.89it/s]Test-loop:  71%|███████▏  | 191/268 [00:17<00:06, 11.90it/s]Test-loop:  72%|███████▏  | 193/268 [00:17<00:06, 11.86it/s]Test-loop:  73%|███████▎  | 195/268 [00:17<00:06, 11.79it/s]Test-loop:  74%|███████▎  | 197/268 [00:17<00:05, 11.98it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:05, 11.85it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 11.90it/s]Test-loop:  76%|███████▌  | 203/268 [00:18<00:05, 11.79it/s]Test-loop:  76%|███████▋  | 205/268 [00:18<00:05, 11.73it/s]Test-loop:  77%|███████▋  | 207/268 [00:18<00:05, 11.75it/s]Test-loop:  78%|███████▊  | 209/268 [00:18<00:05, 11.76it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 11.80it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 11.80it/s]Test-loop:  80%|████████  | 215/268 [00:19<00:04, 11.82it/s]Test-loop:  81%|████████  | 217/268 [00:19<00:04, 11.75it/s]Test-loop:  82%|████████▏ | 219/268 [00:19<00:04, 11.77it/s]Test-loop:  82%|████████▏ | 221/268 [00:19<00:04, 11.68it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 11.51it/s]Test-loop:  84%|████████▍ | 225/268 [00:19<00:03, 11.63it/s]Test-loop:  85%|████████▍ | 227/268 [00:20<00:03, 11.69it/s]Test-loop:  85%|████████▌ | 229/268 [00:20<00:03, 11.69it/s]Test-loop:  86%|████████▌ | 231/268 [00:20<00:03, 11.74it/s]Test-loop:  87%|████████▋ | 233/268 [00:20<00:02, 11.77it/s]Test-loop:  88%|████████▊ | 235/268 [00:20<00:02, 11.80it/s]Test-loop:  88%|████████▊ | 237/268 [00:20<00:02, 11.84it/s]Test-loop:  89%|████████▉ | 239/268 [00:21<00:02, 11.89it/s]Test-loop:  90%|████████▉ | 241/268 [00:21<00:02, 11.75it/s]Test-loop:  91%|█████████ | 243/268 [00:21<00:02, 11.65it/s]Test-loop:  91%|█████████▏| 245/268 [00:21<00:01, 11.74it/s]Test-loop:  92%|█████████▏| 247/268 [00:21<00:01, 11.82it/s]Test-loop:  93%|█████████▎| 249/268 [00:21<00:01, 12.25it/s]Test-loop:  94%|█████████▎| 251/268 [00:22<00:01, 12.70it/s]Test-loop:  94%|█████████▍| 253/268 [00:22<00:01, 13.08it/s]Test-loop:  95%|█████████▌| 255/268 [00:22<00:00, 13.05it/s]Test-loop:  96%|█████████▌| 257/268 [00:22<00:00, 12.93it/s]Test-loop:  97%|█████████▋| 259/268 [00:22<00:00, 12.77it/s]Test-loop:  97%|█████████▋| 261/268 [00:22<00:00, 12.77it/s]Test-loop:  98%|█████████▊| 263/268 [00:23<00:00, 12.60it/s]Test-loop:  99%|█████████▉| 265/268 [00:23<00:00, 12.67it/s]Test-loop: 100%|█████████▉| 267/268 [00:23<00:00, 12.41it/s]Test-loop: 100%|██████████| 268/268 [00:23<00:00, 11.42it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:40,  1.66it/s]Test-loop:   1%|          | 3/268 [00:00<01:06,  3.98it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:49,  5.29it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:42,  6.14it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:39,  6.60it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:37,  6.86it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:35,  7.12it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:34,  7.28it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:33,  7.43it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:33,  7.53it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:32,  7.66it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:31,  7.72it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:30,  7.89it/s]Test-loop:  10%|█         | 27/268 [00:03<00:30,  7.93it/s]Test-loop:  11%|█         | 29/268 [00:04<00:29,  8.02it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:29,  7.99it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:29,  8.04it/s]Test-loop:  13%|█▎        | 35/268 [00:04<00:28,  8.09it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:28,  8.24it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:27,  8.23it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:27,  8.22it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:28,  8.03it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:27,  8.11it/s]Test-loop:  17%|█▋        | 46/268 [00:06<00:27,  8.07it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:27,  8.01it/s]Test-loop:  18%|█▊        | 48/268 [00:06<00:27,  8.01it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:28,  7.77it/s]Test-loop:  19%|█▊        | 50/268 [00:06<00:27,  7.96it/s]Test-loop:  19%|█▉        | 51/268 [00:06<00:27,  7.97it/s]Test-loop:  19%|█▉        | 52/268 [00:07<00:26,  8.01it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:28,  7.51it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.71it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:26,  8.01it/s]Test-loop:  22%|██▏       | 58/268 [00:07<00:26,  8.07it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:26,  8.02it/s]Test-loop:  22%|██▏       | 60/268 [00:08<00:25,  8.23it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:25,  8.14it/s]Test-loop:  23%|██▎       | 62/268 [00:08<00:24,  8.49it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:25,  7.90it/s]Test-loop:  24%|██▍       | 64/268 [00:08<00:24,  8.19it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:24,  8.18it/s]Test-loop:  25%|██▍       | 66/268 [00:08<00:25,  8.06it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:25,  7.92it/s]Test-loop:  25%|██▌       | 68/268 [00:09<00:24,  8.03it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:25,  7.90it/s]Test-loop:  26%|██▌       | 70/268 [00:09<00:24,  8.06it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:24,  8.05it/s]Test-loop:  27%|██▋       | 72/268 [00:09<00:23,  8.19it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:24,  8.03it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:23,  8.23it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:23,  8.25it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:22,  8.43it/s]Test-loop:  30%|██▉       | 80/268 [00:10<00:21,  8.62it/s]Test-loop:  30%|███       | 81/268 [00:10<00:23,  8.12it/s]Test-loop:  31%|███       | 83/268 [00:10<00:23,  7.81it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:23,  7.88it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  7.91it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  7.83it/s]Test-loop:  34%|███▍      | 91/268 [00:11<00:22,  7.76it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:22,  7.88it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.01it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  8.02it/s]Test-loop:  37%|███▋      | 99/268 [00:12<00:20,  8.16it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.21it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  8.11it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:20,  8.05it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:19,  8.08it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.11it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  7.96it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:19,  7.83it/s]Test-loop:  43%|████▎     | 115/268 [00:14<00:18,  8.08it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:18,  7.99it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:19,  7.81it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:18,  7.87it/s]Test-loop:  46%|████▌     | 123/268 [00:15<00:17,  8.09it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:17,  8.00it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  7.92it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:17,  8.01it/s]Test-loop:  49%|████▉     | 131/268 [00:16<00:16,  8.11it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.11it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  8.01it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:16,  7.93it/s]Test-loop:  52%|█████▏    | 139/268 [00:17<00:16,  7.92it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:16,  7.89it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  7.97it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:15,  8.14it/s]Test-loop:  55%|█████▍    | 147/268 [00:18<00:14,  8.18it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  8.12it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  8.03it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:14,  8.16it/s]Test-loop:  58%|█████▊    | 155/268 [00:19<00:13,  8.22it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.27it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  8.27it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:13,  8.21it/s]Test-loop:  61%|██████    | 163/268 [00:20<00:13,  8.03it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:13,  7.90it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  7.95it/s]Test-loop:  63%|██████▎   | 169/268 [00:21<00:12,  7.84it/s]Test-loop:  64%|██████▍   | 171/268 [00:21<00:12,  7.82it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:11,  8.14it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  8.39it/s]Test-loop:  66%|██████▌   | 177/268 [00:22<00:10,  8.40it/s]Test-loop:  67%|██████▋   | 179/268 [00:22<00:10,  8.25it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:10,  8.26it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  8.13it/s]Test-loop:  69%|██████▉   | 185/268 [00:23<00:10,  8.14it/s]Test-loop:  70%|██████▉   | 187/268 [00:23<00:09,  8.34it/s]Test-loop:  71%|███████   | 189/268 [00:24<00:09,  8.35it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  8.22it/s]Test-loop:  72%|███████▏  | 193/268 [00:24<00:09,  8.19it/s]Test-loop:  73%|███████▎  | 195/268 [00:24<00:09,  8.09it/s]Test-loop:  74%|███████▎  | 197/268 [00:25<00:08,  7.90it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  8.02it/s]Test-loop:  75%|███████▌  | 201/268 [00:25<00:08,  8.18it/s]Test-loop:  76%|███████▌  | 203/268 [00:25<00:07,  8.29it/s]Test-loop:  76%|███████▋  | 205/268 [00:25<00:07,  8.44it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  8.64it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:06,  8.78it/s]Test-loop:  79%|███████▊  | 211/268 [00:26<00:06,  8.55it/s]Test-loop:  79%|███████▉  | 213/268 [00:26<00:06,  8.68it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  8.48it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:05,  8.56it/s]Test-loop:  82%|████████▏ | 219/268 [00:27<00:05,  8.51it/s]Test-loop:  82%|████████▏ | 221/268 [00:27<00:05,  8.25it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  8.14it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.04it/s]Test-loop:  85%|████████▍ | 227/268 [00:28<00:05,  8.01it/s]Test-loop:  85%|████████▌ | 229/268 [00:28<00:04,  8.14it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  8.08it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  8.12it/s]Test-loop:  88%|████████▊ | 235/268 [00:29<00:04,  8.13it/s]Test-loop:  88%|████████▊ | 237/268 [00:29<00:03,  8.14it/s]Test-loop:  89%|████████▉ | 239/268 [00:30<00:03,  8.11it/s]Test-loop:  90%|████████▉ | 241/268 [00:30<00:03,  8.30it/s]Test-loop:  91%|█████████ | 243/268 [00:30<00:02,  8.33it/s]Test-loop:  91%|█████████▏| 245/268 [00:30<00:02,  8.25it/s]Test-loop:  92%|█████████▏| 247/268 [00:31<00:02,  8.18it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  8.25it/s]Test-loop:  94%|█████████▎| 251/268 [00:31<00:02,  8.19it/s]Test-loop:  94%|█████████▍| 253/268 [00:31<00:01,  8.12it/s]Test-loop:  95%|█████████▌| 255/268 [00:32<00:01,  8.00it/s]Test-loop:  96%|█████████▌| 257/268 [00:32<00:01,  8.16it/s]Test-loop:  97%|█████████▋| 259/268 [00:32<00:01,  8.29it/s]Test-loop:  97%|█████████▋| 261/268 [00:32<00:00,  8.21it/s]Test-loop:  98%|█████████▊| 263/268 [00:32<00:00,  8.24it/s]Test-loop:  99%|█████████▉| 265/268 [00:33<00:00,  8.23it/s]Test-loop: 100%|█████████▉| 267/268 [00:33<00:00,  8.09it/s]Test-loop: 100%|██████████| 268/268 [00:33<00:00,  7.98it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:   5%|▍         | 821/17100 [00:00<00:01, 8206.33it/s]Loading Data:  10%|▉         | 1652/17100 [00:00<00:01, 8262.71it/s]Loading Data:  15%|█▍        | 2486/17100 [00:00<00:01, 8295.08it/s]Loading Data:  19%|█▉        | 3321/17100 [00:00<00:01, 8314.38it/s]Loading Data:  24%|██▍       | 4153/17100 [00:00<00:01, 8306.09it/s]Loading Data:  29%|██▉       | 4984/17100 [00:00<00:01, 8299.84it/s]Loading Data:  34%|███▍      | 5814/17100 [00:00<00:01, 8293.63it/s]Loading Data:  39%|███▉      | 6644/17100 [00:00<00:01, 8280.36it/s]Loading Data:  44%|████▎     | 7473/17100 [00:00<00:01, 8278.99it/s]Loading Data:  49%|████▊     | 8301/17100 [00:01<00:01, 8273.33it/s]Loading Data:  53%|█████▎    | 9129/17100 [00:01<00:00, 8273.82it/s]Loading Data:  58%|█████▊    | 9961/17100 [00:01<00:00, 8284.81it/s]Loading Data:  63%|██████▎   | 10793/17100 [00:01<00:00, 8293.58it/s]Loading Data:  68%|██████▊   | 11623/17100 [00:01<00:00, 8289.34it/s]Loading Data:  73%|███████▎  | 12452/17100 [00:01<00:00, 8289.05it/s]Loading Data:  78%|███████▊  | 13281/17100 [00:01<00:00, 8287.07it/s]Loading Data:  83%|████████▎ | 14113/17100 [00:01<00:00, 8296.25it/s]Loading Data:  87%|████████▋ | 14947/17100 [00:01<00:00, 8308.42it/s]Loading Data:  92%|█████████▏| 15780/17100 [00:01<00:00, 8314.52it/s]Loading Data:  97%|█████████▋| 16612/17100 [00:02<00:00, 8284.08it/s]Loading Data: 100%|██████████| 17100/17100 [00:02<00:00, 8284.36it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data:  29%|██▉       | 823/2850 [00:00<00:00, 8221.29it/s]Loading Data:  58%|█████▊    | 1654/2850 [00:00<00:00, 8270.04it/s]Loading Data:  87%|████████▋ | 2482/2850 [00:00<00:00, 8254.35it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 8249.36it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:   5%|▍         | 825/17098 [00:00<00:01, 8247.18it/s]Loading Data:  10%|▉         | 1654/17098 [00:00<00:01, 8268.30it/s]Loading Data:  15%|█▍        | 2481/17098 [00:00<00:01, 8266.85it/s]Loading Data:  19%|█▉        | 3308/17098 [00:00<00:01, 8267.01it/s]Loading Data:  24%|██▍       | 4137/17098 [00:00<00:01, 8273.73it/s]Loading Data:  29%|██▉       | 4967/17098 [00:00<00:01, 8281.12it/s]Loading Data:  34%|███▍      | 5798/17098 [00:00<00:01, 8289.86it/s]Loading Data:  39%|███▉      | 6628/17098 [00:00<00:01, 8290.45it/s]Loading Data:  44%|████▎     | 7460/17098 [00:00<00:01, 8297.12it/s]Loading Data:  48%|████▊     | 8290/17098 [00:01<00:01, 8289.53it/s]Loading Data:  53%|█████▎    | 9124/17098 [00:01<00:00, 8302.94it/s]Loading Data:  58%|█████▊    | 9957/17098 [00:01<00:00, 8310.04it/s]Loading Data:  63%|██████▎   | 10790/17098 [00:01<00:00, 8315.60it/s]Loading Data:  68%|██████▊   | 11624/17098 [00:01<00:00, 8321.50it/s]Loading Data:  73%|███████▎  | 12457/17098 [00:01<00:00, 8299.46it/s]Loading Data:  78%|███████▊  | 13287/17098 [00:01<00:00, 8298.66it/s]Loading Data:  83%|████████▎ | 14118/17098 [00:01<00:00, 8299.47it/s]Loading Data:  87%|████████▋ | 14955/17098 [00:01<00:00, 8320.48it/s]Loading Data:  92%|█████████▏| 15788/17098 [00:01<00:00, 8315.81it/s]Loading Data:  97%|█████████▋| 16621/17098 [00:02<00:00, 8317.70it/s]Loading Data: 100%|██████████| 17098/17098 [00:02<00:00, 8301.13it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type               | Params
--------------------------------------------------
0 | model      | ResNet             | 23.5 M
1 | loss_func  | BCELoss            | 0     
2 | accu_func  | MultilabelAccuracy | 0     
3 | auroc_func | MultilabelAUROC    | 0     
--------------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.130    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:22,  1.97it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:07,  5.38it/s]Test-loop:  11%|█         | 5/45 [00:00<00:05,  7.52it/s]Test-loop:  16%|█▌        | 7/45 [00:00<00:04,  8.91it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.97it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.69it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 11.25it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.63it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 11.82it/s]Test-loop:  42%|████▏     | 19/45 [00:01<00:02, 12.04it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 12.16it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 12.38it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.59it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 12.75it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 12.57it/s]Test-loop:  69%|██████▉   | 31/45 [00:02<00:01, 12.46it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.42it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.27it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 12.19it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.24it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.30it/s]Test-loop:  96%|█████████▌| 43/45 [00:03<00:00, 12.24it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 13.17it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 11.08it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:23,  1.86it/s]Test-loop:   1%|          | 3/268 [00:00<00:54,  4.85it/s]Test-loop:   2%|▏         | 5/268 [00:00<00:38,  6.78it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:32,  8.13it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:28,  9.08it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:26,  9.72it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:25, 10.18it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:24, 10.31it/s]Test-loop:   6%|▋         | 17/268 [00:01<00:23, 10.59it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:22, 10.84it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:22, 10.91it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:22, 11.01it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:21, 11.07it/s]Test-loop:  10%|█         | 27/268 [00:02<00:21, 11.07it/s]Test-loop:  11%|█         | 29/268 [00:03<00:21, 11.13it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:21, 11.23it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:21, 11.15it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:20, 11.21it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:20, 11.24it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:20, 11.33it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:19, 11.55it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:19, 11.53it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:19, 11.51it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:19, 11.48it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:19, 11.42it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:19, 11.39it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:18, 11.43it/s]Test-loop:  21%|██        | 55/268 [00:05<00:18, 11.37it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:18, 11.35it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:18, 11.40it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:18, 11.45it/s]Test-loop:  24%|██▎       | 63/268 [00:06<00:17, 11.55it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:17, 11.48it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:17, 11.46it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:17, 11.44it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:17, 11.55it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:16, 11.52it/s]Test-loop:  28%|██▊       | 75/268 [00:07<00:16, 11.57it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:16, 11.61it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:16, 11.53it/s]Test-loop:  30%|███       | 81/268 [00:07<00:16, 11.51it/s]Test-loop:  31%|███       | 83/268 [00:07<00:15, 11.70it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:15, 12.01it/s]Test-loop:  32%|███▏      | 87/268 [00:08<00:14, 12.50it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:14, 12.54it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:14, 12.21it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:14, 12.08it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:14, 11.97it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:14, 11.85it/s]Test-loop:  37%|███▋      | 99/268 [00:09<00:14, 11.73it/s]Test-loop:  38%|███▊      | 101/268 [00:09<00:14, 11.59it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:14, 11.67it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:14, 11.63it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:13, 11.61it/s]Test-loop:  41%|████      | 109/268 [00:09<00:13, 11.61it/s]Test-loop:  41%|████▏     | 111/268 [00:10<00:13, 11.55it/s]Test-loop:  42%|████▏     | 113/268 [00:10<00:13, 11.59it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:13, 11.63it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 11.71it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 11.77it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:12, 11.72it/s]Test-loop:  46%|████▌     | 123/268 [00:11<00:12, 11.75it/s]Test-loop:  47%|████▋     | 125/268 [00:11<00:12, 11.75it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 11.80it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 11.78it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 12.36it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:10, 12.32it/s]Test-loop:  50%|█████     | 135/268 [00:12<00:10, 12.11it/s]Test-loop:  51%|█████     | 137/268 [00:12<00:11, 11.80it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:10, 11.77it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:10, 11.81it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:10, 11.97it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:10, 12.19it/s]Test-loop:  55%|█████▍    | 147/268 [00:13<00:09, 12.24it/s]Test-loop:  56%|█████▌    | 149/268 [00:13<00:09, 12.28it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:09, 12.19it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 12.07it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 12.10it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:08, 12.36it/s]Test-loop:  59%|█████▉    | 159/268 [00:14<00:08, 12.45it/s]Test-loop:  60%|██████    | 161/268 [00:14<00:08, 12.35it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:08, 12.23it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 12.36it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 12.28it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:07, 12.41it/s]Test-loop:  64%|██████▍   | 171/268 [00:15<00:07, 12.35it/s]Test-loop:  65%|██████▍   | 173/268 [00:15<00:07, 12.25it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:07, 12.16it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 12.16it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 12.10it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:07, 12.16it/s]Test-loop:  68%|██████▊   | 183/268 [00:16<00:06, 12.29it/s]Test-loop:  69%|██████▉   | 185/268 [00:16<00:06, 12.23it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 12.23it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 12.29it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 12.16it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:06, 12.14it/s]Test-loop:  73%|███████▎  | 195/268 [00:17<00:06, 11.97it/s]Test-loop:  74%|███████▎  | 197/268 [00:17<00:05, 12.03it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:05, 12.02it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 12.11it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 12.04it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 12.10it/s]Test-loop:  77%|███████▋  | 207/268 [00:18<00:05, 12.20it/s]Test-loop:  78%|███████▊  | 209/268 [00:18<00:04, 12.17it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 12.21it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 12.10it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 12.17it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:04, 12.34it/s]Test-loop:  82%|████████▏ | 219/268 [00:19<00:03, 12.51it/s]Test-loop:  82%|████████▏ | 221/268 [00:19<00:03, 12.43it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 12.29it/s]Test-loop:  84%|████████▍ | 225/268 [00:19<00:03, 12.73it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 13.13it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:02, 13.41it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:02, 13.45it/s]Test-loop:  87%|████████▋ | 233/268 [00:20<00:02, 13.01it/s]Test-loop:  88%|████████▊ | 235/268 [00:20<00:02, 12.72it/s]Test-loop:  88%|████████▊ | 237/268 [00:20<00:02, 12.74it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 12.65it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:02, 12.76it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:01, 12.61it/s]Test-loop:  91%|█████████▏| 245/268 [00:21<00:01, 12.59it/s]Test-loop:  92%|█████████▏| 247/268 [00:21<00:01, 12.34it/s]Test-loop:  93%|█████████▎| 249/268 [00:21<00:01, 12.41it/s]Test-loop:  94%|█████████▎| 251/268 [00:21<00:01, 12.45it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 12.55it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:01, 12.38it/s]Test-loop:  96%|█████████▌| 257/268 [00:22<00:00, 12.28it/s]Test-loop:  97%|█████████▋| 259/268 [00:22<00:00, 12.19it/s]Test-loop:  97%|█████████▋| 261/268 [00:22<00:00, 12.12it/s]Test-loop:  98%|█████████▊| 263/268 [00:22<00:00, 12.22it/s]Test-loop:  99%|█████████▉| 265/268 [00:22<00:00, 12.24it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 12.12it/s]Test-loop: 100%|██████████| 268/268 [00:22<00:00, 11.68it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:41,  1.66it/s]Test-loop:   1%|          | 3/268 [00:00<01:07,  3.93it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:49,  5.27it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:42,  6.11it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:39,  6.63it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:36,  6.95it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:35,  7.13it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:34,  7.28it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:33,  7.40it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:33,  7.51it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:32,  7.63it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:31,  7.72it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:30,  7.97it/s]Test-loop:  10%|█         | 27/268 [00:03<00:29,  8.08it/s]Test-loop:  11%|█         | 29/268 [00:04<00:29,  8.06it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:29,  7.98it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:29,  8.04it/s]Test-loop:  13%|█▎        | 35/268 [00:04<00:29,  7.96it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:28,  8.09it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:28,  8.15it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:27,  8.27it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:27,  8.18it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:26,  8.31it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:26,  8.20it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:27,  8.00it/s]Test-loop:  19%|█▉        | 51/268 [00:06<00:26,  8.08it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:27,  7.77it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.86it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:26,  8.01it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:26,  8.01it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:24,  8.31it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:24,  8.44it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:23,  8.53it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:23,  8.39it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:24,  8.26it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:23,  8.28it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:23,  8.25it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:23,  8.23it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:23,  7.97it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  8.09it/s]Test-loop:  30%|███       | 81/268 [00:10<00:23,  8.08it/s]Test-loop:  31%|███       | 83/268 [00:10<00:23,  7.93it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:22,  8.02it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  7.91it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:23,  7.78it/s]Test-loop:  34%|███▍      | 91/268 [00:11<00:22,  7.70it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:22,  7.88it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.01it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  8.10it/s]Test-loop:  37%|███▋      | 99/268 [00:12<00:20,  8.17it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.23it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  8.13it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:20,  8.04it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:19,  8.16it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.18it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  8.07it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:19,  8.04it/s]Test-loop:  43%|████▎     | 115/268 [00:14<00:18,  8.20it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:18,  7.98it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:19,  7.75it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:19,  7.74it/s]Test-loop:  46%|████▌     | 123/268 [00:15<00:18,  7.96it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:17,  8.01it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  7.95it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:17,  7.99it/s]Test-loop:  49%|████▉     | 131/268 [00:16<00:16,  8.15it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.11it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  8.08it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:16,  8.02it/s]Test-loop:  52%|█████▏    | 139/268 [00:17<00:16,  7.98it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:16,  7.90it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  7.94it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:15,  8.20it/s]Test-loop:  55%|█████▍    | 147/268 [00:18<00:14,  8.18it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  8.10it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  8.05it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:14,  8.15it/s]Test-loop:  58%|█████▊    | 155/268 [00:19<00:13,  8.19it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.30it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  8.29it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:12,  8.44it/s]Test-loop:  61%|██████    | 163/268 [00:20<00:12,  8.53it/s]Test-loop:  62%|██████▏   | 165/268 [00:20<00:12,  8.22it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  8.23it/s]Test-loop:  63%|██████▎   | 169/268 [00:21<00:12,  7.98it/s]Test-loop:  64%|██████▍   | 171/268 [00:21<00:12,  7.92it/s]Test-loop:  65%|██████▍   | 173/268 [00:21<00:11,  7.98it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  7.99it/s]Test-loop:  66%|██████▌   | 177/268 [00:22<00:11,  8.19it/s]Test-loop:  67%|██████▋   | 179/268 [00:22<00:10,  8.21it/s]Test-loop:  68%|██████▊   | 181/268 [00:22<00:10,  8.27it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  8.12it/s]Test-loop:  69%|██████▉   | 185/268 [00:23<00:10,  8.13it/s]Test-loop:  70%|██████▉   | 187/268 [00:23<00:09,  8.32it/s]Test-loop:  71%|███████   | 189/268 [00:23<00:09,  8.40it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  8.34it/s]Test-loop:  72%|███████▏  | 193/268 [00:24<00:09,  8.33it/s]Test-loop:  73%|███████▎  | 195/268 [00:24<00:08,  8.33it/s]Test-loop:  74%|███████▎  | 197/268 [00:24<00:08,  8.20it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  8.28it/s]Test-loop:  75%|███████▌  | 201/268 [00:25<00:07,  8.45it/s]Test-loop:  76%|███████▌  | 203/268 [00:25<00:07,  8.59it/s]Test-loop:  76%|███████▋  | 205/268 [00:25<00:07,  8.58it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:06,  8.75it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:06,  8.77it/s]Test-loop:  79%|███████▊  | 211/268 [00:26<00:06,  8.59it/s]Test-loop:  79%|███████▉  | 213/268 [00:26<00:06,  8.79it/s]Test-loop:  80%|████████  | 215/268 [00:26<00:06,  8.57it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:05,  8.51it/s]Test-loop:  82%|████████▏ | 219/268 [00:27<00:05,  8.45it/s]Test-loop:  82%|████████▏ | 221/268 [00:27<00:05,  8.18it/s]Test-loop:  83%|████████▎ | 223/268 [00:27<00:05,  8.14it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.06it/s]Test-loop:  85%|████████▍ | 227/268 [00:28<00:05,  8.12it/s]Test-loop:  85%|████████▌ | 229/268 [00:28<00:04,  8.26it/s]Test-loop:  86%|████████▌ | 231/268 [00:28<00:04,  8.23it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  8.26it/s]Test-loop:  88%|████████▊ | 235/268 [00:29<00:04,  8.22it/s]Test-loop:  88%|████████▊ | 237/268 [00:29<00:03,  8.24it/s]Test-loop:  89%|████████▉ | 239/268 [00:29<00:03,  8.20it/s]Test-loop:  90%|████████▉ | 241/268 [00:30<00:03,  8.41it/s]Test-loop:  91%|█████████ | 243/268 [00:30<00:02,  8.45it/s]Test-loop:  91%|█████████▏| 245/268 [00:30<00:02,  8.40it/s]Test-loop:  92%|█████████▏| 247/268 [00:30<00:02,  8.25it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  8.26it/s]Test-loop:  94%|█████████▎| 251/268 [00:31<00:02,  8.21it/s]Test-loop:  94%|█████████▍| 253/268 [00:31<00:01,  8.26it/s]Test-loop:  95%|█████████▌| 255/268 [00:31<00:01,  8.12it/s]Test-loop:  96%|█████████▌| 257/268 [00:32<00:01,  8.15it/s]Test-loop:  97%|█████████▋| 259/268 [00:32<00:01,  8.26it/s]Test-loop:  97%|█████████▋| 261/268 [00:32<00:00,  8.37it/s]Test-loop:  98%|█████████▊| 263/268 [00:32<00:00,  8.61it/s]Test-loop:  99%|█████████▉| 265/268 [00:32<00:00,  8.52it/s]Test-loop: 100%|█████████▉| 267/268 [00:33<00:00,  8.33it/s]Test-loop: 100%|██████████| 268/268 [00:33<00:00,  8.03it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:   5%|▍         | 842/17100 [00:00<00:01, 8410.44it/s]Loading Data:  10%|▉         | 1686/17100 [00:00<00:01, 8425.75it/s]Loading Data:  15%|█▍        | 2536/17100 [00:00<00:01, 8455.26it/s]Loading Data:  20%|█▉        | 3382/17100 [00:00<00:01, 8417.09it/s]Loading Data:  25%|██▍       | 4225/17100 [00:00<00:01, 8418.78it/s]Loading Data:  30%|██▉       | 5067/17100 [00:00<00:01, 8414.11it/s]Loading Data:  35%|███▍      | 5909/17100 [00:00<00:01, 8405.68it/s]Loading Data:  39%|███▉      | 6750/17100 [00:00<00:01, 8393.22it/s]Loading Data:  44%|████▍     | 7590/17100 [00:00<00:01, 8368.93it/s]Loading Data:  49%|████▉     | 8427/17100 [00:01<00:01, 8350.49it/s]Loading Data:  54%|█████▍    | 9263/17100 [00:01<00:00, 8342.14it/s]Loading Data:  59%|█████▉    | 10104/17100 [00:01<00:00, 8362.64it/s]Loading Data:  64%|██████▍   | 10943/17100 [00:01<00:00, 8369.87it/s]Loading Data:  69%|██████▉   | 11782/17100 [00:01<00:00, 8374.38it/s]Loading Data:  74%|███████▍  | 12620/17100 [00:01<00:00, 8366.65it/s]Loading Data:  79%|███████▊  | 13460/17100 [00:01<00:00, 8374.97it/s]Loading Data:  84%|████████▎ | 14299/17100 [00:01<00:00, 8377.29it/s]Loading Data:  89%|████████▊ | 15138/17100 [00:01<00:00, 8379.56it/s]Loading Data:  93%|█████████▎| 15977/17100 [00:01<00:00, 8381.91it/s]Loading Data:  98%|█████████▊| 16816/17100 [00:02<00:00, 8381.41it/s]Loading Data: 100%|██████████| 17100/17100 [00:02<00:00, 8381.70it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data:  29%|██▉       | 837/2850 [00:00<00:00, 8366.96it/s]Loading Data:  59%|█████▉    | 1679/2850 [00:00<00:00, 8394.27it/s]Loading Data:  88%|████████▊ | 2520/2850 [00:00<00:00, 8401.34it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 8403.06it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:   5%|▍         | 841/17098 [00:00<00:01, 8401.74it/s]Loading Data:  10%|▉         | 1686/17098 [00:00<00:01, 8424.26it/s]Loading Data:  15%|█▍        | 2533/17098 [00:00<00:01, 8440.72it/s]Loading Data:  20%|█▉        | 3379/17098 [00:00<00:01, 8445.91it/s]Loading Data:  25%|██▍       | 4226/17098 [00:00<00:01, 8451.27it/s]Loading Data:  30%|██▉       | 5074/17098 [00:00<00:01, 8457.87it/s]Loading Data:  35%|███▍      | 5921/17098 [00:00<00:01, 8461.30it/s]Loading Data:  40%|███▉      | 6768/17098 [00:00<00:01, 8462.70it/s]Loading Data:  45%|████▍     | 7615/17098 [00:00<00:01, 8463.92it/s]Loading Data:  49%|████▉     | 8462/17098 [00:01<00:01, 8460.65it/s]Loading Data:  54%|█████▍    | 9309/17098 [00:01<00:00, 8414.50it/s]Loading Data:  59%|█████▉    | 10155/17098 [00:01<00:00, 8427.17it/s]Loading Data:  64%|██████▍   | 10999/17098 [00:01<00:00, 8429.46it/s]Loading Data:  69%|██████▉   | 11846/17098 [00:01<00:00, 8441.21it/s]Loading Data:  74%|███████▍  | 12691/17098 [00:01<00:00, 8443.26it/s]Loading Data:  79%|███████▉  | 13539/17098 [00:01<00:00, 8452.47it/s]Loading Data:  84%|████████▍ | 14385/17098 [00:01<00:00, 8446.42it/s]Loading Data:  89%|████████▉ | 15230/17098 [00:01<00:00, 8442.79it/s]Loading Data:  94%|█████████▍| 16078/17098 [00:01<00:00, 8453.66it/s]Loading Data:  99%|█████████▉| 16924/17098 [00:02<00:00, 8446.54it/s]Loading Data: 100%|██████████| 17098/17098 [00:02<00:00, 8445.09it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type               | Params
--------------------------------------------------
0 | model      | ResNet             | 23.5 M
1 | loss_func  | BCELoss            | 0     
2 | accu_func  | MultilabelAccuracy | 0     
3 | auroc_func | MultilabelAUROC    | 0     
--------------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.130    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:25,  1.70it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.64it/s]Test-loop:  11%|█         | 5/45 [00:00<00:05,  6.71it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.22it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.30it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03,  9.94it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:03, 10.43it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.06it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 11.36it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.61it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:02, 11.86it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 11.99it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.03it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 12.01it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 11.97it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 12.03it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.13it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.22it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 12.30it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.35it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.24it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 12.33it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 13.21it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.61it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:43,  1.63it/s]Test-loop:   1%|          | 3/268 [00:00<01:00,  4.35it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:43,  6.08it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:34,  7.53it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:29,  8.64it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:27,  9.37it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:25, 10.04it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:24, 10.46it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:23, 10.86it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:22, 11.12it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:21, 11.57it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:20, 12.06it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:19, 12.19it/s]Test-loop:  10%|█         | 27/268 [00:02<00:19, 12.39it/s]Test-loop:  11%|█         | 29/268 [00:03<00:19, 12.24it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:19, 12.14it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:19, 12.16it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:19, 12.19it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:18, 12.16it/s]Test-loop:  15%|█▍        | 39/268 [00:03<00:18, 12.28it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:18, 12.22it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:18, 12.19it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:18, 12.24it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:18, 12.20it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:17, 12.19it/s]Test-loop:  19%|█▉        | 51/268 [00:04<00:17, 12.07it/s]Test-loop:  20%|█▉        | 53/268 [00:04<00:17, 12.10it/s]Test-loop:  21%|██        | 55/268 [00:05<00:17, 12.11it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:17, 12.12it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:16, 12.33it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:16, 12.33it/s]Test-loop:  24%|██▎       | 63/268 [00:05<00:16, 12.28it/s]Test-loop:  24%|██▍       | 65/268 [00:05<00:16, 12.28it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:16, 12.38it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:16, 12.36it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:15, 12.47it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:15, 12.58it/s]Test-loop:  28%|██▊       | 75/268 [00:06<00:15, 12.86it/s]Test-loop:  29%|██▊       | 77/268 [00:06<00:14, 12.91it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:14, 12.75it/s]Test-loop:  30%|███       | 81/268 [00:07<00:14, 12.64it/s]Test-loop:  31%|███       | 83/268 [00:07<00:14, 12.60it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:14, 12.58it/s]Test-loop:  32%|███▏      | 87/268 [00:07<00:14, 12.51it/s]Test-loop:  33%|███▎      | 89/268 [00:07<00:14, 12.37it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:14, 12.38it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:14, 12.26it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:14, 12.18it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:14, 12.12it/s]Test-loop:  37%|███▋      | 99/268 [00:08<00:13, 12.20it/s]Test-loop:  38%|███▊      | 101/268 [00:08<00:13, 12.23it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:13, 12.04it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:13, 12.09it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:13, 11.91it/s]Test-loop:  41%|████      | 109/268 [00:09<00:13, 11.81it/s]Test-loop:  41%|████▏     | 111/268 [00:09<00:13, 11.96it/s]Test-loop:  42%|████▏     | 113/268 [00:09<00:12, 12.08it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:12, 12.19it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 12.05it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 12.04it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:12, 12.06it/s]Test-loop:  46%|████▌     | 123/268 [00:10<00:12, 12.03it/s]Test-loop:  47%|████▋     | 125/268 [00:10<00:11, 12.05it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 11.95it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 11.85it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 12.12it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:11, 12.03it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:11, 11.88it/s]Test-loop:  51%|█████     | 137/268 [00:11<00:11, 11.77it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:10, 11.88it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:10, 11.96it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:10, 11.87it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:10, 11.90it/s]Test-loop:  55%|█████▍    | 147/268 [00:12<00:10, 12.09it/s]Test-loop:  56%|█████▌    | 149/268 [00:12<00:09, 12.29it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:09, 12.20it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 12.33it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 12.42it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:08, 12.53it/s]Test-loop:  59%|█████▉    | 159/268 [00:13<00:08, 12.61it/s]Test-loop:  60%|██████    | 161/268 [00:13<00:08, 12.61it/s]Test-loop:  61%|██████    | 163/268 [00:13<00:08, 12.72it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 12.78it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 12.44it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:07, 12.40it/s]Test-loop:  64%|██████▍   | 171/268 [00:14<00:07, 12.36it/s]Test-loop:  65%|██████▍   | 173/268 [00:14<00:07, 12.30it/s]Test-loop:  65%|██████▌   | 175/268 [00:14<00:07, 12.23it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 12.30it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 12.39it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:06, 12.50it/s]Test-loop:  68%|██████▊   | 183/268 [00:15<00:06, 12.46it/s]Test-loop:  69%|██████▉   | 185/268 [00:15<00:06, 12.47it/s]Test-loop:  70%|██████▉   | 187/268 [00:15<00:06, 12.49it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 12.63it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 12.51it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:06, 12.31it/s]Test-loop:  73%|███████▎  | 195/268 [00:16<00:06, 12.08it/s]Test-loop:  74%|███████▎  | 197/268 [00:16<00:05, 12.02it/s]Test-loop:  74%|███████▍  | 199/268 [00:16<00:05, 12.07it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 12.16it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 12.29it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 12.30it/s]Test-loop:  77%|███████▋  | 207/268 [00:17<00:04, 12.21it/s]Test-loop:  78%|███████▊  | 209/268 [00:17<00:05, 11.79it/s]Test-loop:  79%|███████▊  | 211/268 [00:17<00:04, 12.24it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 12.56it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 12.82it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:04, 12.73it/s]Test-loop:  82%|████████▏ | 219/268 [00:18<00:03, 12.33it/s]Test-loop:  82%|████████▏ | 221/268 [00:18<00:03, 12.12it/s]Test-loop:  83%|████████▎ | 223/268 [00:18<00:03, 12.20it/s]Test-loop:  84%|████████▍ | 225/268 [00:19<00:03, 12.07it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 11.96it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:03, 11.85it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:03, 11.95it/s]Test-loop:  87%|████████▋ | 233/268 [00:19<00:02, 12.01it/s]Test-loop:  88%|████████▊ | 235/268 [00:19<00:02, 12.19it/s]Test-loop:  88%|████████▊ | 237/268 [00:20<00:02, 12.30it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 12.40it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:02, 12.46it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:02, 12.48it/s]Test-loop:  91%|█████████▏| 245/268 [00:20<00:01, 12.30it/s]Test-loop:  92%|█████████▏| 247/268 [00:20<00:01, 12.39it/s]Test-loop:  93%|█████████▎| 249/268 [00:20<00:01, 12.32it/s]Test-loop:  94%|█████████▎| 251/268 [00:21<00:01, 12.35it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 12.42it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:01, 12.39it/s]Test-loop:  96%|█████████▌| 257/268 [00:21<00:00, 12.47it/s]Test-loop:  97%|█████████▋| 259/268 [00:21<00:00, 12.43it/s]Test-loop:  97%|█████████▋| 261/268 [00:21<00:00, 12.45it/s]Test-loop:  98%|█████████▊| 263/268 [00:22<00:00, 12.50it/s]Test-loop:  99%|█████████▉| 265/268 [00:22<00:00, 12.43it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 12.16it/s]Test-loop: 100%|██████████| 268/268 [00:22<00:00, 11.89it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:13,  1.38it/s]Test-loop:   1%|          | 3/268 [00:00<01:15,  3.49it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:53,  4.89it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:44,  5.88it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:40,  6.33it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:38,  6.72it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:36,  7.02it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:35,  7.19it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:34,  7.37it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:33,  7.49it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:32,  7.72it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:31,  7.86it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:30,  7.99it/s]Test-loop:  10%|█         | 27/268 [00:04<00:29,  8.07it/s]Test-loop:  11%|█         | 29/268 [00:04<00:29,  8.12it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:29,  8.05it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:28,  8.12it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:28,  8.18it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:27,  8.29it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:27,  8.34it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:26,  8.41it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:27,  8.32it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:26,  8.49it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:26,  8.32it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:27,  8.08it/s]Test-loop:  19%|█▉        | 51/268 [00:06<00:26,  8.16it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:27,  7.78it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.86it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:25,  8.21it/s]Test-loop:  22%|██▏       | 59/268 [00:07<00:25,  8.33it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:24,  8.39it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:24,  8.28it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:24,  8.35it/s]Test-loop:  25%|██▌       | 67/268 [00:08<00:24,  8.26it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:24,  8.24it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:23,  8.34it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:23,  8.36it/s]Test-loop:  28%|██▊       | 75/268 [00:09<00:23,  8.20it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:23,  8.00it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  8.01it/s]Test-loop:  30%|███       | 81/268 [00:10<00:23,  8.08it/s]Test-loop:  31%|███       | 83/268 [00:10<00:23,  8.01it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:22,  8.06it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  8.03it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  7.91it/s]Test-loop:  34%|███▍      | 91/268 [00:11<00:22,  7.83it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:22,  7.91it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.06it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  8.04it/s]Test-loop:  37%|███▋      | 99/268 [00:12<00:20,  8.19it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.24it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  8.17it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:19,  8.16it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:19,  8.34it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.29it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  8.12it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:19,  8.04it/s]Test-loop:  43%|████▎     | 115/268 [00:14<00:18,  8.27it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:18,  8.14it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:18,  7.95it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:18,  8.04it/s]Test-loop:  46%|████▌     | 123/268 [00:15<00:17,  8.26it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:17,  8.22it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  8.10it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:17,  8.14it/s]Test-loop:  49%|████▉     | 131/268 [00:16<00:16,  8.35it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.29it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:15,  8.32it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:15,  8.29it/s]Test-loop:  52%|█████▏    | 139/268 [00:17<00:15,  8.34it/s]Test-loop:  53%|█████▎    | 141/268 [00:17<00:15,  8.26it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:14,  8.33it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:14,  8.56it/s]Test-loop:  55%|█████▍    | 147/268 [00:18<00:14,  8.49it/s]Test-loop:  56%|█████▌    | 149/268 [00:18<00:14,  8.44it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:13,  8.37it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:13,  8.45it/s]Test-loop:  58%|█████▊    | 155/268 [00:19<00:13,  8.68it/s]Test-loop:  59%|█████▊    | 157/268 [00:19<00:12,  8.84it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:12,  8.83it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:12,  8.73it/s]Test-loop:  61%|██████    | 163/268 [00:20<00:12,  8.57it/s]Test-loop:  62%|██████▏   | 165/268 [00:20<00:12,  8.34it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  8.37it/s]Test-loop:  63%|██████▎   | 169/268 [00:21<00:12,  8.14it/s]Test-loop:  64%|██████▍   | 171/268 [00:21<00:11,  8.15it/s]Test-loop:  65%|██████▍   | 173/268 [00:21<00:11,  8.24it/s]Test-loop:  65%|██████▌   | 175/268 [00:21<00:11,  8.23it/s]Test-loop:  66%|██████▌   | 177/268 [00:22<00:11,  8.21it/s]Test-loop:  67%|██████▋   | 179/268 [00:22<00:10,  8.18it/s]Test-loop:  68%|██████▊   | 181/268 [00:22<00:10,  8.28it/s]Test-loop:  68%|██████▊   | 183/268 [00:22<00:10,  8.09it/s]Test-loop:  69%|██████▉   | 185/268 [00:23<00:10,  8.06it/s]Test-loop:  70%|██████▉   | 187/268 [00:23<00:09,  8.31it/s]Test-loop:  71%|███████   | 189/268 [00:23<00:09,  8.46it/s]Test-loop:  71%|███████▏  | 191/268 [00:23<00:09,  8.43it/s]Test-loop:  72%|███████▏  | 193/268 [00:24<00:08,  8.37it/s]Test-loop:  73%|███████▎  | 195/268 [00:24<00:08,  8.27it/s]Test-loop:  74%|███████▎  | 197/268 [00:24<00:08,  8.08it/s]Test-loop:  74%|███████▍  | 199/268 [00:24<00:08,  8.16it/s]Test-loop:  75%|███████▌  | 201/268 [00:25<00:08,  8.29it/s]Test-loop:  76%|███████▌  | 203/268 [00:25<00:07,  8.35it/s]Test-loop:  76%|███████▋  | 205/268 [00:25<00:07,  8.45it/s]Test-loop:  77%|███████▋  | 207/268 [00:25<00:07,  8.58it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:06,  8.70it/s]Test-loop:  79%|███████▊  | 211/268 [00:26<00:06,  8.43it/s]Test-loop:  79%|███████▉  | 213/268 [00:26<00:06,  8.59it/s]Test-loop:  80%|████████  | 215/268 [00:26<00:06,  8.35it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:06,  8.31it/s]Test-loop:  82%|████████▏ | 219/268 [00:27<00:05,  8.26it/s]Test-loop:  82%|████████▏ | 221/268 [00:27<00:05,  8.09it/s]Test-loop:  83%|████████▎ | 223/268 [00:27<00:05,  8.03it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.00it/s]Test-loop:  85%|████████▍ | 227/268 [00:28<00:05,  8.09it/s]Test-loop:  85%|████████▌ | 229/268 [00:28<00:04,  8.25it/s]Test-loop:  86%|████████▌ | 231/268 [00:28<00:04,  8.28it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  8.26it/s]Test-loop:  88%|████████▊ | 235/268 [00:29<00:03,  8.26it/s]Test-loop:  88%|████████▊ | 237/268 [00:29<00:03,  8.31it/s]Test-loop:  89%|████████▉ | 239/268 [00:29<00:03,  8.34it/s]Test-loop:  90%|████████▉ | 241/268 [00:29<00:03,  8.55it/s]Test-loop:  91%|█████████ | 243/268 [00:30<00:02,  8.55it/s]Test-loop:  91%|█████████▏| 245/268 [00:30<00:02,  8.39it/s]Test-loop:  92%|█████████▏| 247/268 [00:30<00:02,  8.20it/s]Test-loop:  93%|█████████▎| 249/268 [00:30<00:02,  8.21it/s]Test-loop:  94%|█████████▎| 251/268 [00:31<00:02,  8.36it/s]Test-loop:  94%|█████████▍| 253/268 [00:31<00:01,  8.51it/s]Test-loop:  95%|█████████▌| 255/268 [00:31<00:01,  8.33it/s]Test-loop:  96%|█████████▌| 257/268 [00:31<00:01,  8.36it/s]Test-loop:  97%|█████████▋| 259/268 [00:32<00:01,  8.43it/s]Test-loop:  97%|█████████▋| 261/268 [00:32<00:00,  8.35it/s]Test-loop:  98%|█████████▊| 263/268 [00:32<00:00,  8.39it/s]Test-loop:  99%|█████████▉| 265/268 [00:32<00:00,  8.28it/s]Test-loop: 100%|█████████▉| 267/268 [00:33<00:00,  8.17it/s]Test-loop: 100%|██████████| 268/268 [00:33<00:00,  8.07it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:   5%|▍         | 829/17100 [00:00<00:01, 8282.98it/s]Loading Data:  10%|▉         | 1661/17100 [00:00<00:01, 8301.44it/s]Loading Data:  15%|█▍        | 2498/17100 [00:00<00:01, 8328.79it/s]Loading Data:  20%|█▉        | 3336/17100 [00:00<00:01, 8346.28it/s]Loading Data:  24%|██▍       | 4172/17100 [00:00<00:01, 8347.95it/s]Loading Data:  29%|██▉       | 5007/17100 [00:00<00:01, 8290.21it/s]Loading Data:  34%|███▍      | 5839/17100 [00:00<00:01, 8299.05it/s]Loading Data:  39%|███▉      | 6669/17100 [00:00<00:01, 8296.85it/s]Loading Data:  44%|████▍     | 7499/17100 [00:00<00:01, 8279.05it/s]Loading Data:  49%|████▊     | 8329/17100 [00:01<00:01, 8283.92it/s]Loading Data:  54%|█████▎    | 9158/17100 [00:01<00:00, 8283.39it/s]Loading Data:  58%|█████▊    | 9989/17100 [00:01<00:00, 8289.64it/s]Loading Data:  63%|██████▎   | 10821/17100 [00:01<00:00, 8296.18it/s]Loading Data:  68%|██████▊   | 11651/17100 [00:01<00:00, 8281.17it/s]Loading Data:  73%|███████▎  | 12480/17100 [00:01<00:00, 8277.96it/s]Loading Data:  78%|███████▊  | 13312/17100 [00:01<00:00, 8288.73it/s]Loading Data:  83%|████████▎ | 14141/17100 [00:01<00:00, 8279.34it/s]Loading Data:  88%|████████▊ | 14970/17100 [00:01<00:00, 8281.84it/s]Loading Data:  92%|█████████▏| 15799/17100 [00:01<00:00, 8284.02it/s]Loading Data:  97%|█████████▋| 16628/17100 [00:02<00:00, 8284.99it/s]Loading Data: 100%|██████████| 17100/17100 [00:02<00:00, 8290.92it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data:  29%|██▉       | 829/2850 [00:00<00:00, 8281.08it/s]Loading Data:  58%|█████▊    | 1667/2850 [00:00<00:00, 8336.21it/s]Loading Data:  88%|████████▊ | 2501/2850 [00:00<00:00, 8319.70it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 8318.81it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:   5%|▍         | 831/17098 [00:00<00:01, 8308.62it/s]Loading Data:  10%|▉         | 1662/17098 [00:00<00:01, 8299.38it/s]Loading Data:  15%|█▍        | 2498/17098 [00:00<00:01, 8324.55it/s]Loading Data:  20%|█▉        | 3335/17098 [00:00<00:01, 8338.32it/s]Loading Data:  24%|██▍       | 4169/17098 [00:00<00:01, 8330.38it/s]Loading Data:  29%|██▉       | 5003/17098 [00:00<00:01, 8297.98it/s]Loading Data:  34%|███▍      | 5833/17098 [00:00<00:01, 8289.73it/s]Loading Data:  39%|███▉      | 6675/17098 [00:00<00:01, 8330.71it/s]Loading Data:  44%|████▍     | 7509/17098 [00:00<00:01, 8324.58it/s]Loading Data:  49%|████▉     | 8348/17098 [00:01<00:01, 8343.13it/s]Loading Data:  54%|█████▎    | 9184/17098 [00:01<00:00, 8347.83it/s]Loading Data:  59%|█████▊    | 10024/17098 [00:01<00:00, 8361.01it/s]Loading Data:  64%|██████▎   | 10862/17098 [00:01<00:00, 8363.91it/s]Loading Data:  68%|██████▊   | 11703/17098 [00:01<00:00, 8375.50it/s]Loading Data:  73%|███████▎  | 12541/17098 [00:01<00:00, 8374.15it/s]Loading Data:  78%|███████▊  | 13379/17098 [00:01<00:00, 8366.53it/s]Loading Data:  83%|████████▎ | 14216/17098 [00:01<00:00, 8366.63it/s]Loading Data:  88%|████████▊ | 15056/17098 [00:01<00:00, 8374.39it/s]Loading Data:  93%|█████████▎| 15894/17098 [00:01<00:00, 8369.26it/s]Loading Data:  98%|█████████▊| 16731/17098 [00:02<00:00, 8349.29it/s]Loading Data: 100%|██████████| 17098/17098 [00:02<00:00, 8345.66it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type               | Params
--------------------------------------------------
0 | model      | ResNet             | 23.5 M
1 | loss_func  | BCELoss            | 0     
2 | accu_func  | MultilabelAccuracy | 0     
3 | auroc_func | MultilabelAUROC    | 0     
--------------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.130    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:28,  1.53it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.30it/s]Test-loop:  11%|█         | 5/45 [00:01<00:06,  6.31it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  7.73it/s]Test-loop:  20%|██        | 9/45 [00:01<00:04,  8.85it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03,  9.63it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:03, 10.25it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 10.56it/s]Test-loop:  38%|███▊      | 17/45 [00:02<00:02, 10.85it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 10.95it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:02, 11.26it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 11.28it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 11.40it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 11.50it/s]Test-loop:  64%|██████▍   | 29/45 [00:03<00:01, 11.60it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 11.51it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:01, 11.55it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 11.59it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 11.54it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 11.52it/s]Test-loop:  91%|█████████ | 41/45 [00:04<00:00, 11.39it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 11.42it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 12.48it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.04it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:53,  1.54it/s]Test-loop:   1%|          | 3/268 [00:00<01:03,  4.16it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:43,  6.03it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:35,  7.40it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:30,  8.47it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:27,  9.29it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:26,  9.71it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:24, 10.13it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:24, 10.40it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:23, 10.60it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:23, 10.69it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:22, 10.80it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:22, 10.84it/s]Test-loop:  10%|█         | 27/268 [00:03<00:21, 11.06it/s]Test-loop:  11%|█         | 29/268 [00:03<00:21, 11.11it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:21, 11.10it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:20, 11.21it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:20, 11.17it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:21, 10.75it/s]Test-loop:  15%|█▍        | 39/268 [00:04<00:21, 10.90it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:20, 10.94it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:20, 11.05it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:20, 11.12it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:19, 11.20it/s]Test-loop:  18%|█▊        | 49/268 [00:05<00:19, 11.32it/s]Test-loop:  19%|█▉        | 51/268 [00:05<00:19, 11.26it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:19, 11.10it/s]Test-loop:  21%|██        | 55/268 [00:05<00:19, 11.09it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:19, 10.97it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:18, 11.11it/s]Test-loop:  23%|██▎       | 61/268 [00:06<00:18, 11.14it/s]Test-loop:  24%|██▎       | 63/268 [00:06<00:18, 11.17it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:18, 11.14it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:18, 11.01it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:17, 11.21it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:17, 11.24it/s]Test-loop:  27%|██▋       | 73/268 [00:07<00:17, 11.18it/s]Test-loop:  28%|██▊       | 75/268 [00:07<00:17, 11.08it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:17, 11.04it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:17, 11.06it/s]Test-loop:  30%|███       | 81/268 [00:07<00:16, 11.17it/s]Test-loop:  31%|███       | 83/268 [00:08<00:16, 11.16it/s]Test-loop:  32%|███▏      | 85/268 [00:08<00:16, 11.30it/s]Test-loop:  32%|███▏      | 87/268 [00:08<00:15, 11.37it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:15, 11.30it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:15, 11.20it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:15, 11.45it/s]Test-loop:  35%|███▌      | 95/268 [00:09<00:14, 11.57it/s]Test-loop:  36%|███▌      | 97/268 [00:09<00:14, 11.72it/s]Test-loop:  37%|███▋      | 99/268 [00:09<00:14, 11.89it/s]Test-loop:  38%|███▊      | 101/268 [00:09<00:14, 11.79it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:14, 11.48it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:14, 11.35it/s]Test-loop:  40%|███▉      | 107/268 [00:10<00:14, 11.33it/s]Test-loop:  41%|████      | 109/268 [00:10<00:14, 11.34it/s]Test-loop:  41%|████▏     | 111/268 [00:10<00:13, 11.23it/s]Test-loop:  42%|████▏     | 113/268 [00:10<00:13, 11.23it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:13, 11.23it/s]Test-loop:  44%|████▎     | 117/268 [00:11<00:13, 11.29it/s]Test-loop:  44%|████▍     | 119/268 [00:11<00:13, 11.26it/s]Test-loop:  45%|████▌     | 121/268 [00:11<00:12, 11.32it/s]Test-loop:  46%|████▌     | 123/268 [00:11<00:12, 11.27it/s]Test-loop:  47%|████▋     | 125/268 [00:11<00:12, 11.24it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:12, 11.23it/s]Test-loop:  48%|████▊     | 129/268 [00:12<00:12, 11.32it/s]Test-loop:  49%|████▉     | 131/268 [00:12<00:11, 11.55it/s]Test-loop:  50%|████▉     | 133/268 [00:12<00:11, 11.79it/s]Test-loop:  50%|█████     | 135/268 [00:12<00:11, 12.08it/s]Test-loop:  51%|█████     | 137/268 [00:12<00:10, 12.26it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:10, 11.98it/s]Test-loop:  53%|█████▎    | 141/268 [00:13<00:10, 11.85it/s]Test-loop:  53%|█████▎    | 143/268 [00:13<00:10, 11.69it/s]Test-loop:  54%|█████▍    | 145/268 [00:13<00:10, 11.55it/s]Test-loop:  55%|█████▍    | 147/268 [00:13<00:10, 11.64it/s]Test-loop:  56%|█████▌    | 149/268 [00:13<00:10, 11.57it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:10, 11.66it/s]Test-loop:  57%|█████▋    | 153/268 [00:14<00:09, 11.62it/s]Test-loop:  58%|█████▊    | 155/268 [00:14<00:09, 11.60it/s]Test-loop:  59%|█████▊    | 157/268 [00:14<00:09, 11.53it/s]Test-loop:  59%|█████▉    | 159/268 [00:14<00:09, 11.38it/s]Test-loop:  60%|██████    | 161/268 [00:14<00:09, 11.54it/s]Test-loop:  61%|██████    | 163/268 [00:15<00:09, 11.52it/s]Test-loop:  62%|██████▏   | 165/268 [00:15<00:08, 11.48it/s]Test-loop:  62%|██████▏   | 167/268 [00:15<00:08, 11.37it/s]Test-loop:  63%|██████▎   | 169/268 [00:15<00:08, 11.34it/s]Test-loop:  64%|██████▍   | 171/268 [00:15<00:08, 11.62it/s]Test-loop:  65%|██████▍   | 173/268 [00:15<00:08, 11.78it/s]Test-loop:  65%|██████▌   | 175/268 [00:16<00:07, 11.70it/s]Test-loop:  66%|██████▌   | 177/268 [00:16<00:07, 11.55it/s]Test-loop:  67%|██████▋   | 179/268 [00:16<00:07, 11.40it/s]Test-loop:  68%|██████▊   | 181/268 [00:16<00:07, 11.30it/s]Test-loop:  68%|██████▊   | 183/268 [00:16<00:07, 11.28it/s]Test-loop:  69%|██████▉   | 185/268 [00:16<00:07, 11.27it/s]Test-loop:  70%|██████▉   | 187/268 [00:17<00:07, 11.34it/s]Test-loop:  71%|███████   | 189/268 [00:17<00:06, 11.37it/s]Test-loop:  71%|███████▏  | 191/268 [00:17<00:06, 11.40it/s]Test-loop:  72%|███████▏  | 193/268 [00:17<00:06, 11.46it/s]Test-loop:  73%|███████▎  | 195/268 [00:17<00:06, 11.35it/s]Test-loop:  74%|███████▎  | 197/268 [00:17<00:06, 11.37it/s]Test-loop:  74%|███████▍  | 199/268 [00:18<00:06, 11.33it/s]Test-loop:  75%|███████▌  | 201/268 [00:18<00:05, 11.26it/s]Test-loop:  76%|███████▌  | 203/268 [00:18<00:05, 11.29it/s]Test-loop:  76%|███████▋  | 205/268 [00:18<00:05, 11.40it/s]Test-loop:  77%|███████▋  | 207/268 [00:18<00:05, 11.32it/s]Test-loop:  78%|███████▊  | 209/268 [00:19<00:05, 11.44it/s]Test-loop:  79%|███████▊  | 211/268 [00:19<00:04, 11.56it/s]Test-loop:  79%|███████▉  | 213/268 [00:19<00:04, 11.45it/s]Test-loop:  80%|████████  | 215/268 [00:19<00:04, 11.51it/s]Test-loop:  81%|████████  | 217/268 [00:19<00:04, 11.35it/s]Test-loop:  82%|████████▏ | 219/268 [00:19<00:04, 11.29it/s]Test-loop:  82%|████████▏ | 221/268 [00:20<00:04, 11.23it/s]Test-loop:  83%|████████▎ | 223/268 [00:20<00:04, 11.19it/s]Test-loop:  84%|████████▍ | 225/268 [00:20<00:03, 11.28it/s]Test-loop:  85%|████████▍ | 227/268 [00:20<00:03, 11.26it/s]Test-loop:  85%|████████▌ | 229/268 [00:20<00:03, 11.19it/s]Test-loop:  86%|████████▌ | 231/268 [00:20<00:03, 11.19it/s]Test-loop:  87%|████████▋ | 233/268 [00:21<00:03, 11.19it/s]Test-loop:  88%|████████▊ | 235/268 [00:21<00:02, 11.23it/s]Test-loop:  88%|████████▊ | 237/268 [00:21<00:02, 11.25it/s]Test-loop:  89%|████████▉ | 239/268 [00:21<00:02, 11.22it/s]Test-loop:  90%|████████▉ | 241/268 [00:21<00:02, 11.35it/s]Test-loop:  91%|█████████ | 243/268 [00:22<00:02, 11.54it/s]Test-loop:  91%|█████████▏| 245/268 [00:22<00:01, 11.58it/s]Test-loop:  92%|█████████▏| 247/268 [00:22<00:01, 11.49it/s]Test-loop:  93%|█████████▎| 249/268 [00:22<00:01, 11.38it/s]Test-loop:  94%|█████████▎| 251/268 [00:22<00:01, 11.36it/s]Test-loop:  94%|█████████▍| 253/268 [00:22<00:01, 11.30it/s]Test-loop:  95%|█████████▌| 255/268 [00:23<00:01, 11.24it/s]Test-loop:  96%|█████████▌| 257/268 [00:23<00:00, 11.32it/s]Test-loop:  97%|█████████▋| 259/268 [00:23<00:00, 11.33it/s]Test-loop:  97%|█████████▋| 261/268 [00:23<00:00, 11.35it/s]Test-loop:  98%|█████████▊| 263/268 [00:23<00:00, 11.28it/s]Test-loop:  99%|█████████▉| 265/268 [00:23<00:00, 11.24it/s]Test-loop: 100%|█████████▉| 267/268 [00:24<00:00, 11.05it/s]Test-loop: 100%|██████████| 268/268 [00:24<00:00, 11.03it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:20,  1.33it/s]Test-loop:   1%|          | 3/268 [00:01<01:17,  3.40it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:55,  4.72it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:46,  5.66it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:42,  6.14it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:40,  6.42it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:38,  6.66it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:37,  6.77it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:36,  6.89it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:35,  6.98it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:34,  7.17it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:33,  7.26it/s]Test-loop:   9%|▉         | 25/268 [00:04<00:32,  7.43it/s]Test-loop:  10%|█         | 27/268 [00:04<00:31,  7.56it/s]Test-loop:  11%|█         | 29/268 [00:04<00:31,  7.62it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:31,  7.58it/s]Test-loop:  12%|█▏        | 33/268 [00:05<00:31,  7.58it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:30,  7.58it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.72it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:29,  7.76it/s]Test-loop:  15%|█▌        | 41/268 [00:06<00:29,  7.77it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:29,  7.59it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:28,  7.74it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:29,  7.62it/s]Test-loop:  18%|█▊        | 49/268 [00:07<00:29,  7.42it/s]Test-loop:  19%|█▉        | 51/268 [00:07<00:28,  7.54it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:29,  7.32it/s]Test-loop:  21%|██        | 55/268 [00:07<00:28,  7.42it/s]Test-loop:  21%|██▏       | 57/268 [00:08<00:27,  7.55it/s]Test-loop:  22%|██▏       | 59/268 [00:08<00:27,  7.52it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:26,  7.71it/s]Test-loop:  24%|██▎       | 63/268 [00:09<00:26,  7.65it/s]Test-loop:  24%|██▍       | 65/268 [00:09<00:26,  7.71it/s]Test-loop:  25%|██▌       | 67/268 [00:09<00:26,  7.65it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:26,  7.63it/s]Test-loop:  26%|██▋       | 71/268 [00:10<00:25,  7.70it/s]Test-loop:  27%|██▋       | 73/268 [00:10<00:25,  7.66it/s]Test-loop:  28%|██▊       | 75/268 [00:10<00:25,  7.58it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:25,  7.46it/s]Test-loop:  29%|██▉       | 79/268 [00:11<00:24,  7.59it/s]Test-loop:  30%|███       | 81/268 [00:11<00:24,  7.59it/s]Test-loop:  31%|███       | 83/268 [00:11<00:24,  7.70it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:23,  7.91it/s]Test-loop:  32%|███▏      | 87/268 [00:12<00:23,  7.84it/s]Test-loop:  33%|███▎      | 89/268 [00:12<00:23,  7.68it/s]Test-loop:  34%|███▍      | 91/268 [00:12<00:23,  7.57it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:22,  7.65it/s]Test-loop:  35%|███▌      | 95/268 [00:13<00:22,  7.73it/s]Test-loop:  36%|███▌      | 97/268 [00:13<00:22,  7.73it/s]Test-loop:  37%|███▋      | 99/268 [00:13<00:21,  7.72it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:21,  7.74it/s]Test-loop:  38%|███▊      | 103/268 [00:14<00:21,  7.69it/s]Test-loop:  39%|███▉      | 105/268 [00:14<00:21,  7.62it/s]Test-loop:  40%|███▉      | 107/268 [00:14<00:20,  7.74it/s]Test-loop:  41%|████      | 109/268 [00:14<00:20,  7.81it/s]Test-loop:  41%|████▏     | 111/268 [00:15<00:20,  7.75it/s]Test-loop:  42%|████▏     | 113/268 [00:15<00:20,  7.72it/s]Test-loop:  43%|████▎     | 115/268 [00:15<00:19,  7.93it/s]Test-loop:  43%|████▎     | 116/268 [00:15<00:18,  8.14it/s]Test-loop:  44%|████▎     | 117/268 [00:16<00:19,  7.59it/s]Test-loop:  44%|████▍     | 119/268 [00:16<00:20,  7.38it/s]Test-loop:  45%|████▌     | 121/268 [00:16<00:19,  7.42it/s]Test-loop:  46%|████▌     | 123/268 [00:16<00:18,  7.73it/s]Test-loop:  47%|████▋     | 125/268 [00:17<00:18,  7.65it/s]Test-loop:  47%|████▋     | 127/268 [00:17<00:18,  7.58it/s]Test-loop:  48%|████▊     | 129/268 [00:17<00:18,  7.69it/s]Test-loop:  49%|████▉     | 131/268 [00:17<00:17,  7.78it/s]Test-loop:  50%|████▉     | 133/268 [00:18<00:17,  7.76it/s]Test-loop:  50%|█████     | 135/268 [00:18<00:17,  7.80it/s]Test-loop:  51%|█████     | 137/268 [00:18<00:17,  7.65it/s]Test-loop:  52%|█████▏    | 139/268 [00:18<00:17,  7.58it/s]Test-loop:  53%|█████▎    | 141/268 [00:19<00:16,  7.52it/s]Test-loop:  53%|█████▎    | 143/268 [00:19<00:16,  7.56it/s]Test-loop:  54%|█████▍    | 145/268 [00:19<00:15,  7.71it/s]Test-loop:  55%|█████▍    | 147/268 [00:19<00:15,  7.72it/s]Test-loop:  56%|█████▌    | 149/268 [00:20<00:15,  7.70it/s]Test-loop:  56%|█████▋    | 151/268 [00:20<00:15,  7.57it/s]Test-loop:  57%|█████▋    | 153/268 [00:20<00:14,  7.68it/s]Test-loop:  58%|█████▊    | 155/268 [00:20<00:14,  7.78it/s]Test-loop:  59%|█████▊    | 157/268 [00:21<00:14,  7.83it/s]Test-loop:  59%|█████▉    | 159/268 [00:21<00:13,  7.83it/s]Test-loop:  60%|██████    | 161/268 [00:21<00:13,  7.77it/s]Test-loop:  61%|██████    | 163/268 [00:22<00:13,  7.68it/s]Test-loop:  62%|██████▏   | 165/268 [00:22<00:13,  7.55it/s]Test-loop:  62%|██████▏   | 167/268 [00:22<00:15,  6.73it/s]Test-loop:  63%|██████▎   | 169/268 [00:22<00:14,  6.84it/s]Test-loop:  64%|██████▍   | 171/268 [00:23<00:13,  7.17it/s]Test-loop:  65%|██████▍   | 173/268 [00:23<00:12,  7.53it/s]Test-loop:  65%|██████▌   | 175/268 [00:23<00:12,  7.62it/s]Test-loop:  66%|██████▌   | 177/268 [00:23<00:11,  7.70it/s]Test-loop:  67%|██████▋   | 179/268 [00:24<00:11,  7.76it/s]Test-loop:  68%|██████▊   | 181/268 [00:24<00:11,  7.86it/s]Test-loop:  68%|██████▊   | 183/268 [00:24<00:10,  7.81it/s]Test-loop:  69%|██████▉   | 185/268 [00:24<00:10,  7.86it/s]Test-loop:  70%|██████▉   | 187/268 [00:25<00:10,  8.08it/s]Test-loop:  71%|███████   | 189/268 [00:25<00:09,  8.11it/s]Test-loop:  71%|███████▏  | 191/268 [00:25<00:09,  8.07it/s]Test-loop:  72%|███████▏  | 193/268 [00:25<00:09,  8.08it/s]Test-loop:  73%|███████▎  | 195/268 [00:26<00:09,  7.93it/s]Test-loop:  74%|███████▎  | 197/268 [00:26<00:09,  7.83it/s]Test-loop:  74%|███████▍  | 199/268 [00:26<00:08,  7.99it/s]Test-loop:  75%|███████▌  | 201/268 [00:26<00:08,  8.18it/s]Test-loop:  76%|███████▌  | 203/268 [00:27<00:07,  8.26it/s]Test-loop:  76%|███████▋  | 205/268 [00:27<00:07,  8.36it/s]Test-loop:  77%|███████▋  | 207/268 [00:27<00:07,  8.57it/s]Test-loop:  78%|███████▊  | 209/268 [00:27<00:06,  8.66it/s]Test-loop:  79%|███████▊  | 211/268 [00:28<00:06,  8.48it/s]Test-loop:  79%|███████▉  | 213/268 [00:28<00:06,  8.62it/s]Test-loop:  80%|████████  | 215/268 [00:28<00:06,  8.32it/s]Test-loop:  81%|████████  | 217/268 [00:28<00:06,  8.27it/s]Test-loop:  82%|████████▏ | 219/268 [00:29<00:06,  8.14it/s]Test-loop:  82%|████████▏ | 221/268 [00:29<00:05,  7.97it/s]Test-loop:  83%|████████▎ | 223/268 [00:29<00:05,  8.01it/s]Test-loop:  84%|████████▍ | 225/268 [00:29<00:05,  8.00it/s]Test-loop:  85%|████████▍ | 227/268 [00:30<00:05,  7.95it/s]Test-loop:  85%|████████▌ | 229/268 [00:30<00:04,  8.06it/s]Test-loop:  86%|████████▌ | 231/268 [00:30<00:04,  8.02it/s]Test-loop:  87%|████████▋ | 233/268 [00:30<00:04,  7.97it/s]Test-loop:  88%|████████▊ | 235/268 [00:31<00:04,  7.98it/s]Test-loop:  88%|████████▊ | 237/268 [00:31<00:03,  8.00it/s]Test-loop:  89%|████████▉ | 239/268 [00:31<00:03,  7.97it/s]Test-loop:  90%|████████▉ | 241/268 [00:31<00:03,  8.22it/s]Test-loop:  91%|█████████ | 243/268 [00:32<00:03,  8.22it/s]Test-loop:  91%|█████████▏| 245/268 [00:32<00:02,  8.15it/s]Test-loop:  92%|█████████▏| 247/268 [00:32<00:02,  8.04it/s]Test-loop:  93%|█████████▎| 249/268 [00:32<00:02,  8.08it/s]Test-loop:  94%|█████████▎| 251/268 [00:33<00:02,  8.07it/s]Test-loop:  94%|█████████▍| 253/268 [00:33<00:01,  8.11it/s]Test-loop:  95%|█████████▌| 255/268 [00:33<00:01,  7.96it/s]Test-loop:  96%|█████████▌| 257/268 [00:33<00:01,  8.05it/s]Test-loop:  97%|█████████▋| 259/268 [00:34<00:01,  8.07it/s]Test-loop:  97%|█████████▋| 261/268 [00:34<00:00,  8.05it/s]Test-loop:  98%|█████████▊| 263/268 [00:34<00:00,  8.07it/s]Test-loop:  99%|█████████▉| 265/268 [00:34<00:00,  8.04it/s]Test-loop: 100%|█████████▉| 267/268 [00:35<00:00,  7.91it/s]Test-loop: 100%|██████████| 268/268 [00:35<00:00,  7.62it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:   5%|▍         | 836/17100 [00:00<00:01, 8354.73it/s]Loading Data:  10%|▉         | 1677/17100 [00:00<00:01, 8385.72it/s]Loading Data:  15%|█▍        | 2525/17100 [00:00<00:01, 8424.57it/s]Loading Data:  20%|█▉        | 3372/17100 [00:00<00:01, 8438.80it/s]Loading Data:  25%|██▍       | 4216/17100 [00:00<00:01, 8422.04it/s]Loading Data:  30%|██▉       | 5059/17100 [00:00<00:01, 8378.01it/s]Loading Data:  34%|███▍      | 5899/17100 [00:00<00:01, 8382.62it/s]Loading Data:  39%|███▉      | 6738/17100 [00:00<00:01, 8383.08it/s]Loading Data:  44%|████▍     | 7578/17100 [00:00<00:01, 8388.25it/s]Loading Data:  49%|████▉     | 8418/17100 [00:01<00:01, 8389.23it/s]Loading Data:  54%|█████▍    | 9257/17100 [00:01<00:00, 8361.70it/s]Loading Data:  59%|█████▉    | 10094/17100 [00:01<00:00, 8360.45it/s]Loading Data:  64%|██████▍   | 10936/17100 [00:01<00:00, 8376.33it/s]Loading Data:  69%|██████▉   | 11776/17100 [00:01<00:00, 8380.50it/s]Loading Data:  74%|███████▍  | 12615/17100 [00:01<00:00, 8377.97it/s]Loading Data:  79%|███████▊  | 13460/17100 [00:01<00:00, 8397.75it/s]Loading Data:  84%|████████▎ | 14302/17100 [00:01<00:00, 8402.60it/s]Loading Data:  89%|████████▊ | 15143/17100 [00:01<00:00, 8396.10it/s]Loading Data:  93%|█████████▎| 15983/17100 [00:01<00:00, 8391.72it/s]Loading Data:  98%|█████████▊| 16823/17100 [00:02<00:00, 8393.38it/s]Loading Data: 100%|██████████| 17100/17100 [00:02<00:00, 8387.51it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data:  29%|██▉       | 836/2850 [00:00<00:00, 8349.76it/s]Loading Data:  59%|█████▊    | 1671/2850 [00:00<00:00, 8348.28it/s]Loading Data:  88%|████████▊ | 2508/2850 [00:00<00:00, 8356.43it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 8360.03it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:   5%|▍         | 826/17098 [00:00<00:01, 8251.84it/s]Loading Data:  10%|▉         | 1660/17098 [00:00<00:01, 8303.31it/s]Loading Data:  15%|█▍        | 2501/17098 [00:00<00:01, 8350.97it/s]Loading Data:  20%|█▉        | 3344/17098 [00:00<00:01, 8380.93it/s]Loading Data:  24%|██▍       | 4185/17098 [00:00<00:01, 8390.27it/s]Loading Data:  29%|██▉       | 5025/17098 [00:00<00:01, 8385.13it/s]Loading Data:  34%|███▍      | 5864/17098 [00:00<00:01, 8373.38it/s]Loading Data:  39%|███▉      | 6702/17098 [00:00<00:01, 8365.24it/s]Loading Data:  44%|████▍     | 7539/17098 [00:00<00:01, 8330.04it/s]Loading Data:  49%|████▉     | 8373/17098 [00:01<00:01, 8332.82it/s]Loading Data:  54%|█████▍    | 9208/17098 [00:01<00:00, 8336.90it/s]Loading Data:  59%|█████▊    | 10042/17098 [00:01<00:00, 8336.08it/s]Loading Data:  64%|██████▎   | 10879/17098 [00:01<00:00, 8344.36it/s]Loading Data:  69%|██████▊   | 11714/17098 [00:01<00:00, 8345.06it/s]Loading Data:  73%|███████▎  | 12551/17098 [00:01<00:00, 8351.09it/s]Loading Data:  78%|███████▊  | 13389/17098 [00:01<00:00, 8357.08it/s]Loading Data:  83%|████████▎ | 14225/17098 [00:01<00:00, 8353.15it/s]Loading Data:  88%|████████▊ | 15061/17098 [00:01<00:00, 8349.92it/s]Loading Data:  93%|█████████▎| 15902/17098 [00:01<00:00, 8365.27it/s]Loading Data:  98%|█████████▊| 16742/17098 [00:02<00:00, 8373.88it/s]Loading Data: 100%|██████████| 17098/17098 [00:02<00:00, 8355.31it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type               | Params
--------------------------------------------------
0 | model      | ResNet             | 23.5 M
1 | loss_func  | BCELoss            | 0     
2 | accu_func  | MultilabelAccuracy | 0     
3 | auroc_func | MultilabelAUROC    | 0     
--------------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.130    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:29,  1.51it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.23it/s]Test-loop:  11%|█         | 5/45 [00:01<00:06,  6.20it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  7.73it/s]Test-loop:  20%|██        | 9/45 [00:01<00:04,  8.84it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03,  9.71it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:03, 10.35it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 10.78it/s]Test-loop:  38%|███▊      | 17/45 [00:02<00:02, 11.07it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.33it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:02, 11.62it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 12.45it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.82it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 13.05it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 12.85it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 12.64it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.45it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.54it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 12.51it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.37it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.15it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 12.02it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 12.99it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.50it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:05,  1.44it/s]Test-loop:   1%|          | 3/268 [00:00<01:07,  3.90it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:45,  5.74it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:36,  7.08it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:32,  8.08it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:28,  8.87it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:26,  9.57it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:25,  9.98it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:24, 10.31it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:23, 10.62it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:22, 11.02it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:21, 11.17it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:21, 11.22it/s]Test-loop:  10%|█         | 27/268 [00:03<00:21, 11.33it/s]Test-loop:  11%|█         | 29/268 [00:03<00:21, 11.20it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:21, 11.19it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:20, 11.25it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:20, 11.18it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:20, 11.17it/s]Test-loop:  15%|█▍        | 39/268 [00:04<00:20, 11.08it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:20, 11.13it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:19, 11.36it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:19, 11.44it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:19, 11.44it/s]Test-loop:  18%|█▊        | 49/268 [00:05<00:19, 11.41it/s]Test-loop:  19%|█▉        | 51/268 [00:05<00:18, 11.43it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:18, 11.39it/s]Test-loop:  21%|██        | 55/268 [00:05<00:18, 11.31it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:18, 11.31it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:18, 11.38it/s]Test-loop:  23%|██▎       | 61/268 [00:06<00:18, 11.23it/s]Test-loop:  24%|██▎       | 63/268 [00:06<00:17, 11.40it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:17, 11.91it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:16, 12.29it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:15, 12.54it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:16, 12.18it/s]Test-loop:  27%|██▋       | 73/268 [00:07<00:16, 11.90it/s]Test-loop:  28%|██▊       | 75/268 [00:07<00:16, 11.65it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:16, 11.43it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:16, 11.39it/s]Test-loop:  30%|███       | 81/268 [00:07<00:16, 11.25it/s]Test-loop:  31%|███       | 83/268 [00:07<00:16, 11.07it/s]Test-loop:  32%|███▏      | 85/268 [00:08<00:16, 11.17it/s]Test-loop:  32%|███▏      | 87/268 [00:08<00:16, 11.19it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:16, 11.13it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:15, 11.67it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:14, 12.01it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:14, 12.21it/s]Test-loop:  36%|███▌      | 97/268 [00:09<00:14, 12.03it/s]Test-loop:  37%|███▋      | 99/268 [00:09<00:14, 11.86it/s]Test-loop:  38%|███▊      | 101/268 [00:09<00:14, 11.77it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:14, 11.59it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:13, 11.65it/s]Test-loop:  40%|███▉      | 107/268 [00:10<00:13, 11.58it/s]Test-loop:  41%|████      | 109/268 [00:10<00:13, 11.59it/s]Test-loop:  41%|████▏     | 111/268 [00:10<00:13, 11.62it/s]Test-loop:  42%|████▏     | 113/268 [00:10<00:13, 11.45it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:13, 11.50it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:13, 11.42it/s]Test-loop:  44%|████▍     | 119/268 [00:11<00:12, 11.47it/s]Test-loop:  45%|████▌     | 121/268 [00:11<00:12, 11.46it/s]Test-loop:  46%|████▌     | 123/268 [00:11<00:12, 11.54it/s]Test-loop:  47%|████▋     | 125/268 [00:11<00:12, 11.52it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:12, 11.51it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:12, 11.45it/s]Test-loop:  49%|████▉     | 131/268 [00:12<00:11, 11.52it/s]Test-loop:  50%|████▉     | 133/268 [00:12<00:11, 11.39it/s]Test-loop:  50%|█████     | 135/268 [00:12<00:11, 11.33it/s]Test-loop:  51%|█████     | 137/268 [00:12<00:11, 11.30it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:11, 11.35it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:11, 11.38it/s]Test-loop:  53%|█████▎    | 143/268 [00:13<00:10, 11.49it/s]Test-loop:  54%|█████▍    | 145/268 [00:13<00:10, 11.53it/s]Test-loop:  55%|█████▍    | 147/268 [00:13<00:10, 11.60it/s]Test-loop:  56%|█████▌    | 149/268 [00:13<00:10, 11.62it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:10, 11.54it/s]Test-loop:  57%|█████▋    | 153/268 [00:14<00:10, 11.46it/s]Test-loop:  58%|█████▊    | 155/268 [00:14<00:09, 11.62it/s]Test-loop:  59%|█████▊    | 157/268 [00:14<00:09, 11.73it/s]Test-loop:  59%|█████▉    | 159/268 [00:14<00:09, 11.79it/s]Test-loop:  60%|██████    | 161/268 [00:14<00:09, 11.87it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:08, 11.90it/s]Test-loop:  62%|██████▏   | 165/268 [00:15<00:08, 11.97it/s]Test-loop:  62%|██████▏   | 167/268 [00:15<00:08, 12.10it/s]Test-loop:  63%|██████▎   | 169/268 [00:15<00:08, 12.02it/s]Test-loop:  64%|██████▍   | 171/268 [00:15<00:08, 11.89it/s]Test-loop:  65%|██████▍   | 173/268 [00:15<00:08, 11.83it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:07, 11.79it/s]Test-loop:  66%|██████▌   | 177/268 [00:16<00:07, 11.93it/s]Test-loop:  67%|██████▋   | 179/268 [00:16<00:07, 11.83it/s]Test-loop:  68%|██████▊   | 181/268 [00:16<00:07, 11.93it/s]Test-loop:  68%|██████▊   | 183/268 [00:16<00:07, 11.80it/s]Test-loop:  69%|██████▉   | 185/268 [00:16<00:07, 11.76it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 11.66it/s]Test-loop:  71%|███████   | 189/268 [00:17<00:06, 11.61it/s]Test-loop:  71%|███████▏  | 191/268 [00:17<00:06, 11.61it/s]Test-loop:  72%|███████▏  | 193/268 [00:17<00:06, 11.53it/s]Test-loop:  73%|███████▎  | 195/268 [00:17<00:06, 11.59it/s]Test-loop:  74%|███████▎  | 197/268 [00:17<00:06, 11.47it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:06, 11.50it/s]Test-loop:  75%|███████▌  | 201/268 [00:18<00:05, 11.51it/s]Test-loop:  76%|███████▌  | 203/268 [00:18<00:05, 11.65it/s]Test-loop:  76%|███████▋  | 205/268 [00:18<00:05, 12.04it/s]Test-loop:  77%|███████▋  | 207/268 [00:18<00:04, 12.56it/s]Test-loop:  78%|███████▊  | 209/268 [00:18<00:04, 13.01it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 13.01it/s]Test-loop:  79%|███████▉  | 213/268 [00:19<00:04, 12.53it/s]Test-loop:  80%|████████  | 215/268 [00:19<00:04, 12.40it/s]Test-loop:  81%|████████  | 217/268 [00:19<00:04, 12.01it/s]Test-loop:  82%|████████▏ | 219/268 [00:19<00:04, 11.77it/s]Test-loop:  82%|████████▏ | 221/268 [00:19<00:03, 11.83it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 11.72it/s]Test-loop:  84%|████████▍ | 225/268 [00:20<00:03, 11.70it/s]Test-loop:  85%|████████▍ | 227/268 [00:20<00:03, 11.78it/s]Test-loop:  85%|████████▌ | 229/268 [00:20<00:03, 11.68it/s]Test-loop:  86%|████████▌ | 231/268 [00:20<00:03, 11.78it/s]Test-loop:  87%|████████▋ | 233/268 [00:20<00:02, 11.86it/s]Test-loop:  88%|████████▊ | 235/268 [00:20<00:02, 11.84it/s]Test-loop:  88%|████████▊ | 237/268 [00:21<00:02, 11.90it/s]Test-loop:  89%|████████▉ | 239/268 [00:21<00:02, 11.86it/s]Test-loop:  90%|████████▉ | 241/268 [00:21<00:02, 11.61it/s]Test-loop:  91%|█████████ | 243/268 [00:21<00:02, 11.63it/s]Test-loop:  91%|█████████▏| 245/268 [00:21<00:01, 11.56it/s]Test-loop:  92%|█████████▏| 247/268 [00:21<00:01, 11.62it/s]Test-loop:  93%|█████████▎| 249/268 [00:22<00:01, 11.64it/s]Test-loop:  94%|█████████▎| 251/268 [00:22<00:01, 11.54it/s]Test-loop:  94%|█████████▍| 253/268 [00:22<00:01, 11.63it/s]Test-loop:  95%|█████████▌| 255/268 [00:22<00:01, 11.59it/s]Test-loop:  96%|█████████▌| 257/268 [00:22<00:00, 11.58it/s]Test-loop:  97%|█████████▋| 259/268 [00:22<00:00, 11.72it/s]Test-loop:  97%|█████████▋| 261/268 [00:23<00:00, 12.07it/s]Test-loop:  98%|█████████▊| 263/268 [00:23<00:00, 12.45it/s]Test-loop:  99%|█████████▉| 265/268 [00:23<00:00, 12.40it/s]Test-loop: 100%|█████████▉| 267/268 [00:23<00:00, 12.17it/s]Test-loop: 100%|██████████| 268/268 [00:23<00:00, 11.30it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:23,  1.31it/s]Test-loop:   1%|          | 3/268 [00:01<01:19,  3.34it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:56,  4.67it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:46,  5.60it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:42,  6.15it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:39,  6.54it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:37,  6.81it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:36,  6.97it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:35,  7.07it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:34,  7.15it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:33,  7.33it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:33,  7.40it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:32,  7.59it/s]Test-loop:  10%|█         | 27/268 [00:04<00:31,  7.69it/s]Test-loop:  11%|█         | 29/268 [00:04<00:31,  7.69it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:31,  7.63it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:30,  7.73it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:30,  7.74it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:28,  8.04it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:28,  8.17it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:27,  8.17it/s]Test-loop:  16%|█▌        | 42/268 [00:06<00:27,  8.35it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:29,  7.74it/s]Test-loop:  16%|█▋        | 44/268 [00:06<00:27,  8.03it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:28,  7.86it/s]Test-loop:  17%|█▋        | 46/268 [00:06<00:29,  7.65it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:27,  8.08it/s]Test-loop:  18%|█▊        | 48/268 [00:06<00:28,  7.72it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:27,  8.03it/s]Test-loop:  19%|█▊        | 50/268 [00:07<00:27,  7.82it/s]Test-loop:  19%|█▉        | 51/268 [00:07<00:26,  8.16it/s]Test-loop:  19%|█▉        | 52/268 [00:07<00:28,  7.59it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:28,  7.59it/s]Test-loop:  20%|██        | 54/268 [00:07<00:28,  7.58it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.76it/s]Test-loop:  21%|██        | 56/268 [00:07<00:27,  7.67it/s]Test-loop:  21%|██▏       | 57/268 [00:08<00:26,  7.96it/s]Test-loop:  22%|██▏       | 58/268 [00:08<00:28,  7.34it/s]Test-loop:  22%|██▏       | 60/268 [00:08<00:27,  7.67it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:25,  8.06it/s]Test-loop:  23%|██▎       | 62/268 [00:08<00:26,  7.89it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:26,  7.88it/s]Test-loop:  24%|██▍       | 64/268 [00:08<00:26,  7.67it/s]Test-loop:  24%|██▍       | 65/268 [00:09<00:25,  8.01it/s]Test-loop:  25%|██▍       | 66/268 [00:09<00:27,  7.38it/s]Test-loop:  25%|██▌       | 67/268 [00:09<00:25,  7.96it/s]Test-loop:  25%|██▌       | 68/268 [00:09<00:27,  7.41it/s]Test-loop:  26%|██▌       | 70/268 [00:09<00:25,  7.63it/s]Test-loop:  27%|██▋       | 72/268 [00:09<00:25,  7.76it/s]Test-loop:  28%|██▊       | 74/268 [00:10<00:24,  7.89it/s]Test-loop:  28%|██▊       | 75/268 [00:10<00:23,  8.09it/s]Test-loop:  28%|██▊       | 76/268 [00:10<00:24,  7.70it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:24,  7.90it/s]Test-loop:  29%|██▉       | 78/268 [00:10<00:25,  7.55it/s]Test-loop:  30%|██▉       | 80/268 [00:10<00:24,  7.70it/s]Test-loop:  31%|███       | 82/268 [00:11<00:23,  7.92it/s]Test-loop:  31%|███       | 83/268 [00:11<00:22,  8.08it/s]Test-loop:  31%|███▏      | 84/268 [00:11<00:22,  8.14it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:22,  8.03it/s]Test-loop:  32%|███▏      | 86/268 [00:11<00:23,  7.74it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  7.97it/s]Test-loop:  33%|███▎      | 88/268 [00:11<00:23,  7.64it/s]Test-loop:  33%|███▎      | 89/268 [00:12<00:23,  7.72it/s]Test-loop:  34%|███▎      | 90/268 [00:12<00:24,  7.41it/s]Test-loop:  34%|███▍      | 91/268 [00:12<00:23,  7.65it/s]Test-loop:  34%|███▍      | 92/268 [00:12<00:24,  7.28it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:22,  7.77it/s]Test-loop:  35%|███▌      | 94/268 [00:12<00:23,  7.47it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.07it/s]Test-loop:  36%|███▌      | 96/268 [00:13<00:22,  7.51it/s]Test-loop:  36%|███▌      | 97/268 [00:13<00:21,  8.09it/s]Test-loop:  37%|███▋      | 98/268 [00:13<00:23,  7.22it/s]Test-loop:  37%|███▋      | 100/268 [00:13<00:22,  7.52it/s]Test-loop:  38%|███▊      | 102/268 [00:13<00:21,  7.63it/s]Test-loop:  39%|███▉      | 104/268 [00:14<00:20,  7.90it/s]Test-loop:  40%|███▉      | 106/268 [00:14<00:20,  7.84it/s]Test-loop:  40%|████      | 108/268 [00:14<00:20,  7.98it/s]Test-loop:  41%|████      | 110/268 [00:14<00:19,  8.04it/s]Test-loop:  42%|████▏     | 112/268 [00:15<00:19,  8.14it/s]Test-loop:  42%|████▏     | 113/268 [00:15<00:18,  8.33it/s]Test-loop:  43%|████▎     | 114/268 [00:15<00:19,  7.71it/s]Test-loop:  43%|████▎     | 116/268 [00:15<00:19,  7.80it/s]Test-loop:  44%|████▍     | 118/268 [00:15<00:19,  7.84it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:18,  8.06it/s]Test-loop:  45%|████▍     | 120/268 [00:16<00:18,  7.93it/s]Test-loop:  45%|████▌     | 121/268 [00:16<00:18,  7.89it/s]Test-loop:  46%|████▌     | 122/268 [00:16<00:18,  7.77it/s]Test-loop:  46%|████▌     | 123/268 [00:16<00:17,  8.06it/s]Test-loop:  46%|████▋     | 124/268 [00:16<00:18,  7.62it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:18,  7.72it/s]Test-loop:  47%|████▋     | 126/268 [00:16<00:18,  7.70it/s]Test-loop:  47%|████▋     | 127/268 [00:17<00:18,  7.57it/s]Test-loop:  48%|████▊     | 128/268 [00:17<00:17,  7.91it/s]Test-loop:  48%|████▊     | 129/268 [00:17<00:17,  7.78it/s]Test-loop:  49%|████▊     | 130/268 [00:17<00:17,  7.73it/s]Test-loop:  49%|████▉     | 131/268 [00:17<00:16,  8.18it/s]Test-loop:  49%|████▉     | 132/268 [00:17<00:17,  7.78it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.28it/s]Test-loop:  50%|█████     | 134/268 [00:17<00:17,  7.71it/s]Test-loop:  51%|█████     | 136/268 [00:18<00:17,  7.69it/s]Test-loop:  51%|█████▏    | 138/268 [00:18<00:16,  7.98it/s]Test-loop:  52%|█████▏    | 139/268 [00:18<00:15,  8.29it/s]Test-loop:  52%|█████▏    | 140/268 [00:18<00:15,  8.22it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:15,  8.31it/s]Test-loop:  53%|█████▎    | 142/268 [00:18<00:14,  8.47it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:14,  8.49it/s]Test-loop:  54%|█████▎    | 144/268 [00:19<00:15,  8.22it/s]Test-loop:  54%|█████▍    | 146/268 [00:19<00:14,  8.38it/s]Test-loop:  55%|█████▍    | 147/268 [00:19<00:13,  8.65it/s]Test-loop:  55%|█████▌    | 148/268 [00:19<00:14,  8.18it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:13,  8.55it/s]Test-loop:  56%|█████▌    | 150/268 [00:19<00:14,  8.19it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  8.27it/s]Test-loop:  57%|█████▋    | 152/268 [00:20<00:14,  8.06it/s]Test-loop:  57%|█████▋    | 153/268 [00:20<00:13,  8.29it/s]Test-loop:  57%|█████▋    | 154/268 [00:20<00:13,  8.16it/s]Test-loop:  58%|█████▊    | 155/268 [00:20<00:13,  8.53it/s]Test-loop:  58%|█████▊    | 156/268 [00:20<00:14,  7.60it/s]Test-loop:  59%|█████▉    | 158/268 [00:20<00:14,  7.84it/s]Test-loop:  60%|█████▉    | 160/268 [00:21<00:13,  7.78it/s]Test-loop:  60%|██████    | 162/268 [00:21<00:13,  7.91it/s]Test-loop:  61%|██████    | 164/268 [00:21<00:13,  7.95it/s]Test-loop:  62%|██████▏   | 166/268 [00:21<00:12,  7.98it/s]Test-loop:  63%|██████▎   | 168/268 [00:22<00:12,  8.03it/s]Test-loop:  63%|██████▎   | 169/268 [00:22<00:12,  7.96it/s]Test-loop:  63%|██████▎   | 170/268 [00:22<00:12,  7.91it/s]Test-loop:  64%|██████▍   | 171/268 [00:22<00:12,  7.92it/s]Test-loop:  64%|██████▍   | 172/268 [00:22<00:12,  7.89it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:11,  8.05it/s]Test-loop:  65%|██████▍   | 174/268 [00:22<00:11,  8.20it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  7.88it/s]Test-loop:  66%|██████▌   | 176/268 [00:23<00:11,  8.02it/s]Test-loop:  66%|██████▌   | 177/268 [00:23<00:11,  7.96it/s]Test-loop:  66%|██████▋   | 178/268 [00:23<00:11,  7.98it/s]Test-loop:  67%|██████▋   | 179/268 [00:23<00:11,  7.92it/s]Test-loop:  67%|██████▋   | 180/268 [00:23<00:11,  7.96it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:10,  8.03it/s]Test-loop:  68%|██████▊   | 182/268 [00:23<00:10,  8.12it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  7.80it/s]Test-loop:  69%|██████▊   | 184/268 [00:24<00:10,  8.14it/s]Test-loop:  69%|██████▉   | 185/268 [00:24<00:10,  7.85it/s]Test-loop:  69%|██████▉   | 186/268 [00:24<00:10,  7.97it/s]Test-loop:  70%|██████▉   | 187/268 [00:24<00:09,  8.41it/s]Test-loop:  70%|███████   | 188/268 [00:24<00:10,  7.70it/s]Test-loop:  71%|███████   | 190/268 [00:24<00:09,  7.92it/s]Test-loop:  72%|███████▏  | 192/268 [00:25<00:09,  8.04it/s]Test-loop:  72%|███████▏  | 194/268 [00:25<00:09,  8.10it/s]Test-loop:  73%|███████▎  | 195/268 [00:25<00:08,  8.39it/s]Test-loop:  73%|███████▎  | 196/268 [00:25<00:08,  8.16it/s]Test-loop:  74%|███████▎  | 197/268 [00:25<00:08,  8.15it/s]Test-loop:  74%|███████▍  | 198/268 [00:25<00:08,  8.32it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  8.38it/s]Test-loop:  75%|███████▍  | 200/268 [00:26<00:08,  8.15it/s]Test-loop:  75%|███████▌  | 201/268 [00:26<00:07,  8.60it/s]Test-loop:  75%|███████▌  | 202/268 [00:26<00:08,  8.06it/s]Test-loop:  76%|███████▌  | 204/268 [00:26<00:07,  8.00it/s]Test-loop:  77%|███████▋  | 206/268 [00:26<00:07,  8.36it/s]Test-loop:  78%|███████▊  | 208/268 [00:26<00:07,  8.23it/s]Test-loop:  78%|███████▊  | 210/268 [00:27<00:07,  8.14it/s]Test-loop:  79%|███████▉  | 212/268 [00:27<00:06,  8.16it/s]Test-loop:  80%|███████▉  | 214/268 [00:27<00:06,  7.97it/s]Test-loop:  81%|████████  | 216/268 [00:27<00:06,  8.06it/s]Test-loop:  81%|████████▏ | 218/268 [00:28<00:06,  7.90it/s]Test-loop:  82%|████████▏ | 220/268 [00:28<00:05,  8.21it/s]Test-loop:  83%|████████▎ | 222/268 [00:28<00:05,  8.16it/s]Test-loop:  84%|████████▎ | 224/268 [00:28<00:05,  8.06it/s]Test-loop:  84%|████████▍ | 226/268 [00:29<00:05,  7.89it/s]Test-loop:  85%|████████▌ | 228/268 [00:29<00:04,  8.14it/s]Test-loop:  86%|████████▌ | 230/268 [00:29<00:04,  8.02it/s]Test-loop:  87%|████████▋ | 232/268 [00:29<00:04,  8.19it/s]Test-loop:  87%|████████▋ | 234/268 [00:30<00:04,  7.94it/s]Test-loop:  88%|████████▊ | 236/268 [00:30<00:03,  8.06it/s]Test-loop:  89%|████████▉ | 238/268 [00:30<00:03,  8.38it/s]Test-loop:  90%|████████▉ | 240/268 [00:30<00:03,  8.38it/s]Test-loop:  90%|█████████ | 242/268 [00:31<00:03,  8.23it/s]Test-loop:  91%|█████████ | 244/268 [00:31<00:02,  8.23it/s]Test-loop:  92%|█████████▏| 246/268 [00:31<00:02,  8.19it/s]Test-loop:  93%|█████████▎| 248/268 [00:31<00:02,  8.09it/s]Test-loop:  93%|█████████▎| 250/268 [00:32<00:02,  8.22it/s]Test-loop:  94%|█████████▍| 252/268 [00:32<00:01,  8.18it/s]Test-loop:  95%|█████████▍| 254/268 [00:32<00:01,  8.11it/s]Test-loop:  96%|█████████▌| 256/268 [00:32<00:01,  8.07it/s]Test-loop:  96%|█████████▋| 258/268 [00:33<00:01,  8.06it/s]Test-loop:  97%|█████████▋| 260/268 [00:33<00:00,  8.11it/s]Test-loop:  98%|█████████▊| 262/268 [00:33<00:00,  8.30it/s]Test-loop:  99%|█████████▊| 264/268 [00:33<00:00,  8.17it/s]Test-loop:  99%|█████████▉| 266/268 [00:34<00:00,  8.11it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  9.56it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  7.81it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:   5%|▍         | 827/17100 [00:00<00:01, 8265.67it/s]Loading Data:  10%|▉         | 1664/17100 [00:00<00:01, 8326.68it/s]Loading Data:  15%|█▍        | 2501/17100 [00:00<00:01, 8345.52it/s]Loading Data:  20%|█▉        | 3338/17100 [00:00<00:01, 8351.87it/s]Loading Data:  24%|██▍       | 4176/17100 [00:00<00:01, 8360.64it/s]Loading Data:  29%|██▉       | 5013/17100 [00:00<00:01, 8357.32it/s]Loading Data:  34%|███▍      | 5849/17100 [00:00<00:01, 8342.13it/s]Loading Data:  39%|███▉      | 6684/17100 [00:00<00:01, 8340.87it/s]Loading Data:  44%|████▍     | 7519/17100 [00:00<00:01, 8338.18it/s]Loading Data:  49%|████▉     | 8353/17100 [00:01<00:01, 8333.99it/s]Loading Data:  54%|█████▎    | 9187/17100 [00:01<00:00, 8318.26it/s]Loading Data:  59%|█████▊    | 10027/17100 [00:01<00:00, 8340.35it/s]Loading Data:  64%|██████▎   | 10867/17100 [00:01<00:00, 8355.55it/s]Loading Data:  68%|██████▊   | 11703/17100 [00:01<00:00, 8355.75it/s]Loading Data:  73%|███████▎  | 12539/17100 [00:01<00:00, 8344.94it/s]Loading Data:  78%|███████▊  | 13374/17100 [00:01<00:00, 8346.09it/s]Loading Data:  83%|████████▎ | 14211/17100 [00:01<00:00, 8352.29it/s]Loading Data:  88%|████████▊ | 15047/17100 [00:01<00:00, 8352.02it/s]Loading Data:  93%|█████████▎| 15883/17100 [00:01<00:00, 8330.25it/s]Loading Data:  98%|█████████▊| 16717/17100 [00:02<00:00, 8324.77it/s]Loading Data: 100%|██████████| 17100/17100 [00:02<00:00, 8334.07it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data:  29%|██▉       | 831/2850 [00:00<00:00, 8308.60it/s]Loading Data:  59%|█████▊    | 1668/2850 [00:00<00:00, 8342.98it/s]Loading Data:  88%|████████▊ | 2504/2850 [00:00<00:00, 8348.88it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 8348.54it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:   5%|▍         | 828/17098 [00:00<00:01, 8278.74it/s]Loading Data:  10%|▉         | 1669/17098 [00:00<00:01, 8351.05it/s]Loading Data:  15%|█▍        | 2509/17098 [00:00<00:01, 8370.71it/s]Loading Data:  20%|█▉        | 3349/17098 [00:00<00:01, 8381.50it/s]Loading Data:  24%|██▍       | 4188/17098 [00:00<00:01, 8383.97it/s]Loading Data:  29%|██▉       | 5027/17098 [00:00<00:01, 8383.08it/s]Loading Data:  34%|███▍      | 5866/17098 [00:00<00:01, 8371.91it/s]Loading Data:  39%|███▉      | 6704/17098 [00:00<00:01, 8363.01it/s]Loading Data:  44%|████▍     | 7544/17098 [00:00<00:01, 8371.99it/s]Loading Data:  49%|████▉     | 8382/17098 [00:01<00:01, 8352.73it/s]Loading Data:  54%|█████▍    | 9218/17098 [00:01<00:00, 8351.73it/s]Loading Data:  59%|█████▉    | 10058/17098 [00:01<00:00, 8366.15it/s]Loading Data:  64%|██████▎   | 10897/17098 [00:01<00:00, 8370.97it/s]Loading Data:  69%|██████▊   | 11735/17098 [00:01<00:00, 8372.10it/s]Loading Data:  74%|███████▎  | 12573/17098 [00:01<00:00, 8368.49it/s]Loading Data:  78%|███████▊  | 13411/17098 [00:01<00:00, 8371.18it/s]Loading Data:  83%|████████▎ | 14249/17098 [00:01<00:00, 8354.29it/s]Loading Data:  88%|████████▊ | 15085/17098 [00:01<00:00, 8328.30it/s]Loading Data:  93%|█████████▎| 15921/17098 [00:01<00:00, 8337.25it/s]Loading Data:  98%|█████████▊| 16758/17098 [00:02<00:00, 8346.99it/s]Loading Data: 100%|██████████| 17098/17098 [00:02<00:00, 8359.67it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type               | Params
--------------------------------------------------
0 | model      | ResNet             | 23.5 M
1 | loss_func  | BCELoss            | 0     
2 | accu_func  | MultilabelAccuracy | 0     
3 | auroc_func | MultilabelAUROC    | 0     
--------------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.130    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:30,  1.45it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:10,  4.09it/s]Test-loop:  11%|█         | 5/45 [00:01<00:06,  6.04it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  7.66it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.11it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.31it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 11.30it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.85it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 11.90it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.99it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 12.06it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 12.13it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.24it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 12.17it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 12.03it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 12.00it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.18it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.01it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 12.03it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.02it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.05it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 12.02it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 12.99it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.47it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:04,  1.45it/s]Test-loop:   1%|          | 3/268 [00:00<01:06,  3.98it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:44,  5.86it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:36,  7.22it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:31,  8.26it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:28,  9.05it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:26,  9.54it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:25, 10.03it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:24, 10.44it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:23, 10.73it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:22, 10.88it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:22, 11.04it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:21, 11.21it/s]Test-loop:  10%|█         | 27/268 [00:03<00:21, 11.29it/s]Test-loop:  11%|█         | 29/268 [00:03<00:21, 11.23it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:20, 11.38it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:20, 11.44it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:20, 11.42it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:20, 11.45it/s]Test-loop:  15%|█▍        | 39/268 [00:04<00:20, 11.42it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:20, 11.34it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:19, 11.43it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:19, 11.54it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:18, 11.64it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:18, 11.74it/s]Test-loop:  19%|█▉        | 51/268 [00:05<00:18, 11.61it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:18, 11.50it/s]Test-loop:  21%|██        | 55/268 [00:05<00:18, 11.56it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:18, 11.57it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:18, 11.58it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:17, 11.68it/s]Test-loop:  24%|██▎       | 63/268 [00:06<00:17, 11.72it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:17, 11.66it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:17, 11.62it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:17, 11.41it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:17, 11.36it/s]Test-loop:  27%|██▋       | 73/268 [00:07<00:17, 11.21it/s]Test-loop:  28%|██▊       | 75/268 [00:07<00:17, 11.08it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:17, 11.14it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:17, 11.10it/s]Test-loop:  30%|███       | 81/268 [00:07<00:16, 11.21it/s]Test-loop:  31%|███       | 83/268 [00:07<00:16, 11.19it/s]Test-loop:  32%|███▏      | 85/268 [00:08<00:16, 11.06it/s]Test-loop:  32%|███▏      | 87/268 [00:08<00:16, 11.12it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:16, 11.14it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:15, 11.23it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:15, 11.58it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:14, 11.98it/s]Test-loop:  36%|███▌      | 97/268 [00:09<00:13, 12.36it/s]Test-loop:  37%|███▋      | 99/268 [00:09<00:13, 12.30it/s]Test-loop:  38%|███▊      | 101/268 [00:09<00:14, 11.92it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:13, 11.82it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:13, 11.82it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:13, 11.75it/s]Test-loop:  41%|████      | 109/268 [00:10<00:13, 11.63it/s]Test-loop:  41%|████▏     | 111/268 [00:10<00:13, 11.65it/s]Test-loop:  42%|████▏     | 113/268 [00:10<00:13, 11.48it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:13, 11.41it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:13, 11.55it/s]Test-loop:  44%|████▍     | 119/268 [00:11<00:12, 11.63it/s]Test-loop:  45%|████▌     | 121/268 [00:11<00:12, 11.68it/s]Test-loop:  46%|████▌     | 123/268 [00:11<00:12, 11.62it/s]Test-loop:  47%|████▋     | 125/268 [00:11<00:12, 11.83it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 11.94it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 11.84it/s]Test-loop:  49%|████▉     | 131/268 [00:12<00:11, 11.79it/s]Test-loop:  50%|████▉     | 133/268 [00:12<00:11, 11.85it/s]Test-loop:  50%|█████     | 135/268 [00:12<00:11, 11.68it/s]Test-loop:  51%|█████     | 137/268 [00:12<00:11, 11.65it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:11, 11.64it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:10, 11.71it/s]Test-loop:  53%|█████▎    | 143/268 [00:13<00:10, 11.68it/s]Test-loop:  54%|█████▍    | 145/268 [00:13<00:10, 11.69it/s]Test-loop:  55%|█████▍    | 147/268 [00:13<00:10, 11.67it/s]Test-loop:  56%|█████▌    | 149/268 [00:13<00:10, 11.64it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:10, 11.57it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 11.62it/s]Test-loop:  58%|█████▊    | 155/268 [00:14<00:09, 11.64it/s]Test-loop:  59%|█████▊    | 157/268 [00:14<00:09, 11.63it/s]Test-loop:  59%|█████▉    | 159/268 [00:14<00:09, 11.67it/s]Test-loop:  60%|██████    | 161/268 [00:14<00:09, 11.72it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:08, 11.74it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 11.56it/s]Test-loop:  62%|██████▏   | 167/268 [00:15<00:08, 11.52it/s]Test-loop:  63%|██████▎   | 169/268 [00:15<00:08, 11.59it/s]Test-loop:  64%|██████▍   | 171/268 [00:15<00:08, 11.65it/s]Test-loop:  65%|██████▍   | 173/268 [00:15<00:08, 11.59it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:08, 11.59it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 11.57it/s]Test-loop:  67%|██████▋   | 179/268 [00:16<00:07, 11.43it/s]Test-loop:  68%|██████▊   | 181/268 [00:16<00:07, 11.49it/s]Test-loop:  68%|██████▊   | 183/268 [00:16<00:07, 11.58it/s]Test-loop:  69%|██████▉   | 185/268 [00:16<00:07, 11.53it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 11.66it/s]Test-loop:  71%|███████   | 189/268 [00:17<00:06, 11.55it/s]Test-loop:  71%|███████▏  | 191/268 [00:17<00:06, 11.57it/s]Test-loop:  72%|███████▏  | 193/268 [00:17<00:06, 11.70it/s]Test-loop:  73%|███████▎  | 195/268 [00:17<00:06, 11.84it/s]Test-loop:  74%|███████▎  | 197/268 [00:17<00:05, 12.04it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:05, 11.79it/s]Test-loop:  75%|███████▌  | 201/268 [00:18<00:05, 11.78it/s]Test-loop:  76%|███████▌  | 203/268 [00:18<00:05, 11.78it/s]Test-loop:  76%|███████▋  | 205/268 [00:18<00:05, 11.77it/s]Test-loop:  77%|███████▋  | 207/268 [00:18<00:05, 11.79it/s]Test-loop:  78%|███████▊  | 209/268 [00:18<00:04, 11.85it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 11.67it/s]Test-loop:  79%|███████▉  | 213/268 [00:19<00:04, 11.61it/s]Test-loop:  80%|████████  | 215/268 [00:19<00:04, 11.72it/s]Test-loop:  81%|████████  | 217/268 [00:19<00:04, 11.59it/s]Test-loop:  82%|████████▏ | 219/268 [00:19<00:04, 11.66it/s]Test-loop:  82%|████████▏ | 221/268 [00:19<00:04, 11.67it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 11.70it/s]Test-loop:  84%|████████▍ | 225/268 [00:20<00:03, 11.73it/s]Test-loop:  85%|████████▍ | 227/268 [00:20<00:03, 11.60it/s]Test-loop:  85%|████████▌ | 229/268 [00:20<00:03, 11.79it/s]Test-loop:  86%|████████▌ | 231/268 [00:20<00:03, 12.20it/s]Test-loop:  87%|████████▋ | 233/268 [00:20<00:02, 12.58it/s]Test-loop:  88%|████████▊ | 235/268 [00:20<00:02, 12.89it/s]Test-loop:  88%|████████▊ | 237/268 [00:21<00:02, 12.66it/s]Test-loop:  89%|████████▉ | 239/268 [00:21<00:02, 12.50it/s]Test-loop:  90%|████████▉ | 241/268 [00:21<00:02, 12.14it/s]Test-loop:  91%|█████████ | 243/268 [00:21<00:02, 11.94it/s]Test-loop:  91%|█████████▏| 245/268 [00:21<00:01, 11.91it/s]Test-loop:  92%|█████████▏| 247/268 [00:21<00:01, 11.82it/s]Test-loop:  93%|█████████▎| 249/268 [00:22<00:01, 11.70it/s]Test-loop:  94%|█████████▎| 251/268 [00:22<00:01, 11.73it/s]Test-loop:  94%|█████████▍| 253/268 [00:22<00:01, 11.62it/s]Test-loop:  95%|█████████▌| 255/268 [00:22<00:01, 11.77it/s]Test-loop:  96%|█████████▌| 257/268 [00:22<00:00, 12.07it/s]Test-loop:  97%|█████████▋| 259/268 [00:22<00:00, 11.97it/s]Test-loop:  97%|█████████▋| 261/268 [00:23<00:00, 11.96it/s]Test-loop:  98%|█████████▊| 263/268 [00:23<00:00, 11.94it/s]Test-loop:  99%|█████████▉| 265/268 [00:23<00:00, 12.00it/s]Test-loop: 100%|█████████▉| 267/268 [00:23<00:00, 11.94it/s]Test-loop: 100%|██████████| 268/268 [00:23<00:00, 11.31it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:25,  1.30it/s]Test-loop:   1%|          | 3/268 [00:01<01:19,  3.35it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:55,  4.74it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:45,  5.69it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:41,  6.24it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:38,  6.61it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:37,  6.89it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:35,  7.08it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:34,  7.23it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:33,  7.33it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:33,  7.38it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:32,  7.49it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:31,  7.65it/s]Test-loop:  10%|█         | 27/268 [00:04<00:31,  7.73it/s]Test-loop:  11%|█         | 29/268 [00:04<00:30,  7.80it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:30,  7.76it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:30,  7.83it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:30,  7.76it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.88it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:28,  7.98it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:28,  8.04it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:28,  7.85it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:27,  8.03it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:27,  7.93it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:28,  7.73it/s]Test-loop:  19%|█▉        | 51/268 [00:07<00:27,  7.93it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:27,  7.69it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.78it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:26,  7.95it/s]Test-loop:  22%|██▏       | 58/268 [00:08<00:25,  8.19it/s]Test-loop:  22%|██▏       | 59/268 [00:08<00:27,  7.73it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:25,  8.04it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:25,  8.16it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:24,  8.32it/s]Test-loop:  25%|██▍       | 66/268 [00:09<00:24,  8.36it/s]Test-loop:  25%|██▌       | 67/268 [00:09<00:24,  8.06it/s]Test-loop:  25%|██▌       | 68/268 [00:09<00:24,  8.28it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:24,  8.03it/s]Test-loop:  26%|██▌       | 70/268 [00:09<00:24,  8.20it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:24,  8.14it/s]Test-loop:  27%|██▋       | 72/268 [00:09<00:23,  8.17it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:24,  8.06it/s]Test-loop:  28%|██▊       | 74/268 [00:10<00:23,  8.39it/s]Test-loop:  28%|██▊       | 75/268 [00:10<00:23,  8.06it/s]Test-loop:  28%|██▊       | 76/268 [00:10<00:23,  8.22it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:24,  7.83it/s]Test-loop:  29%|██▉       | 78/268 [00:10<00:24,  7.88it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  8.06it/s]Test-loop:  30%|██▉       | 80/268 [00:10<00:24,  7.78it/s]Test-loop:  30%|███       | 81/268 [00:10<00:23,  8.05it/s]Test-loop:  31%|███       | 82/268 [00:11<00:23,  8.08it/s]Test-loop:  31%|███       | 83/268 [00:11<00:23,  7.89it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:22,  7.96it/s]Test-loop:  32%|███▏      | 86/268 [00:11<00:22,  7.99it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:22,  7.91it/s]Test-loop:  33%|███▎      | 88/268 [00:11<00:22,  7.93it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:23,  7.69it/s]Test-loop:  34%|███▎      | 90/268 [00:12<00:22,  7.75it/s]Test-loop:  34%|███▍      | 91/268 [00:12<00:23,  7.51it/s]Test-loop:  34%|███▍      | 92/268 [00:12<00:22,  7.75it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:22,  7.63it/s]Test-loop:  35%|███▌      | 94/268 [00:12<00:21,  7.97it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:22,  7.75it/s]Test-loop:  36%|███▌      | 96/268 [00:12<00:21,  7.91it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  7.81it/s]Test-loop:  37%|███▋      | 98/268 [00:13<00:22,  7.71it/s]Test-loop:  37%|███▋      | 99/268 [00:13<00:21,  8.04it/s]Test-loop:  37%|███▋      | 100/268 [00:13<00:21,  7.90it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  7.99it/s]Test-loop:  38%|███▊      | 102/268 [00:13<00:21,  7.90it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:21,  7.77it/s]Test-loop:  39%|███▉      | 104/268 [00:13<00:19,  8.27it/s]Test-loop:  39%|███▉      | 105/268 [00:14<00:21,  7.57it/s]Test-loop:  40%|███▉      | 107/268 [00:14<00:20,  7.89it/s]Test-loop:  40%|████      | 108/268 [00:14<00:19,  8.18it/s]Test-loop:  41%|████      | 109/268 [00:14<00:20,  7.93it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  7.88it/s]Test-loop:  42%|████▏     | 113/268 [00:15<00:19,  7.81it/s]Test-loop:  43%|████▎     | 115/268 [00:15<00:18,  8.11it/s]Test-loop:  43%|████▎     | 116/268 [00:15<00:18,  8.29it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:19,  7.77it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:19,  7.48it/s]Test-loop:  45%|████▌     | 121/268 [00:16<00:19,  7.58it/s]Test-loop:  46%|████▌     | 123/268 [00:16<00:18,  7.83it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:18,  7.80it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:18,  7.78it/s]Test-loop:  48%|████▊     | 129/268 [00:17<00:17,  7.90it/s]Test-loop:  49%|████▉     | 131/268 [00:17<00:16,  8.10it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.04it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  8.04it/s]Test-loop:  51%|█████     | 137/268 [00:18<00:16,  7.85it/s]Test-loop:  52%|█████▏    | 139/268 [00:18<00:16,  7.82it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:16,  7.78it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  7.87it/s]Test-loop:  54%|█████▍    | 145/268 [00:19<00:15,  8.08it/s]Test-loop:  55%|█████▍    | 147/268 [00:19<00:14,  8.10it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  8.10it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  8.00it/s]Test-loop:  57%|█████▋    | 153/268 [00:20<00:14,  8.15it/s]Test-loop:  58%|█████▊    | 155/268 [00:20<00:13,  8.13it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.15it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  8.34it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:12,  8.45it/s]Test-loop:  61%|██████    | 163/268 [00:21<00:12,  8.33it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:12,  8.04it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  8.00it/s]Test-loop:  63%|██████▎   | 169/268 [00:22<00:12,  7.76it/s]Test-loop:  64%|██████▍   | 171/268 [00:22<00:12,  7.73it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:12,  7.77it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  7.78it/s]Test-loop:  66%|██████▌   | 177/268 [00:23<00:11,  7.75it/s]Test-loop:  67%|██████▋   | 179/268 [00:23<00:11,  7.70it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:11,  7.78it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:11,  7.64it/s]Test-loop:  69%|██████▉   | 185/268 [00:24<00:10,  7.61it/s]Test-loop:  70%|██████▉   | 187/268 [00:24<00:10,  7.85it/s]Test-loop:  71%|███████   | 189/268 [00:24<00:09,  7.95it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  7.95it/s]Test-loop:  72%|███████▏  | 193/268 [00:25<00:09,  7.97it/s]Test-loop:  73%|███████▎  | 195/268 [00:25<00:09,  7.88it/s]Test-loop:  74%|███████▎  | 197/268 [00:25<00:09,  7.80it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  7.92it/s]Test-loop:  75%|███████▌  | 201/268 [00:26<00:08,  8.03it/s]Test-loop:  76%|███████▌  | 203/268 [00:26<00:08,  8.05it/s]Test-loop:  76%|███████▋  | 205/268 [00:26<00:07,  8.14it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  8.31it/s]Test-loop:  78%|███████▊  | 209/268 [00:27<00:06,  8.49it/s]Test-loop:  79%|███████▊  | 211/268 [00:27<00:06,  8.35it/s]Test-loop:  79%|███████▉  | 213/268 [00:27<00:06,  8.49it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  8.17it/s]Test-loop:  81%|████████  | 217/268 [00:28<00:06,  8.05it/s]Test-loop:  82%|████████▏ | 219/268 [00:28<00:06,  8.01it/s]Test-loop:  82%|████████▏ | 221/268 [00:28<00:06,  7.80it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  7.76it/s]Test-loop:  84%|████████▍ | 225/268 [00:29<00:05,  7.76it/s]Test-loop:  85%|████████▍ | 227/268 [00:29<00:05,  7.76it/s]Test-loop:  85%|████████▌ | 229/268 [00:29<00:04,  7.94it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  7.91it/s]Test-loop:  87%|████████▋ | 233/268 [00:30<00:04,  7.80it/s]Test-loop:  88%|████████▊ | 235/268 [00:30<00:04,  7.84it/s]Test-loop:  88%|████████▊ | 237/268 [00:30<00:03,  7.91it/s]Test-loop:  89%|████████▉ | 239/268 [00:30<00:03,  7.87it/s]Test-loop:  90%|████████▉ | 241/268 [00:31<00:03,  8.05it/s]Test-loop:  91%|█████████ | 243/268 [00:31<00:03,  8.14it/s]Test-loop:  91%|█████████▏| 245/268 [00:31<00:02,  8.09it/s]Test-loop:  92%|█████████▏| 247/268 [00:31<00:02,  7.96it/s]Test-loop:  93%|█████████▎| 249/268 [00:32<00:02,  7.93it/s]Test-loop:  94%|█████████▎| 251/268 [00:32<00:02,  7.90it/s]Test-loop:  94%|█████████▍| 253/268 [00:32<00:01,  7.96it/s]Test-loop:  95%|█████████▌| 255/268 [00:32<00:01,  7.79it/s]Test-loop:  96%|█████████▌| 257/268 [00:33<00:01,  8.10it/s]Test-loop:  97%|█████████▋| 259/268 [00:33<00:01,  8.33it/s]Test-loop:  97%|█████████▋| 261/268 [00:33<00:00,  8.36it/s]Test-loop:  98%|█████████▊| 263/268 [00:33<00:00,  8.29it/s]Test-loop:  99%|█████████▉| 265/268 [00:34<00:00,  8.19it/s]Test-loop: 100%|█████████▉| 267/268 [00:34<00:00,  8.00it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  7.79it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:   5%|▍         | 809/17100 [00:00<00:02, 8084.09it/s]Loading Data:  10%|▉         | 1632/17100 [00:00<00:01, 8166.68it/s]Loading Data:  14%|█▍        | 2458/17100 [00:00<00:01, 8208.58it/s]Loading Data:  19%|█▉        | 3279/17100 [00:00<00:01, 8206.56it/s]Loading Data:  24%|██▍       | 4103/17100 [00:00<00:01, 8218.46it/s]Loading Data:  29%|██▉       | 4934/17100 [00:00<00:01, 8246.69it/s]Loading Data:  34%|███▎      | 5760/17100 [00:00<00:01, 8250.79it/s]Loading Data:  39%|███▊      | 6587/17100 [00:00<00:01, 8254.99it/s]Loading Data:  43%|████▎     | 7413/17100 [00:00<00:01, 8255.29it/s]Loading Data:  48%|████▊     | 8240/17100 [00:01<00:01, 8256.96it/s]Loading Data:  53%|█████▎    | 9066/17100 [00:01<00:00, 8246.69it/s]Loading Data:  58%|█████▊    | 9891/17100 [00:01<00:00, 8240.39it/s]Loading Data:  63%|██████▎   | 10716/17100 [00:01<00:00, 8234.16it/s]Loading Data:  67%|██████▋   | 11540/17100 [00:01<00:00, 8219.21it/s]Loading Data:  72%|███████▏  | 12362/17100 [00:01<00:00, 8208.38it/s]Loading Data:  77%|███████▋  | 13186/17100 [00:01<00:00, 8216.43it/s]Loading Data:  82%|████████▏ | 14011/17100 [00:01<00:00, 8224.69it/s]Loading Data:  87%|████████▋ | 14835/17100 [00:01<00:00, 8226.93it/s]Loading Data:  92%|█████████▏| 15660/17100 [00:01<00:00, 8231.38it/s]Loading Data:  96%|█████████▋| 16485/17100 [00:02<00:00, 8234.73it/s]Loading Data: 100%|██████████| 17100/17100 [00:02<00:00, 8223.03it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data:  29%|██▉       | 832/2850 [00:00<00:00, 8312.44it/s]Loading Data:  58%|█████▊    | 1667/2850 [00:00<00:00, 8330.03it/s]Loading Data:  88%|████████▊ | 2501/2850 [00:00<00:00, 8323.67it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 8326.39it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:   5%|▍         | 832/17098 [00:00<00:01, 8311.37it/s]Loading Data:  10%|▉         | 1669/17098 [00:00<00:01, 8344.63it/s]Loading Data:  15%|█▍        | 2505/17098 [00:00<00:01, 8349.16it/s]Loading Data:  20%|█▉        | 3341/17098 [00:00<00:01, 8350.92it/s]Loading Data:  24%|██▍       | 4181/17098 [00:00<00:01, 8367.75it/s]Loading Data:  29%|██▉       | 5018/17098 [00:00<00:01, 8365.28it/s]Loading Data:  34%|███▍      | 5855/17098 [00:00<00:01, 8355.52it/s]Loading Data:  39%|███▉      | 6694/17098 [00:00<00:01, 8363.99it/s]Loading Data:  44%|████▍     | 7535/17098 [00:00<00:01, 8377.40it/s]Loading Data:  49%|████▉     | 8373/17098 [00:01<00:01, 8377.27it/s]Loading Data:  54%|█████▍    | 9211/17098 [00:01<00:00, 8376.81it/s]Loading Data:  59%|█████▉    | 10049/17098 [00:01<00:00, 8377.09it/s]Loading Data:  64%|██████▎   | 10889/17098 [00:01<00:00, 8381.48it/s]Loading Data:  69%|██████▊   | 11729/17098 [00:01<00:00, 8386.56it/s]Loading Data:  74%|███████▎  | 12568/17098 [00:01<00:00, 8374.77it/s]Loading Data:  78%|███████▊  | 13406/17098 [00:01<00:00, 8373.10it/s]Loading Data:  83%|████████▎ | 14244/17098 [00:01<00:00, 8359.49it/s]Loading Data:  88%|████████▊ | 15082/17098 [00:01<00:00, 8364.03it/s]Loading Data:  93%|█████████▎| 15921/17098 [00:01<00:00, 8369.06it/s]Loading Data:  98%|█████████▊| 16758/17098 [00:02<00:00, 8368.81it/s]Loading Data: 100%|██████████| 17098/17098 [00:02<00:00, 8367.65it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type               | Params
--------------------------------------------------
0 | model      | ResNet             | 23.5 M
1 | loss_func  | BCELoss            | 0     
2 | accu_func  | MultilabelAccuracy | 0     
3 | auroc_func | MultilabelAUROC    | 0     
--------------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.130    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:30,  1.42it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:10,  4.05it/s]Test-loop:  11%|█         | 5/45 [00:01<00:06,  6.05it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:05,  7.57it/s]Test-loop:  20%|██        | 9/45 [00:01<00:04,  8.64it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03,  9.48it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:03, 10.01it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 10.50it/s]Test-loop:  38%|███▊      | 17/45 [00:02<00:02, 10.79it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.01it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:02, 11.18it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 11.35it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 11.44it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 11.44it/s]Test-loop:  64%|██████▍   | 29/45 [00:03<00:01, 11.45it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 11.47it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:01, 11.52it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 11.56it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 11.63it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 11.70it/s]Test-loop:  91%|█████████ | 41/45 [00:04<00:00, 11.80it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 11.85it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 12.83it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.00it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:15,  1.36it/s]Test-loop:   1%|          | 3/268 [00:00<01:10,  3.75it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:47,  5.54it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:37,  6.87it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:32,  7.87it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:29,  8.61it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:27,  9.15it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:26,  9.53it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:25,  9.74it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:25,  9.93it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:24, 10.04it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:24, 10.06it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:23, 10.19it/s]Test-loop:  10%|█         | 27/268 [00:03<00:23, 10.35it/s]Test-loop:  11%|█         | 29/268 [00:03<00:23, 10.34it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:22, 10.42it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:22, 10.64it/s]Test-loop:  13%|█▎        | 35/268 [00:04<00:21, 10.67it/s]Test-loop:  14%|█▍        | 37/268 [00:04<00:21, 10.71it/s]Test-loop:  15%|█▍        | 39/268 [00:04<00:21, 10.75it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:20, 10.81it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:20, 10.87it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:20, 10.96it/s]Test-loop:  18%|█▊        | 47/268 [00:05<00:20, 10.95it/s]Test-loop:  18%|█▊        | 49/268 [00:05<00:20, 10.92it/s]Test-loop:  19%|█▉        | 51/268 [00:05<00:20, 10.83it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:20, 10.73it/s]Test-loop:  21%|██        | 55/268 [00:05<00:19, 10.72it/s]Test-loop:  21%|██▏       | 57/268 [00:06<00:19, 10.67it/s]Test-loop:  22%|██▏       | 59/268 [00:06<00:19, 10.67it/s]Test-loop:  23%|██▎       | 61/268 [00:06<00:19, 10.73it/s]Test-loop:  24%|██▎       | 63/268 [00:06<00:19, 10.58it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:19, 10.56it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:19, 10.51it/s]Test-loop:  26%|██▌       | 69/268 [00:07<00:18, 10.54it/s]Test-loop:  26%|██▋       | 71/268 [00:07<00:18, 10.62it/s]Test-loop:  27%|██▋       | 73/268 [00:07<00:18, 10.72it/s]Test-loop:  28%|██▊       | 75/268 [00:07<00:17, 10.76it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:17, 11.08it/s]Test-loop:  29%|██▉       | 79/268 [00:08<00:16, 11.49it/s]Test-loop:  30%|███       | 81/268 [00:08<00:15, 11.76it/s]Test-loop:  31%|███       | 83/268 [00:08<00:15, 11.92it/s]Test-loop:  32%|███▏      | 85/268 [00:08<00:15, 11.67it/s]Test-loop:  32%|███▏      | 87/268 [00:08<00:15, 11.44it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:15, 11.29it/s]Test-loop:  34%|███▍      | 91/268 [00:09<00:15, 11.18it/s]Test-loop:  35%|███▍      | 93/268 [00:09<00:15, 11.06it/s]Test-loop:  35%|███▌      | 95/268 [00:09<00:15, 11.00it/s]Test-loop:  36%|███▌      | 97/268 [00:09<00:15, 10.94it/s]Test-loop:  37%|███▋      | 99/268 [00:09<00:15, 10.84it/s]Test-loop:  38%|███▊      | 101/268 [00:10<00:15, 10.82it/s]Test-loop:  38%|███▊      | 103/268 [00:10<00:15, 10.77it/s]Test-loop:  39%|███▉      | 105/268 [00:10<00:15, 10.77it/s]Test-loop:  40%|███▉      | 107/268 [00:10<00:14, 10.75it/s]Test-loop:  41%|████      | 109/268 [00:10<00:14, 10.89it/s]Test-loop:  41%|████▏     | 111/268 [00:10<00:14, 10.95it/s]Test-loop:  42%|████▏     | 113/268 [00:11<00:14, 10.99it/s]Test-loop:  43%|████▎     | 115/268 [00:11<00:13, 11.05it/s]Test-loop:  44%|████▎     | 117/268 [00:11<00:13, 10.98it/s]Test-loop:  44%|████▍     | 119/268 [00:11<00:13, 11.07it/s]Test-loop:  45%|████▌     | 121/268 [00:11<00:13, 11.10it/s]Test-loop:  46%|████▌     | 123/268 [00:12<00:13, 11.06it/s]Test-loop:  47%|████▋     | 125/268 [00:12<00:13, 10.96it/s]Test-loop:  47%|████▋     | 127/268 [00:12<00:12, 11.05it/s]Test-loop:  48%|████▊     | 129/268 [00:12<00:12, 11.15it/s]Test-loop:  49%|████▉     | 131/268 [00:12<00:12, 11.04it/s]Test-loop:  50%|████▉     | 133/268 [00:12<00:12, 11.08it/s]Test-loop:  50%|█████     | 135/268 [00:13<00:11, 11.09it/s]Test-loop:  51%|█████     | 137/268 [00:13<00:11, 10.99it/s]Test-loop:  52%|█████▏    | 139/268 [00:13<00:11, 11.01it/s]Test-loop:  53%|█████▎    | 141/268 [00:13<00:11, 11.05it/s]Test-loop:  53%|█████▎    | 143/268 [00:13<00:11, 11.11it/s]Test-loop:  54%|█████▍    | 145/268 [00:14<00:10, 11.25it/s]Test-loop:  55%|█████▍    | 147/268 [00:14<00:10, 11.17it/s]Test-loop:  56%|█████▌    | 149/268 [00:14<00:10, 11.25it/s]Test-loop:  56%|█████▋    | 151/268 [00:14<00:10, 11.07it/s]Test-loop:  57%|█████▋    | 153/268 [00:14<00:10, 10.95it/s]Test-loop:  58%|█████▊    | 155/268 [00:14<00:10, 11.03it/s]Test-loop:  59%|█████▊    | 157/268 [00:15<00:10, 11.01it/s]Test-loop:  59%|█████▉    | 159/268 [00:15<00:09, 11.00it/s]Test-loop:  60%|██████    | 161/268 [00:15<00:09, 10.87it/s]Test-loop:  61%|██████    | 163/268 [00:15<00:09, 10.80it/s]Test-loop:  62%|██████▏   | 165/268 [00:15<00:09, 10.87it/s]Test-loop:  62%|██████▏   | 167/268 [00:16<00:09, 10.89it/s]Test-loop:  63%|██████▎   | 169/268 [00:16<00:09, 10.94it/s]Test-loop:  64%|██████▍   | 171/268 [00:16<00:08, 10.89it/s]Test-loop:  65%|██████▍   | 173/268 [00:16<00:08, 10.90it/s]Test-loop:  65%|██████▌   | 175/268 [00:16<00:08, 10.89it/s]Test-loop:  66%|██████▌   | 177/268 [00:16<00:08, 11.04it/s]Test-loop:  67%|██████▋   | 179/268 [00:17<00:08, 10.97it/s]Test-loop:  68%|██████▊   | 181/268 [00:17<00:07, 10.95it/s]Test-loop:  68%|██████▊   | 183/268 [00:17<00:07, 10.86it/s]Test-loop:  69%|██████▉   | 185/268 [00:17<00:07, 10.92it/s]Test-loop:  70%|██████▉   | 187/268 [00:17<00:07, 11.09it/s]Test-loop:  71%|███████   | 189/268 [00:18<00:07, 11.02it/s]Test-loop:  71%|███████▏  | 191/268 [00:18<00:06, 11.11it/s]Test-loop:  72%|███████▏  | 193/268 [00:18<00:06, 11.11it/s]Test-loop:  73%|███████▎  | 195/268 [00:18<00:06, 11.14it/s]Test-loop:  74%|███████▎  | 197/268 [00:18<00:06, 11.16it/s]Test-loop:  74%|███████▍  | 199/268 [00:18<00:06, 11.14it/s]Test-loop:  75%|███████▌  | 201/268 [00:19<00:06, 11.15it/s]Test-loop:  76%|███████▌  | 203/268 [00:19<00:05, 10.98it/s]Test-loop:  76%|███████▋  | 205/268 [00:19<00:05, 10.94it/s]Test-loop:  77%|███████▋  | 207/268 [00:19<00:05, 11.02it/s]Test-loop:  78%|███████▊  | 209/268 [00:19<00:05, 11.04it/s]Test-loop:  79%|███████▊  | 211/268 [00:20<00:05, 11.07it/s]Test-loop:  79%|███████▉  | 213/268 [00:20<00:04, 11.16it/s]Test-loop:  80%|████████  | 215/268 [00:20<00:04, 11.51it/s]Test-loop:  81%|████████  | 217/268 [00:20<00:04, 11.74it/s]Test-loop:  82%|████████▏ | 219/268 [00:20<00:04, 11.91it/s]Test-loop:  82%|████████▏ | 221/268 [00:20<00:03, 11.83it/s]Test-loop:  83%|████████▎ | 223/268 [00:21<00:03, 11.71it/s]Test-loop:  84%|████████▍ | 225/268 [00:21<00:03, 11.38it/s]Test-loop:  85%|████████▍ | 227/268 [00:21<00:03, 11.19it/s]Test-loop:  85%|████████▌ | 229/268 [00:21<00:03, 11.02it/s]Test-loop:  86%|████████▌ | 231/268 [00:21<00:03, 10.93it/s]Test-loop:  87%|████████▋ | 233/268 [00:21<00:03, 10.86it/s]Test-loop:  88%|████████▊ | 235/268 [00:22<00:03, 10.76it/s]Test-loop:  88%|████████▊ | 237/268 [00:22<00:02, 10.71it/s]Test-loop:  89%|████████▉ | 239/268 [00:22<00:02, 10.77it/s]Test-loop:  90%|████████▉ | 241/268 [00:22<00:02, 10.87it/s]Test-loop:  91%|█████████ | 243/268 [00:22<00:02, 10.91it/s]Test-loop:  91%|█████████▏| 245/268 [00:23<00:02, 10.90it/s]Test-loop:  92%|█████████▏| 247/268 [00:23<00:01, 10.85it/s]Test-loop:  93%|█████████▎| 249/268 [00:23<00:01, 10.87it/s]Test-loop:  94%|█████████▎| 251/268 [00:23<00:01, 10.92it/s]Test-loop:  94%|█████████▍| 253/268 [00:23<00:01, 11.00it/s]Test-loop:  95%|█████████▌| 255/268 [00:23<00:01, 11.16it/s]Test-loop:  96%|█████████▌| 257/268 [00:24<00:00, 11.17it/s]Test-loop:  97%|█████████▋| 259/268 [00:24<00:00, 11.20it/s]Test-loop:  97%|█████████▋| 261/268 [00:24<00:00, 11.18it/s]Test-loop:  98%|█████████▊| 263/268 [00:24<00:00, 11.11it/s]Test-loop:  99%|█████████▉| 265/268 [00:24<00:00, 11.13it/s]Test-loop: 100%|█████████▉| 267/268 [00:25<00:00, 10.97it/s]Test-loop: 100%|██████████| 268/268 [00:25<00:00, 10.65it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:33,  1.25it/s]Test-loop:   1%|          | 3/268 [00:01<01:21,  3.27it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:57,  4.58it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:47,  5.49it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:43,  5.99it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:40,  6.35it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:38,  6.68it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:36,  6.91it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:35,  7.13it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:34,  7.17it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:33,  7.29it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:33,  7.37it/s]Test-loop:   9%|▉         | 25/268 [00:04<00:32,  7.59it/s]Test-loop:  10%|█         | 27/268 [00:04<00:31,  7.66it/s]Test-loop:  11%|█         | 29/268 [00:04<00:31,  7.67it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:30,  7.65it/s]Test-loop:  12%|█▏        | 33/268 [00:05<00:30,  7.68it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:30,  7.60it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.76it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:29,  7.86it/s]Test-loop:  15%|█▌        | 41/268 [00:06<00:28,  7.90it/s]Test-loop:  16%|█▌        | 42/268 [00:06<00:27,  8.11it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:29,  7.64it/s]Test-loop:  16%|█▋        | 44/268 [00:06<00:28,  7.92it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:28,  7.77it/s]Test-loop:  17%|█▋        | 46/268 [00:06<00:29,  7.45it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:28,  7.72it/s]Test-loop:  18%|█▊        | 48/268 [00:06<00:30,  7.32it/s]Test-loop:  18%|█▊        | 49/268 [00:07<00:28,  7.73it/s]Test-loop:  19%|█▊        | 50/268 [00:07<00:28,  7.55it/s]Test-loop:  19%|█▉        | 52/268 [00:07<00:27,  7.85it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:27,  7.74it/s]Test-loop:  20%|██        | 54/268 [00:07<00:27,  7.65it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.71it/s]Test-loop:  21%|██        | 56/268 [00:08<00:27,  7.62it/s]Test-loop:  21%|██▏       | 57/268 [00:08<00:26,  7.91it/s]Test-loop:  22%|██▏       | 58/268 [00:08<00:29,  7.22it/s]Test-loop:  22%|██▏       | 60/268 [00:08<00:27,  7.45it/s]Test-loop:  23%|██▎       | 62/268 [00:08<00:26,  7.73it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:25,  7.94it/s]Test-loop:  24%|██▍       | 64/268 [00:09<00:26,  7.67it/s]Test-loop:  25%|██▍       | 66/268 [00:09<00:26,  7.63it/s]Test-loop:  25%|██▌       | 68/268 [00:09<00:26,  7.62it/s]Test-loop:  26%|██▌       | 70/268 [00:09<00:25,  7.66it/s]Test-loop:  27%|██▋       | 72/268 [00:10<00:25,  7.66it/s]Test-loop:  28%|██▊       | 74/268 [00:10<00:25,  7.74it/s]Test-loop:  28%|██▊       | 76/268 [00:10<00:25,  7.63it/s]Test-loop:  29%|██▉       | 78/268 [00:10<00:25,  7.58it/s]Test-loop:  30%|██▉       | 80/268 [00:11<00:24,  7.59it/s]Test-loop:  31%|███       | 82/268 [00:11<00:24,  7.72it/s]Test-loop:  31%|███       | 83/268 [00:11<00:23,  7.94it/s]Test-loop:  31%|███▏      | 84/268 [00:11<00:23,  7.90it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:23,  7.88it/s]Test-loop:  32%|███▏      | 86/268 [00:11<00:24,  7.50it/s]Test-loop:  32%|███▏      | 87/268 [00:12<00:23,  7.80it/s]Test-loop:  33%|███▎      | 88/268 [00:12<00:24,  7.40it/s]Test-loop:  33%|███▎      | 89/268 [00:12<00:23,  7.54it/s]Test-loop:  34%|███▎      | 90/268 [00:12<00:24,  7.35it/s]Test-loop:  34%|███▍      | 91/268 [00:12<00:23,  7.46it/s]Test-loop:  34%|███▍      | 92/268 [00:12<00:24,  7.30it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:23,  7.52it/s]Test-loop:  35%|███▌      | 94/268 [00:13<00:23,  7.50it/s]Test-loop:  35%|███▌      | 95/268 [00:13<00:22,  7.62it/s]Test-loop:  36%|███▌      | 96/268 [00:13<00:22,  7.52it/s]Test-loop:  36%|███▌      | 97/268 [00:13<00:22,  7.62it/s]Test-loop:  37%|███▋      | 98/268 [00:13<00:23,  7.33it/s]Test-loop:  37%|███▋      | 99/268 [00:13<00:21,  7.95it/s]Test-loop:  37%|███▋      | 100/268 [00:13<00:22,  7.53it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.10it/s]Test-loop:  38%|███▊      | 102/268 [00:14<00:22,  7.47it/s]Test-loop:  38%|███▊      | 103/268 [00:14<00:20,  8.05it/s]Test-loop:  39%|███▉      | 104/268 [00:14<00:21,  7.81it/s]Test-loop:  39%|███▉      | 105/268 [00:14<00:20,  7.98it/s]Test-loop:  40%|███▉      | 106/268 [00:14<00:21,  7.67it/s]Test-loop:  40%|███▉      | 107/268 [00:14<00:19,  8.19it/s]Test-loop:  40%|████      | 108/268 [00:14<00:20,  7.68it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.19it/s]Test-loop:  41%|████      | 110/268 [00:15<00:20,  7.61it/s]Test-loop:  41%|████▏     | 111/268 [00:15<00:19,  8.11it/s]Test-loop:  42%|████▏     | 112/268 [00:15<00:19,  7.81it/s]Test-loop:  42%|████▏     | 113/268 [00:15<00:19,  7.97it/s]Test-loop:  43%|████▎     | 114/268 [00:15<00:20,  7.53it/s]Test-loop:  43%|████▎     | 116/268 [00:15<00:19,  7.69it/s]Test-loop:  44%|████▍     | 118/268 [00:16<00:19,  7.79it/s]Test-loop:  44%|████▍     | 119/268 [00:16<00:18,  7.88it/s]Test-loop:  45%|████▍     | 120/268 [00:16<00:18,  7.91it/s]Test-loop:  45%|████▌     | 121/268 [00:16<00:18,  7.77it/s]Test-loop:  46%|████▌     | 122/268 [00:16<00:18,  7.78it/s]Test-loop:  46%|████▌     | 123/268 [00:16<00:18,  8.02it/s]Test-loop:  46%|████▋     | 124/268 [00:16<00:18,  7.78it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:18,  7.84it/s]Test-loop:  47%|████▋     | 126/268 [00:17<00:18,  7.82it/s]Test-loop:  47%|████▋     | 127/268 [00:17<00:18,  7.64it/s]Test-loop:  48%|████▊     | 128/268 [00:17<00:17,  7.87it/s]Test-loop:  48%|████▊     | 129/268 [00:17<00:18,  7.67it/s]Test-loop:  49%|████▊     | 130/268 [00:17<00:17,  7.70it/s]Test-loop:  49%|████▉     | 131/268 [00:17<00:17,  7.99it/s]Test-loop:  49%|████▉     | 132/268 [00:17<00:17,  7.70it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.00it/s]Test-loop:  50%|█████     | 134/268 [00:18<00:17,  7.56it/s]Test-loop:  50%|█████     | 135/268 [00:18<00:16,  7.96it/s]Test-loop:  51%|█████     | 136/268 [00:18<00:17,  7.54it/s]Test-loop:  51%|█████     | 137/268 [00:18<00:16,  7.86it/s]Test-loop:  51%|█████▏    | 138/268 [00:18<00:16,  7.86it/s]Test-loop:  52%|█████▏    | 139/268 [00:18<00:16,  7.75it/s]Test-loop:  52%|█████▏    | 140/268 [00:18<00:16,  7.97it/s]Test-loop:  53%|█████▎    | 141/268 [00:19<00:16,  7.59it/s]Test-loop:  53%|█████▎    | 142/268 [00:19<00:15,  8.05it/s]Test-loop:  53%|█████▎    | 143/268 [00:19<00:15,  7.83it/s]Test-loop:  54%|█████▎    | 144/268 [00:19<00:14,  8.32it/s]Test-loop:  54%|█████▍    | 145/268 [00:19<00:14,  8.59it/s]Test-loop:  54%|█████▍    | 146/268 [00:19<00:13,  8.78it/s]Test-loop:  55%|█████▍    | 147/268 [00:19<00:14,  8.62it/s]Test-loop:  55%|█████▌    | 148/268 [00:19<00:14,  8.34it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  8.23it/s]Test-loop:  56%|█████▌    | 150/268 [00:20<00:14,  8.15it/s]Test-loop:  56%|█████▋    | 151/268 [00:20<00:14,  7.85it/s]Test-loop:  57%|█████▋    | 152/268 [00:20<00:14,  8.21it/s]Test-loop:  57%|█████▋    | 153/268 [00:20<00:14,  7.98it/s]Test-loop:  57%|█████▋    | 154/268 [00:20<00:13,  8.37it/s]Test-loop:  58%|█████▊    | 155/268 [00:20<00:14,  8.00it/s]Test-loop:  58%|█████▊    | 156/268 [00:20<00:14,  7.72it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.01it/s]Test-loop:  59%|█████▉    | 158/268 [00:21<00:14,  7.74it/s]Test-loop:  59%|█████▉    | 159/268 [00:21<00:13,  8.07it/s]Test-loop:  60%|█████▉    | 160/268 [00:21<00:14,  7.56it/s]Test-loop:  60%|██████    | 161/268 [00:21<00:13,  8.06it/s]Test-loop:  60%|██████    | 162/268 [00:21<00:13,  7.61it/s]Test-loop:  61%|██████    | 163/268 [00:21<00:13,  7.89it/s]Test-loop:  61%|██████    | 164/268 [00:21<00:13,  7.71it/s]Test-loop:  62%|██████▏   | 165/268 [00:22<00:13,  7.73it/s]Test-loop:  62%|██████▏   | 166/268 [00:22<00:12,  8.14it/s]Test-loop:  62%|██████▏   | 167/268 [00:22<00:13,  7.73it/s]Test-loop:  63%|██████▎   | 169/268 [00:22<00:13,  7.50it/s]Test-loop:  64%|██████▍   | 171/268 [00:22<00:12,  7.55it/s]Test-loop:  65%|██████▍   | 173/268 [00:23<00:12,  7.73it/s]Test-loop:  65%|██████▌   | 175/268 [00:23<00:12,  7.74it/s]Test-loop:  66%|██████▌   | 177/268 [00:23<00:11,  7.81it/s]Test-loop:  67%|██████▋   | 179/268 [00:23<00:11,  7.77it/s]Test-loop:  68%|██████▊   | 181/268 [00:24<00:11,  7.90it/s]Test-loop:  68%|██████▊   | 183/268 [00:24<00:10,  7.76it/s]Test-loop:  69%|██████▉   | 185/268 [00:24<00:10,  7.79it/s]Test-loop:  70%|██████▉   | 187/268 [00:24<00:10,  8.08it/s]Test-loop:  70%|███████   | 188/268 [00:24<00:09,  8.19it/s]Test-loop:  71%|███████   | 189/268 [00:25<00:09,  8.06it/s]Test-loop:  71%|███████   | 190/268 [00:25<00:09,  8.27it/s]Test-loop:  71%|███████▏  | 191/268 [00:25<00:09,  7.93it/s]Test-loop:  72%|███████▏  | 192/268 [00:25<00:09,  8.12it/s]Test-loop:  72%|███████▏  | 193/268 [00:25<00:09,  7.83it/s]Test-loop:  72%|███████▏  | 194/268 [00:25<00:09,  8.02it/s]Test-loop:  73%|███████▎  | 195/268 [00:25<00:09,  7.83it/s]Test-loop:  73%|███████▎  | 196/268 [00:25<00:08,  8.29it/s]Test-loop:  74%|███████▎  | 197/268 [00:26<00:09,  7.55it/s]Test-loop:  74%|███████▍  | 199/268 [00:26<00:08,  7.85it/s]Test-loop:  75%|███████▌  | 201/268 [00:26<00:08,  8.07it/s]Test-loop:  75%|███████▌  | 202/268 [00:26<00:08,  8.22it/s]Test-loop:  76%|███████▌  | 203/268 [00:26<00:07,  8.13it/s]Test-loop:  76%|███████▌  | 204/268 [00:26<00:08,  7.99it/s]Test-loop:  76%|███████▋  | 205/268 [00:27<00:07,  8.31it/s]Test-loop:  77%|███████▋  | 206/268 [00:27<00:07,  8.25it/s]Test-loop:  77%|███████▋  | 207/268 [00:27<00:07,  8.42it/s]Test-loop:  78%|███████▊  | 208/268 [00:27<00:07,  7.96it/s]Test-loop:  78%|███████▊  | 210/268 [00:27<00:07,  8.07it/s]Test-loop:  79%|███████▉  | 212/268 [00:27<00:06,  8.10it/s]Test-loop:  80%|███████▉  | 214/268 [00:28<00:06,  7.80it/s]Test-loop:  81%|████████  | 216/268 [00:28<00:06,  7.75it/s]Test-loop:  81%|████████▏ | 218/268 [00:28<00:06,  7.66it/s]Test-loop:  82%|████████▏ | 220/268 [00:28<00:06,  7.94it/s]Test-loop:  83%|████████▎ | 222/268 [00:29<00:05,  7.95it/s]Test-loop:  84%|████████▎ | 224/268 [00:29<00:05,  7.86it/s]Test-loop:  84%|████████▍ | 226/268 [00:29<00:05,  7.67it/s]Test-loop:  85%|████████▌ | 228/268 [00:29<00:05,  7.89it/s]Test-loop:  86%|████████▌ | 230/268 [00:30<00:04,  7.87it/s]Test-loop:  87%|████████▋ | 232/268 [00:30<00:04,  8.08it/s]Test-loop:  87%|████████▋ | 234/268 [00:30<00:04,  7.79it/s]Test-loop:  88%|████████▊ | 236/268 [00:30<00:04,  7.78it/s]Test-loop:  89%|████████▉ | 238/268 [00:31<00:03,  7.89it/s]Test-loop:  90%|████████▉ | 240/268 [00:31<00:03,  7.84it/s]Test-loop:  90%|█████████ | 242/268 [00:31<00:03,  7.73it/s]Test-loop:  91%|█████████ | 244/268 [00:31<00:03,  7.94it/s]Test-loop:  92%|█████████▏| 246/268 [00:32<00:02,  8.14it/s]Test-loop:  93%|█████████▎| 248/268 [00:32<00:02,  8.01it/s]Test-loop:  93%|█████████▎| 250/268 [00:32<00:02,  8.14it/s]Test-loop:  94%|█████████▍| 252/268 [00:32<00:01,  8.12it/s]Test-loop:  95%|█████████▍| 254/268 [00:33<00:01,  8.07it/s]Test-loop:  96%|█████████▌| 256/268 [00:33<00:01,  8.07it/s]Test-loop:  96%|█████████▋| 258/268 [00:33<00:01,  8.08it/s]Test-loop:  97%|█████████▋| 260/268 [00:33<00:00,  8.08it/s]Test-loop:  98%|█████████▊| 262/268 [00:34<00:00,  8.20it/s]Test-loop:  99%|█████████▊| 264/268 [00:34<00:00,  8.23it/s]Test-loop:  99%|█████████▉| 266/268 [00:34<00:00,  8.16it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  9.61it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  7.69it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:   5%|▍         | 835/17100 [00:00<00:01, 8346.98it/s]Loading Data:  10%|▉         | 1679/17100 [00:00<00:01, 8398.45it/s]Loading Data:  15%|█▍        | 2523/17100 [00:00<00:01, 8414.96it/s]Loading Data:  20%|█▉        | 3370/17100 [00:00<00:01, 8433.58it/s]Loading Data:  25%|██▍       | 4221/17100 [00:00<00:01, 8459.91it/s]Loading Data:  30%|██▉       | 5070/17100 [00:00<00:01, 8467.46it/s]Loading Data:  35%|███▍      | 5917/17100 [00:00<00:01, 8468.03it/s]Loading Data:  40%|███▉      | 6764/17100 [00:00<00:01, 8464.15it/s]Loading Data:  45%|████▍     | 7611/17100 [00:00<00:01, 8462.74it/s]Loading Data:  49%|████▉     | 8458/17100 [00:01<00:01, 8458.91it/s]Loading Data:  54%|█████▍    | 9304/17100 [00:01<00:00, 8454.43it/s]Loading Data:  59%|█████▉    | 10150/17100 [00:01<00:00, 8450.79it/s]Loading Data:  64%|██████▍   | 10997/17100 [00:01<00:00, 8455.65it/s]Loading Data:  69%|██████▉   | 11845/17100 [00:01<00:00, 8461.27it/s]Loading Data:  74%|███████▍  | 12692/17100 [00:01<00:00, 8451.31it/s]Loading Data:  79%|███████▉  | 13539/17100 [00:01<00:00, 8456.36it/s]Loading Data:  84%|████████▍ | 14388/17100 [00:01<00:00, 8464.95it/s]Loading Data:  89%|████████▉ | 15236/17100 [00:01<00:00, 8468.71it/s]Loading Data:  94%|█████████▍| 16083/17100 [00:01<00:00, 8466.21it/s]Loading Data:  99%|█████████▉| 16931/17100 [00:02<00:00, 8468.02it/s]Loading Data: 100%|██████████| 17100/17100 [00:02<00:00, 8451.37it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data:  30%|██▉       | 844/2850 [00:00<00:00, 8437.33it/s]Loading Data:  60%|█████▉    | 1696/2850 [00:00<00:00, 8480.23it/s]Loading Data:  89%|████████▉ | 2545/2850 [00:00<00:00, 8453.94it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 8457.41it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:   5%|▍         | 842/17098 [00:00<00:01, 8414.21it/s]Loading Data:  10%|▉         | 1684/17098 [00:00<00:01, 8414.80it/s]Loading Data:  15%|█▍        | 2526/17098 [00:00<00:01, 8415.59it/s]Loading Data:  20%|█▉        | 3369/17098 [00:00<00:01, 8420.51it/s]Loading Data:  25%|██▍       | 4216/17098 [00:00<00:01, 8434.74it/s]Loading Data:  30%|██▉       | 5061/17098 [00:00<00:01, 8438.91it/s]Loading Data:  35%|███▍      | 5907/17098 [00:00<00:01, 8444.58it/s]Loading Data:  39%|███▉      | 6752/17098 [00:00<00:01, 8424.59it/s]Loading Data:  44%|████▍     | 7595/17098 [00:00<00:01, 8413.38it/s]Loading Data:  49%|████▉     | 8441/17098 [00:01<00:01, 8425.56it/s]Loading Data:  54%|█████▍    | 9284/17098 [00:01<00:00, 8425.78it/s]Loading Data:  59%|█████▉    | 10129/17098 [00:01<00:00, 8432.32it/s]Loading Data:  64%|██████▍   | 10975/17098 [00:01<00:00, 8437.75it/s]Loading Data:  69%|██████▉   | 11820/17098 [00:01<00:00, 8440.48it/s]Loading Data:  74%|███████▍  | 12665/17098 [00:01<00:00, 8432.92it/s]Loading Data:  79%|███████▉  | 13510/17098 [00:01<00:00, 8437.03it/s]Loading Data:  84%|████████▍ | 14354/17098 [00:01<00:00, 8433.60it/s]Loading Data:  89%|████████▉ | 15198/17098 [00:01<00:00, 8423.02it/s]Loading Data:  94%|█████████▍| 16041/17098 [00:01<00:00, 8413.34it/s]Loading Data:  99%|█████████▊| 16884/17098 [00:02<00:00, 8417.84it/s]Loading Data: 100%|██████████| 17098/17098 [00:02<00:00, 8425.71it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type               | Params
--------------------------------------------------
0 | model      | ResNet             | 23.5 M
1 | loss_func  | BCELoss            | 0     
2 | accu_func  | MultilabelAccuracy | 0     
3 | auroc_func | MultilabelAUROC    | 0     
--------------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.130    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:27,  1.58it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:09,  4.51it/s]Test-loop:  11%|█         | 5/45 [00:00<00:06,  6.63it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  8.23it/s]Test-loop:  20%|██        | 9/45 [00:01<00:03,  9.51it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03, 10.37it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:02, 11.10it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 11.66it/s]Test-loop:  38%|███▊      | 17/45 [00:01<00:02, 12.00it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 12.29it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:01, 12.32it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 12.53it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.75it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 12.92it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 13.15it/s]Test-loop:  69%|██████▉   | 31/45 [00:02<00:01, 13.07it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 13.07it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 13.11it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 13.29it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 13.27it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 13.11it/s]Test-loop:  96%|█████████▌| 43/45 [00:03<00:00, 13.00it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 13.76it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 11.09it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<02:54,  1.53it/s]Test-loop:   1%|          | 3/268 [00:00<01:04,  4.14it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:43,  6.06it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:35,  7.41it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:30,  8.39it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:27,  9.22it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:26,  9.75it/s]Test-loop:   6%|▌         | 15/268 [00:01<00:24, 10.17it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:23, 10.54it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:23, 10.75it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:22, 10.96it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:22, 11.06it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:21, 11.06it/s]Test-loop:  10%|█         | 27/268 [00:03<00:21, 11.17it/s]Test-loop:  11%|█         | 29/268 [00:03<00:21, 11.33it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:20, 11.33it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:20, 11.35it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:20, 11.34it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:20, 11.34it/s]Test-loop:  15%|█▍        | 39/268 [00:04<00:20, 11.35it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:19, 11.41it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:19, 11.34it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:19, 11.41it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:19, 11.43it/s]Test-loop:  18%|█▊        | 49/268 [00:04<00:19, 11.39it/s]Test-loop:  19%|█▉        | 51/268 [00:05<00:18, 11.43it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:18, 11.39it/s]Test-loop:  21%|██        | 55/268 [00:05<00:18, 11.62it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:18, 11.59it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:17, 11.75it/s]Test-loop:  23%|██▎       | 61/268 [00:05<00:17, 11.88it/s]Test-loop:  24%|██▎       | 63/268 [00:06<00:16, 12.12it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:16, 11.96it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:16, 12.02it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:16, 11.92it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:16, 11.82it/s]Test-loop:  27%|██▋       | 73/268 [00:06<00:16, 11.86it/s]Test-loop:  28%|██▊       | 75/268 [00:07<00:15, 12.08it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:15, 12.41it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:14, 12.70it/s]Test-loop:  30%|███       | 81/268 [00:07<00:14, 12.71it/s]Test-loop:  31%|███       | 83/268 [00:07<00:14, 12.38it/s]Test-loop:  32%|███▏      | 85/268 [00:07<00:14, 12.21it/s]Test-loop:  32%|███▏      | 87/268 [00:08<00:14, 12.08it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:14, 12.42it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:13, 12.70it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:13, 13.01it/s]Test-loop:  35%|███▌      | 95/268 [00:08<00:13, 12.78it/s]Test-loop:  36%|███▌      | 97/268 [00:08<00:13, 12.53it/s]Test-loop:  37%|███▋      | 99/268 [00:09<00:13, 12.36it/s]Test-loop:  38%|███▊      | 101/268 [00:09<00:13, 12.26it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:13, 12.17it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:13, 12.11it/s]Test-loop:  40%|███▉      | 107/268 [00:09<00:13, 12.18it/s]Test-loop:  41%|████      | 109/268 [00:09<00:13, 12.11it/s]Test-loop:  41%|████▏     | 111/268 [00:10<00:13, 12.04it/s]Test-loop:  42%|████▏     | 113/268 [00:10<00:12, 11.95it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:12, 11.90it/s]Test-loop:  44%|████▎     | 117/268 [00:10<00:12, 12.07it/s]Test-loop:  44%|████▍     | 119/268 [00:10<00:12, 12.07it/s]Test-loop:  45%|████▌     | 121/268 [00:10<00:12, 12.06it/s]Test-loop:  46%|████▌     | 123/268 [00:11<00:11, 12.16it/s]Test-loop:  47%|████▋     | 125/268 [00:11<00:11, 12.09it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:11, 12.19it/s]Test-loop:  48%|████▊     | 129/268 [00:11<00:11, 12.16it/s]Test-loop:  49%|████▉     | 131/268 [00:11<00:11, 12.13it/s]Test-loop:  50%|████▉     | 133/268 [00:11<00:11, 12.12it/s]Test-loop:  50%|█████     | 135/268 [00:11<00:10, 12.31it/s]Test-loop:  51%|█████     | 137/268 [00:12<00:10, 12.59it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:10, 12.44it/s]Test-loop:  53%|█████▎    | 141/268 [00:12<00:10, 12.25it/s]Test-loop:  53%|█████▎    | 143/268 [00:12<00:10, 12.31it/s]Test-loop:  54%|█████▍    | 145/268 [00:12<00:09, 12.35it/s]Test-loop:  55%|█████▍    | 147/268 [00:12<00:09, 12.30it/s]Test-loop:  56%|█████▌    | 149/268 [00:13<00:09, 12.17it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:09, 12.08it/s]Test-loop:  57%|█████▋    | 153/268 [00:13<00:09, 12.22it/s]Test-loop:  58%|█████▊    | 155/268 [00:13<00:09, 12.15it/s]Test-loop:  59%|█████▊    | 157/268 [00:13<00:09, 12.18it/s]Test-loop:  59%|█████▉    | 159/268 [00:13<00:09, 12.09it/s]Test-loop:  60%|██████    | 161/268 [00:14<00:08, 12.15it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:08, 12.20it/s]Test-loop:  62%|██████▏   | 165/268 [00:14<00:08, 12.22it/s]Test-loop:  62%|██████▏   | 167/268 [00:14<00:08, 12.36it/s]Test-loop:  63%|██████▎   | 169/268 [00:14<00:07, 12.41it/s]Test-loop:  64%|██████▍   | 171/268 [00:14<00:07, 12.33it/s]Test-loop:  65%|██████▍   | 173/268 [00:15<00:07, 12.37it/s]Test-loop:  65%|██████▌   | 175/268 [00:15<00:07, 12.45it/s]Test-loop:  66%|██████▌   | 177/268 [00:15<00:07, 12.48it/s]Test-loop:  67%|██████▋   | 179/268 [00:15<00:07, 12.36it/s]Test-loop:  68%|██████▊   | 181/268 [00:15<00:07, 12.37it/s]Test-loop:  68%|██████▊   | 183/268 [00:15<00:06, 12.33it/s]Test-loop:  69%|██████▉   | 185/268 [00:16<00:06, 12.36it/s]Test-loop:  70%|██████▉   | 187/268 [00:16<00:06, 12.28it/s]Test-loop:  71%|███████   | 189/268 [00:16<00:06, 12.33it/s]Test-loop:  71%|███████▏  | 191/268 [00:16<00:06, 12.23it/s]Test-loop:  72%|███████▏  | 193/268 [00:16<00:06, 12.36it/s]Test-loop:  73%|███████▎  | 195/268 [00:16<00:05, 12.31it/s]Test-loop:  74%|███████▎  | 197/268 [00:17<00:05, 12.14it/s]Test-loop:  74%|███████▍  | 199/268 [00:17<00:05, 12.20it/s]Test-loop:  75%|███████▌  | 201/268 [00:17<00:05, 12.17it/s]Test-loop:  76%|███████▌  | 203/268 [00:17<00:05, 12.28it/s]Test-loop:  76%|███████▋  | 205/268 [00:17<00:05, 12.33it/s]Test-loop:  77%|███████▋  | 207/268 [00:17<00:04, 12.41it/s]Test-loop:  78%|███████▊  | 209/268 [00:18<00:04, 12.47it/s]Test-loop:  79%|███████▊  | 211/268 [00:18<00:04, 12.58it/s]Test-loop:  79%|███████▉  | 213/268 [00:18<00:04, 12.84it/s]Test-loop:  80%|████████  | 215/268 [00:18<00:04, 12.83it/s]Test-loop:  81%|████████  | 217/268 [00:18<00:04, 12.71it/s]Test-loop:  82%|████████▏ | 219/268 [00:18<00:03, 12.78it/s]Test-loop:  82%|████████▏ | 221/268 [00:18<00:03, 12.75it/s]Test-loop:  83%|████████▎ | 223/268 [00:19<00:03, 12.75it/s]Test-loop:  84%|████████▍ | 225/268 [00:19<00:03, 12.74it/s]Test-loop:  85%|████████▍ | 227/268 [00:19<00:03, 12.72it/s]Test-loop:  85%|████████▌ | 229/268 [00:19<00:03, 12.79it/s]Test-loop:  86%|████████▌ | 231/268 [00:19<00:02, 12.68it/s]Test-loop:  87%|████████▋ | 233/268 [00:19<00:02, 12.57it/s]Test-loop:  88%|████████▊ | 235/268 [00:20<00:02, 12.68it/s]Test-loop:  88%|████████▊ | 237/268 [00:20<00:02, 12.61it/s]Test-loop:  89%|████████▉ | 239/268 [00:20<00:02, 12.54it/s]Test-loop:  90%|████████▉ | 241/268 [00:20<00:02, 12.80it/s]Test-loop:  91%|█████████ | 243/268 [00:20<00:01, 13.33it/s]Test-loop:  91%|█████████▏| 245/268 [00:20<00:01, 13.78it/s]Test-loop:  92%|█████████▏| 247/268 [00:20<00:01, 14.11it/s]Test-loop:  93%|█████████▎| 249/268 [00:21<00:01, 13.44it/s]Test-loop:  94%|█████████▎| 251/268 [00:21<00:01, 13.20it/s]Test-loop:  94%|█████████▍| 253/268 [00:21<00:01, 13.09it/s]Test-loop:  95%|█████████▌| 255/268 [00:21<00:01, 12.89it/s]Test-loop:  96%|█████████▌| 257/268 [00:21<00:00, 12.83it/s]Test-loop:  97%|█████████▋| 259/268 [00:21<00:00, 12.68it/s]Test-loop:  97%|█████████▋| 261/268 [00:22<00:00, 12.53it/s]Test-loop:  98%|█████████▊| 263/268 [00:22<00:00, 12.63it/s]Test-loop:  99%|█████████▉| 265/268 [00:22<00:00, 12.68it/s]Test-loop: 100%|█████████▉| 267/268 [00:22<00:00, 12.33it/s]Test-loop: 100%|██████████| 268/268 [00:22<00:00, 11.84it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:23,  1.31it/s]Test-loop:   1%|          | 3/268 [00:01<01:18,  3.39it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:54,  4.82it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:44,  5.82it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:40,  6.34it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:38,  6.67it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:36,  6.96it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:35,  7.14it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:34,  7.30it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:33,  7.48it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:32,  7.66it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:31,  7.76it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:30,  8.06it/s]Test-loop:  10%|█         | 27/268 [00:04<00:29,  8.21it/s]Test-loop:  10%|█         | 28/268 [00:04<00:28,  8.45it/s]Test-loop:  11%|█         | 29/268 [00:04<00:29,  8.18it/s]Test-loop:  11%|█         | 30/268 [00:04<00:28,  8.38it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:29,  7.99it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:29,  8.06it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:28,  8.13it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:28,  8.24it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:27,  8.35it/s]Test-loop:  15%|█▍        | 40/268 [00:05<00:26,  8.52it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:27,  8.32it/s]Test-loop:  16%|█▌        | 42/268 [00:05<00:27,  8.35it/s]Test-loop:  16%|█▌        | 43/268 [00:05<00:27,  8.13it/s]Test-loop:  16%|█▋        | 44/268 [00:06<00:27,  8.04it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:26,  8.41it/s]Test-loop:  17%|█▋        | 46/268 [00:06<00:28,  7.69it/s]Test-loop:  18%|█▊        | 48/268 [00:06<00:28,  7.68it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:26,  8.12it/s]Test-loop:  19%|█▊        | 50/268 [00:06<00:28,  7.58it/s]Test-loop:  19%|█▉        | 52/268 [00:07<00:27,  7.80it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:26,  8.02it/s]Test-loop:  20%|██        | 54/268 [00:07<00:27,  7.79it/s]Test-loop:  21%|██        | 55/268 [00:07<00:26,  8.17it/s]Test-loop:  21%|██        | 56/268 [00:07<00:26,  7.88it/s]Test-loop:  22%|██▏       | 58/268 [00:07<00:27,  7.71it/s]Test-loop:  22%|██▏       | 60/268 [00:08<00:26,  7.94it/s]Test-loop:  23%|██▎       | 62/268 [00:08<00:25,  8.11it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:24,  8.37it/s]Test-loop:  24%|██▍       | 64/268 [00:08<00:26,  7.73it/s]Test-loop:  25%|██▍       | 66/268 [00:08<00:26,  7.65it/s]Test-loop:  25%|██▌       | 68/268 [00:09<00:25,  7.72it/s]Test-loop:  26%|██▌       | 70/268 [00:09<00:25,  7.78it/s]Test-loop:  27%|██▋       | 72/268 [00:09<00:24,  7.87it/s]Test-loop:  28%|██▊       | 74/268 [00:09<00:23,  8.34it/s]Test-loop:  28%|██▊       | 76/268 [00:10<00:22,  8.42it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:22,  8.58it/s]Test-loop:  29%|██▉       | 78/268 [00:10<00:23,  8.04it/s]Test-loop:  30%|██▉       | 80/268 [00:10<00:23,  8.16it/s]Test-loop:  31%|███       | 82/268 [00:10<00:22,  8.34it/s]Test-loop:  31%|███       | 83/268 [00:10<00:22,  8.35it/s]Test-loop:  31%|███▏      | 84/268 [00:11<00:21,  8.52it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:22,  8.31it/s]Test-loop:  32%|███▏      | 86/268 [00:11<00:21,  8.35it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:21,  8.41it/s]Test-loop:  33%|███▎      | 88/268 [00:11<00:20,  8.61it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  8.06it/s]Test-loop:  34%|███▎      | 90/268 [00:11<00:21,  8.11it/s]Test-loop:  34%|███▍      | 91/268 [00:11<00:22,  7.75it/s]Test-loop:  34%|███▍      | 92/268 [00:12<00:21,  8.04it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:22,  7.83it/s]Test-loop:  35%|███▌      | 94/268 [00:12<00:21,  8.22it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:21,  8.10it/s]Test-loop:  36%|███▌      | 96/268 [00:12<00:20,  8.19it/s]Test-loop:  36%|███▌      | 97/268 [00:12<00:21,  7.87it/s]Test-loop:  37%|███▋      | 98/268 [00:12<00:21,  7.76it/s]Test-loop:  37%|███▋      | 99/268 [00:12<00:20,  8.10it/s]Test-loop:  37%|███▋      | 100/268 [00:13<00:21,  7.88it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  8.25it/s]Test-loop:  38%|███▊      | 102/268 [00:13<00:20,  7.98it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  8.19it/s]Test-loop:  39%|███▉      | 104/268 [00:13<00:19,  8.47it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:20,  7.89it/s]Test-loop:  40%|███▉      | 106/268 [00:13<00:19,  8.19it/s]Test-loop:  40%|███▉      | 107/268 [00:13<00:20,  8.03it/s]Test-loop:  40%|████      | 108/268 [00:14<00:19,  8.14it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.10it/s]Test-loop:  41%|████      | 110/268 [00:14<00:19,  8.18it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  7.96it/s]Test-loop:  42%|████▏     | 112/268 [00:14<00:18,  8.45it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:19,  7.82it/s]Test-loop:  43%|████▎     | 114/268 [00:14<00:18,  8.11it/s]Test-loop:  43%|████▎     | 115/268 [00:14<00:18,  8.20it/s]Test-loop:  43%|████▎     | 116/268 [00:15<00:18,  8.13it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:18,  8.05it/s]Test-loop:  44%|████▍     | 118/268 [00:15<00:18,  8.29it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:19,  7.60it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:18,  7.78it/s]Test-loop:  46%|████▌     | 123/268 [00:15<00:17,  8.12it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:17,  8.07it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  8.02it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:17,  8.16it/s]Test-loop:  49%|████▉     | 131/268 [00:16<00:16,  8.27it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.27it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  8.19it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:16,  8.00it/s]Test-loop:  52%|█████▏    | 139/268 [00:17<00:16,  7.91it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:16,  7.81it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  7.95it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:15,  8.17it/s]Test-loop:  55%|█████▍    | 147/268 [00:18<00:14,  8.17it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  8.05it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  7.94it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:14,  8.09it/s]Test-loop:  58%|█████▊    | 155/268 [00:19<00:13,  8.19it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.20it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  8.20it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:13,  8.12it/s]Test-loop:  61%|██████    | 163/268 [00:20<00:13,  8.01it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:13,  7.90it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:12,  8.01it/s]Test-loop:  63%|██████▎   | 169/268 [00:21<00:12,  7.97it/s]Test-loop:  64%|██████▍   | 171/268 [00:21<00:11,  8.17it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:11,  8.39it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:11,  8.32it/s]Test-loop:  66%|██████▌   | 177/268 [00:22<00:10,  8.33it/s]Test-loop:  67%|██████▋   | 179/268 [00:22<00:10,  8.24it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:10,  8.36it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  8.23it/s]Test-loop:  69%|██████▉   | 185/268 [00:23<00:10,  8.21it/s]Test-loop:  70%|██████▉   | 187/268 [00:23<00:09,  8.45it/s]Test-loop:  71%|███████   | 189/268 [00:23<00:09,  8.48it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  8.41it/s]Test-loop:  72%|███████▏  | 193/268 [00:24<00:08,  8.34it/s]Test-loop:  73%|███████▎  | 195/268 [00:24<00:08,  8.35it/s]Test-loop:  74%|███████▎  | 197/268 [00:24<00:08,  8.25it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  8.29it/s]Test-loop:  75%|███████▌  | 201/268 [00:25<00:07,  8.39it/s]Test-loop:  76%|███████▌  | 203/268 [00:25<00:07,  8.43it/s]Test-loop:  76%|███████▋  | 205/268 [00:25<00:07,  8.49it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  8.68it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:06,  8.79it/s]Test-loop:  79%|███████▊  | 211/268 [00:26<00:06,  8.51it/s]Test-loop:  79%|███████▉  | 213/268 [00:26<00:06,  8.68it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  8.44it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:06,  8.42it/s]Test-loop:  82%|████████▏ | 219/268 [00:27<00:05,  8.36it/s]Test-loop:  82%|████████▏ | 221/268 [00:27<00:05,  8.14it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  8.10it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.12it/s]Test-loop:  85%|████████▍ | 227/268 [00:28<00:05,  8.12it/s]Test-loop:  85%|████████▌ | 229/268 [00:28<00:04,  8.30it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  8.25it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  8.27it/s]Test-loop:  88%|████████▊ | 235/268 [00:29<00:03,  8.29it/s]Test-loop:  88%|████████▊ | 237/268 [00:29<00:03,  8.29it/s]Test-loop:  89%|████████▉ | 239/268 [00:29<00:03,  8.28it/s]Test-loop:  90%|████████▉ | 241/268 [00:30<00:03,  8.54it/s]Test-loop:  91%|█████████ | 243/268 [00:30<00:02,  8.53it/s]Test-loop:  91%|█████████▏| 245/268 [00:30<00:02,  8.45it/s]Test-loop:  92%|█████████▏| 247/268 [00:30<00:02,  8.35it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  8.37it/s]Test-loop:  94%|█████████▎| 251/268 [00:31<00:02,  8.40it/s]Test-loop:  94%|█████████▍| 253/268 [00:31<00:01,  8.37it/s]Test-loop:  95%|█████████▌| 255/268 [00:31<00:01,  8.19it/s]Test-loop:  96%|█████████▌| 257/268 [00:32<00:01,  8.26it/s]Test-loop:  97%|█████████▋| 259/268 [00:32<00:01,  8.34it/s]Test-loop:  97%|█████████▋| 261/268 [00:32<00:00,  8.29it/s]Test-loop:  98%|█████████▊| 263/268 [00:32<00:00,  8.26it/s]Test-loop:  99%|█████████▉| 265/268 [00:33<00:00,  8.24it/s]Test-loop: 100%|█████████▉| 267/268 [00:33<00:00,  8.25it/s]Test-loop: 100%|██████████| 268/268 [00:33<00:00,  8.01it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17100 [00:00<?, ?it/s]Loading Data:   5%|▍         | 835/17100 [00:00<00:01, 8346.61it/s]Loading Data:  10%|▉         | 1674/17100 [00:00<00:01, 8368.93it/s]Loading Data:  15%|█▍        | 2520/17100 [00:00<00:01, 8409.41it/s]Loading Data:  20%|█▉        | 3364/17100 [00:00<00:01, 8418.51it/s]Loading Data:  25%|██▍       | 4211/17100 [00:00<00:01, 8436.25it/s]Loading Data:  30%|██▉       | 5058/17100 [00:00<00:01, 8446.04it/s]Loading Data:  35%|███▍      | 5903/17100 [00:00<00:01, 8441.67it/s]Loading Data:  39%|███▉      | 6748/17100 [00:00<00:01, 8437.72it/s]Loading Data:  44%|████▍     | 7593/17100 [00:00<00:01, 8440.53it/s]Loading Data:  49%|████▉     | 8438/17100 [00:01<00:01, 8433.73it/s]Loading Data:  54%|█████▍    | 9282/17100 [00:01<00:00, 8429.86it/s]Loading Data:  59%|█████▉    | 10125/17100 [00:01<00:00, 8421.32it/s]Loading Data:  64%|██████▍   | 10968/17100 [00:01<00:00, 8392.00it/s]Loading Data:  69%|██████▉   | 11810/17100 [00:01<00:00, 8398.70it/s]Loading Data:  74%|███████▍  | 12651/17100 [00:01<00:00, 8399.83it/s]Loading Data:  79%|███████▉  | 13491/17100 [00:01<00:00, 8395.09it/s]Loading Data:  84%|████████▍ | 14331/17100 [00:01<00:00, 8394.27it/s]Loading Data:  89%|████████▊ | 15171/17100 [00:01<00:00, 8378.74it/s]Loading Data:  94%|█████████▎| 16009/17100 [00:01<00:00, 8375.80it/s]Loading Data:  99%|█████████▊| 16847/17100 [00:02<00:00, 8374.23it/s]Loading Data: 100%|██████████| 17100/17100 [00:02<00:00, 8403.37it/s]
Loading Data:   0%|          | 0/2850 [00:00<?, ?it/s]Loading Data:  29%|██▉       | 836/2850 [00:00<00:00, 8353.26it/s]Loading Data:  59%|█████▉    | 1680/2850 [00:00<00:00, 8398.65it/s]Loading Data:  89%|████████▊ | 2525/2850 [00:00<00:00, 8418.23it/s]Loading Data: 100%|██████████| 2850/2850 [00:00<00:00, 8411.85it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:   5%|▍         | 832/17098 [00:00<00:01, 8314.58it/s]Loading Data:  10%|▉         | 1673/17098 [00:00<00:01, 8365.77it/s]Loading Data:  15%|█▍        | 2513/17098 [00:00<00:01, 8378.55it/s]Loading Data:  20%|█▉        | 3353/17098 [00:00<00:01, 8386.25it/s]Loading Data:  25%|██▍       | 4193/17098 [00:00<00:01, 8390.45it/s]Loading Data:  29%|██▉       | 5036/17098 [00:00<00:01, 8400.45it/s]Loading Data:  34%|███▍      | 5877/17098 [00:00<00:01, 8396.36it/s]Loading Data:  39%|███▉      | 6717/17098 [00:00<00:01, 8386.23it/s]Loading Data:  44%|████▍     | 7560/17098 [00:00<00:01, 8399.60it/s]Loading Data:  49%|████▉     | 8403/17098 [00:01<00:01, 8407.59it/s]Loading Data:  54%|█████▍    | 9246/17098 [00:01<00:00, 8413.34it/s]Loading Data:  59%|█████▉    | 10093/17098 [00:01<00:00, 8429.07it/s]Loading Data:  64%|██████▍   | 10936/17098 [00:01<00:00, 8421.78it/s]Loading Data:  69%|██████▉   | 11779/17098 [00:01<00:00, 8420.50it/s]Loading Data:  74%|███████▍  | 12622/17098 [00:01<00:00, 8411.06it/s]Loading Data:  79%|███████▊  | 13464/17098 [00:01<00:00, 8403.31it/s]Loading Data:  84%|████████▎ | 14305/17098 [00:01<00:00, 8400.19it/s]Loading Data:  89%|████████▊ | 15146/17098 [00:01<00:00, 8386.32it/s]Loading Data:  94%|█████████▎| 15990/17098 [00:01<00:00, 8400.63it/s]Loading Data:  98%|█████████▊| 16834/17098 [00:02<00:00, 8411.71it/s]Loading Data: 100%|██████████| 17098/17098 [00:02<00:00, 8402.29it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type               | Params
--------------------------------------------------
0 | model      | ResNet             | 23.5 M
1 | loss_func  | BCELoss            | 0     
2 | accu_func  | MultilabelAccuracy | 0     
3 | auroc_func | MultilabelAUROC    | 0     
--------------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.130    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
`Trainer.fit` stopped: `max_epochs=20` reached.
Test-loop:   0%|          | 0/45 [00:00<?, ?it/s]Test-loop:   2%|▏         | 1/45 [00:00<00:29,  1.51it/s]Test-loop:   7%|▋         | 3/45 [00:00<00:10,  4.18it/s]Test-loop:  11%|█         | 5/45 [00:01<00:06,  6.20it/s]Test-loop:  16%|█▌        | 7/45 [00:01<00:04,  7.78it/s]Test-loop:  20%|██        | 9/45 [00:01<00:04,  8.96it/s]Test-loop:  24%|██▍       | 11/45 [00:01<00:03,  9.80it/s]Test-loop:  29%|██▉       | 13/45 [00:01<00:03, 10.46it/s]Test-loop:  33%|███▎      | 15/45 [00:01<00:02, 10.83it/s]Test-loop:  38%|███▊      | 17/45 [00:02<00:02, 11.25it/s]Test-loop:  42%|████▏     | 19/45 [00:02<00:02, 11.48it/s]Test-loop:  47%|████▋     | 21/45 [00:02<00:02, 11.61it/s]Test-loop:  51%|█████     | 23/45 [00:02<00:01, 11.97it/s]Test-loop:  56%|█████▌    | 25/45 [00:02<00:01, 12.52it/s]Test-loop:  60%|██████    | 27/45 [00:02<00:01, 12.96it/s]Test-loop:  64%|██████▍   | 29/45 [00:02<00:01, 13.36it/s]Test-loop:  69%|██████▉   | 31/45 [00:03<00:01, 13.14it/s]Test-loop:  73%|███████▎  | 33/45 [00:03<00:00, 12.88it/s]Test-loop:  78%|███████▊  | 35/45 [00:03<00:00, 12.72it/s]Test-loop:  82%|████████▏ | 37/45 [00:03<00:00, 12.73it/s]Test-loop:  87%|████████▋ | 39/45 [00:03<00:00, 12.68it/s]Test-loop:  91%|█████████ | 41/45 [00:03<00:00, 12.52it/s]Test-loop:  96%|█████████▌| 43/45 [00:04<00:00, 12.52it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 13.38it/s]Test-loop: 100%|██████████| 45/45 [00:04<00:00, 10.63it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:05,  1.44it/s]Test-loop:   1%|          | 3/268 [00:00<01:07,  3.93it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:46,  5.71it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:36,  7.13it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:31,  8.18it/s]Test-loop:   4%|▍         | 11/268 [00:01<00:28,  8.89it/s]Test-loop:   5%|▍         | 13/268 [00:01<00:26,  9.50it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:25,  9.90it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:24, 10.25it/s]Test-loop:   7%|▋         | 19/268 [00:02<00:23, 10.59it/s]Test-loop:   8%|▊         | 21/268 [00:02<00:23, 10.67it/s]Test-loop:   9%|▊         | 23/268 [00:02<00:22, 10.84it/s]Test-loop:   9%|▉         | 25/268 [00:02<00:22, 10.97it/s]Test-loop:  10%|█         | 27/268 [00:03<00:21, 10.98it/s]Test-loop:  11%|█         | 29/268 [00:03<00:21, 11.06it/s]Test-loop:  12%|█▏        | 31/268 [00:03<00:21, 11.02it/s]Test-loop:  12%|█▏        | 33/268 [00:03<00:21, 11.11it/s]Test-loop:  13%|█▎        | 35/268 [00:03<00:20, 11.12it/s]Test-loop:  14%|█▍        | 37/268 [00:03<00:20, 11.22it/s]Test-loop:  15%|█▍        | 39/268 [00:04<00:20, 11.19it/s]Test-loop:  15%|█▌        | 41/268 [00:04<00:20, 11.19it/s]Test-loop:  16%|█▌        | 43/268 [00:04<00:19, 11.28it/s]Test-loop:  17%|█▋        | 45/268 [00:04<00:19, 11.41it/s]Test-loop:  18%|█▊        | 47/268 [00:04<00:19, 11.60it/s]Test-loop:  18%|█▊        | 49/268 [00:05<00:18, 11.84it/s]Test-loop:  19%|█▉        | 51/268 [00:05<00:17, 12.23it/s]Test-loop:  20%|█▉        | 53/268 [00:05<00:17, 12.15it/s]Test-loop:  21%|██        | 55/268 [00:05<00:17, 11.87it/s]Test-loop:  21%|██▏       | 57/268 [00:05<00:17, 11.78it/s]Test-loop:  22%|██▏       | 59/268 [00:05<00:17, 11.64it/s]Test-loop:  23%|██▎       | 61/268 [00:06<00:17, 11.52it/s]Test-loop:  24%|██▎       | 63/268 [00:06<00:17, 11.50it/s]Test-loop:  24%|██▍       | 65/268 [00:06<00:17, 11.59it/s]Test-loop:  25%|██▌       | 67/268 [00:06<00:17, 11.78it/s]Test-loop:  26%|██▌       | 69/268 [00:06<00:16, 11.78it/s]Test-loop:  26%|██▋       | 71/268 [00:06<00:16, 11.78it/s]Test-loop:  27%|██▋       | 73/268 [00:07<00:16, 11.52it/s]Test-loop:  28%|██▊       | 75/268 [00:07<00:16, 11.46it/s]Test-loop:  29%|██▊       | 77/268 [00:07<00:16, 11.34it/s]Test-loop:  29%|██▉       | 79/268 [00:07<00:16, 11.28it/s]Test-loop:  30%|███       | 81/268 [00:07<00:16, 11.16it/s]Test-loop:  31%|███       | 83/268 [00:07<00:16, 11.15it/s]Test-loop:  32%|███▏      | 85/268 [00:08<00:16, 11.04it/s]Test-loop:  32%|███▏      | 87/268 [00:08<00:16, 11.18it/s]Test-loop:  33%|███▎      | 89/268 [00:08<00:16, 11.14it/s]Test-loop:  34%|███▍      | 91/268 [00:08<00:15, 11.16it/s]Test-loop:  35%|███▍      | 93/268 [00:08<00:15, 11.14it/s]Test-loop:  35%|███▌      | 95/268 [00:09<00:15, 11.19it/s]Test-loop:  36%|███▌      | 97/268 [00:09<00:15, 11.17it/s]Test-loop:  37%|███▋      | 99/268 [00:09<00:15, 11.08it/s]Test-loop:  38%|███▊      | 101/268 [00:09<00:15, 11.04it/s]Test-loop:  38%|███▊      | 103/268 [00:09<00:14, 11.18it/s]Test-loop:  39%|███▉      | 105/268 [00:09<00:14, 11.19it/s]Test-loop:  40%|███▉      | 107/268 [00:10<00:14, 11.30it/s]Test-loop:  41%|████      | 109/268 [00:10<00:14, 11.16it/s]Test-loop:  41%|████▏     | 111/268 [00:10<00:13, 11.22it/s]Test-loop:  42%|████▏     | 113/268 [00:10<00:13, 11.33it/s]Test-loop:  43%|████▎     | 115/268 [00:10<00:13, 11.28it/s]Test-loop:  44%|████▎     | 117/268 [00:11<00:13, 11.16it/s]Test-loop:  44%|████▍     | 119/268 [00:11<00:13, 11.26it/s]Test-loop:  45%|████▌     | 121/268 [00:11<00:13, 11.28it/s]Test-loop:  46%|████▌     | 123/268 [00:11<00:12, 11.18it/s]Test-loop:  47%|████▋     | 125/268 [00:11<00:12, 11.24it/s]Test-loop:  47%|████▋     | 127/268 [00:11<00:12, 11.41it/s]Test-loop:  48%|████▊     | 129/268 [00:12<00:12, 11.36it/s]Test-loop:  49%|████▉     | 131/268 [00:12<00:11, 11.46it/s]Test-loop:  50%|████▉     | 133/268 [00:12<00:11, 11.53it/s]Test-loop:  50%|█████     | 135/268 [00:12<00:11, 11.48it/s]Test-loop:  51%|█████     | 137/268 [00:12<00:11, 11.60it/s]Test-loop:  52%|█████▏    | 139/268 [00:12<00:10, 11.80it/s]Test-loop:  53%|█████▎    | 141/268 [00:13<00:10, 11.88it/s]Test-loop:  53%|█████▎    | 143/268 [00:13<00:10, 11.73it/s]Test-loop:  54%|█████▍    | 145/268 [00:13<00:10, 11.58it/s]Test-loop:  55%|█████▍    | 147/268 [00:13<00:10, 11.65it/s]Test-loop:  56%|█████▌    | 149/268 [00:13<00:10, 11.63it/s]Test-loop:  56%|█████▋    | 151/268 [00:13<00:09, 11.70it/s]Test-loop:  57%|█████▋    | 153/268 [00:14<00:09, 11.61it/s]Test-loop:  58%|█████▊    | 155/268 [00:14<00:09, 11.54it/s]Test-loop:  59%|█████▊    | 157/268 [00:14<00:09, 11.55it/s]Test-loop:  59%|█████▉    | 159/268 [00:14<00:09, 11.57it/s]Test-loop:  60%|██████    | 161/268 [00:14<00:09, 11.60it/s]Test-loop:  61%|██████    | 163/268 [00:14<00:09, 11.50it/s]Test-loop:  62%|██████▏   | 165/268 [00:15<00:09, 11.43it/s]Test-loop:  62%|██████▏   | 167/268 [00:15<00:08, 11.34it/s]Test-loop:  63%|██████▎   | 169/268 [00:15<00:08, 11.39it/s]Test-loop:  64%|██████▍   | 171/268 [00:15<00:08, 11.40it/s]Test-loop:  65%|██████▍   | 173/268 [00:15<00:08, 11.42it/s]Test-loop:  65%|██████▌   | 175/268 [00:16<00:08, 11.42it/s]Test-loop:  66%|██████▌   | 177/268 [00:16<00:07, 11.74it/s]Test-loop:  67%|██████▋   | 179/268 [00:16<00:07, 12.27it/s]Test-loop:  68%|██████▊   | 181/268 [00:16<00:06, 12.62it/s]Test-loop:  68%|██████▊   | 183/268 [00:16<00:06, 12.48it/s]Test-loop:  69%|██████▉   | 185/268 [00:16<00:06, 12.03it/s]Test-loop:  70%|██████▉   | 187/268 [00:17<00:06, 11.97it/s]Test-loop:  71%|███████   | 189/268 [00:17<00:06, 11.91it/s]Test-loop:  71%|███████▏  | 191/268 [00:17<00:06, 11.94it/s]Test-loop:  72%|███████▏  | 193/268 [00:17<00:06, 11.96it/s]Test-loop:  73%|███████▎  | 195/268 [00:17<00:06, 11.93it/s]Test-loop:  74%|███████▎  | 197/268 [00:17<00:05, 11.84it/s]Test-loop:  74%|███████▍  | 199/268 [00:18<00:05, 11.65it/s]Test-loop:  75%|███████▌  | 201/268 [00:18<00:05, 11.57it/s]Test-loop:  76%|███████▌  | 203/268 [00:18<00:05, 11.66it/s]Test-loop:  76%|███████▋  | 205/268 [00:18<00:05, 11.51it/s]Test-loop:  77%|███████▋  | 207/268 [00:18<00:05, 11.55it/s]Test-loop:  78%|███████▊  | 209/268 [00:18<00:05, 11.51it/s]Test-loop:  79%|███████▊  | 211/268 [00:19<00:04, 11.48it/s]Test-loop:  79%|███████▉  | 213/268 [00:19<00:04, 11.35it/s]Test-loop:  80%|████████  | 215/268 [00:19<00:04, 11.46it/s]Test-loop:  81%|████████  | 217/268 [00:19<00:04, 11.52it/s]Test-loop:  82%|████████▏ | 219/268 [00:19<00:04, 11.46it/s]Test-loop:  82%|████████▏ | 221/268 [00:19<00:04, 11.50it/s]Test-loop:  83%|████████▎ | 223/268 [00:20<00:03, 11.46it/s]Test-loop:  84%|████████▍ | 225/268 [00:20<00:03, 11.40it/s]Test-loop:  85%|████████▍ | 227/268 [00:20<00:03, 11.33it/s]Test-loop:  85%|████████▌ | 229/268 [00:20<00:03, 11.28it/s]Test-loop:  86%|████████▌ | 231/268 [00:20<00:03, 11.40it/s]Test-loop:  87%|████████▋ | 233/268 [00:21<00:03, 11.44it/s]Test-loop:  88%|████████▊ | 235/268 [00:21<00:02, 11.29it/s]Test-loop:  88%|████████▊ | 237/268 [00:21<00:02, 11.24it/s]Test-loop:  89%|████████▉ | 239/268 [00:21<00:02, 11.25it/s]Test-loop:  90%|████████▉ | 241/268 [00:21<00:02, 11.23it/s]Test-loop:  91%|█████████ | 243/268 [00:21<00:02, 11.15it/s]Test-loop:  91%|█████████▏| 245/268 [00:22<00:02, 11.26it/s]Test-loop:  92%|█████████▏| 247/268 [00:22<00:01, 11.32it/s]Test-loop:  93%|█████████▎| 249/268 [00:22<00:01, 11.25it/s]Test-loop:  94%|█████████▎| 251/268 [00:22<00:01, 11.38it/s]Test-loop:  94%|█████████▍| 253/268 [00:22<00:01, 11.54it/s]Test-loop:  95%|█████████▌| 255/268 [00:22<00:01, 11.87it/s]Test-loop:  96%|█████████▌| 257/268 [00:23<00:00, 12.32it/s]Test-loop:  97%|█████████▋| 259/268 [00:23<00:00, 12.76it/s]Test-loop:  97%|█████████▋| 261/268 [00:23<00:00, 13.11it/s]Test-loop:  98%|█████████▊| 263/268 [00:23<00:00, 12.54it/s]Test-loop:  99%|█████████▉| 265/268 [00:23<00:00, 12.40it/s]Test-loop: 100%|█████████▉| 267/268 [00:23<00:00, 12.20it/s]Test-loop: 100%|██████████| 268/268 [00:23<00:00, 11.17it/s]
Test-loop:   0%|          | 0/268 [00:00<?, ?it/s]Test-loop:   0%|          | 1/268 [00:00<03:27,  1.29it/s]Test-loop:   1%|          | 3/268 [00:01<01:19,  3.34it/s]Test-loop:   2%|▏         | 5/268 [00:01<00:54,  4.83it/s]Test-loop:   3%|▎         | 7/268 [00:01<00:43,  5.94it/s]Test-loop:   3%|▎         | 9/268 [00:01<00:40,  6.42it/s]Test-loop:   4%|▍         | 11/268 [00:02<00:38,  6.72it/s]Test-loop:   5%|▍         | 13/268 [00:02<00:36,  6.97it/s]Test-loop:   6%|▌         | 15/268 [00:02<00:35,  7.09it/s]Test-loop:   6%|▋         | 17/268 [00:02<00:34,  7.21it/s]Test-loop:   7%|▋         | 19/268 [00:03<00:33,  7.34it/s]Test-loop:   8%|▊         | 21/268 [00:03<00:32,  7.63it/s]Test-loop:   9%|▊         | 23/268 [00:03<00:31,  7.86it/s]Test-loop:   9%|▉         | 25/268 [00:03<00:30,  7.94it/s]Test-loop:  10%|█         | 27/268 [00:04<00:30,  7.99it/s]Test-loop:  11%|█         | 29/268 [00:04<00:30,  7.93it/s]Test-loop:  12%|█▏        | 31/268 [00:04<00:30,  7.83it/s]Test-loop:  12%|█▏        | 33/268 [00:04<00:30,  7.79it/s]Test-loop:  13%|█▎        | 35/268 [00:05<00:29,  7.85it/s]Test-loop:  14%|█▍        | 37/268 [00:05<00:29,  7.93it/s]Test-loop:  15%|█▍        | 39/268 [00:05<00:28,  7.96it/s]Test-loop:  15%|█▌        | 41/268 [00:05<00:28,  8.01it/s]Test-loop:  16%|█▌        | 43/268 [00:06<00:28,  7.87it/s]Test-loop:  17%|█▋        | 45/268 [00:06<00:27,  8.02it/s]Test-loop:  18%|█▊        | 47/268 [00:06<00:27,  7.96it/s]Test-loop:  18%|█▊        | 49/268 [00:06<00:28,  7.74it/s]Test-loop:  19%|█▉        | 51/268 [00:07<00:27,  7.83it/s]Test-loop:  20%|█▉        | 53/268 [00:07<00:28,  7.53it/s]Test-loop:  21%|██        | 55/268 [00:07<00:27,  7.63it/s]Test-loop:  21%|██▏       | 57/268 [00:07<00:27,  7.76it/s]Test-loop:  22%|██▏       | 59/268 [00:08<00:27,  7.67it/s]Test-loop:  23%|██▎       | 61/268 [00:08<00:26,  7.83it/s]Test-loop:  24%|██▎       | 63/268 [00:08<00:26,  7.83it/s]Test-loop:  24%|██▍       | 65/268 [00:08<00:25,  7.91it/s]Test-loop:  25%|██▌       | 67/268 [00:09<00:25,  7.83it/s]Test-loop:  26%|██▌       | 69/268 [00:09<00:25,  7.94it/s]Test-loop:  26%|██▋       | 71/268 [00:09<00:24,  8.04it/s]Test-loop:  27%|██▋       | 73/268 [00:09<00:24,  8.01it/s]Test-loop:  28%|██▊       | 75/268 [00:10<00:24,  7.93it/s]Test-loop:  29%|██▊       | 77/268 [00:10<00:24,  7.85it/s]Test-loop:  29%|██▉       | 79/268 [00:10<00:23,  7.97it/s]Test-loop:  30%|███       | 81/268 [00:10<00:23,  7.99it/s]Test-loop:  31%|███       | 83/268 [00:11<00:23,  7.85it/s]Test-loop:  32%|███▏      | 85/268 [00:11<00:23,  7.87it/s]Test-loop:  32%|███▏      | 87/268 [00:11<00:23,  7.86it/s]Test-loop:  33%|███▎      | 89/268 [00:11<00:22,  7.80it/s]Test-loop:  34%|███▍      | 91/268 [00:12<00:23,  7.69it/s]Test-loop:  35%|███▍      | 93/268 [00:12<00:22,  7.77it/s]Test-loop:  35%|███▌      | 95/268 [00:12<00:22,  7.84it/s]Test-loop:  36%|███▌      | 97/268 [00:13<00:21,  7.84it/s]Test-loop:  37%|███▋      | 99/268 [00:13<00:21,  7.93it/s]Test-loop:  38%|███▊      | 101/268 [00:13<00:20,  7.97it/s]Test-loop:  38%|███▊      | 103/268 [00:13<00:20,  8.00it/s]Test-loop:  39%|███▉      | 105/268 [00:13<00:20,  8.04it/s]Test-loop:  40%|███▉      | 107/268 [00:14<00:19,  8.19it/s]Test-loop:  41%|████      | 109/268 [00:14<00:19,  8.15it/s]Test-loop:  41%|████▏     | 111/268 [00:14<00:19,  8.09it/s]Test-loop:  42%|████▏     | 113/268 [00:14<00:18,  8.25it/s]Test-loop:  43%|████▎     | 115/268 [00:15<00:17,  8.68it/s]Test-loop:  44%|████▎     | 117/268 [00:15<00:17,  8.47it/s]Test-loop:  44%|████▍     | 119/268 [00:15<00:18,  8.11it/s]Test-loop:  45%|████▌     | 121/268 [00:15<00:18,  8.07it/s]Test-loop:  46%|████▌     | 123/268 [00:16<00:17,  8.24it/s]Test-loop:  47%|████▋     | 125/268 [00:16<00:17,  8.06it/s]Test-loop:  47%|████▋     | 127/268 [00:16<00:17,  8.00it/s]Test-loop:  48%|████▊     | 129/268 [00:16<00:17,  8.01it/s]Test-loop:  49%|████▉     | 131/268 [00:17<00:16,  8.09it/s]Test-loop:  50%|████▉     | 133/268 [00:17<00:16,  8.04it/s]Test-loop:  50%|█████     | 135/268 [00:17<00:16,  7.99it/s]Test-loop:  51%|█████     | 137/268 [00:17<00:16,  7.87it/s]Test-loop:  52%|█████▏    | 139/268 [00:18<00:16,  7.83it/s]Test-loop:  53%|█████▎    | 141/268 [00:18<00:16,  7.79it/s]Test-loop:  53%|█████▎    | 143/268 [00:18<00:15,  7.82it/s]Test-loop:  54%|█████▍    | 145/268 [00:18<00:15,  8.07it/s]Test-loop:  55%|█████▍    | 147/268 [00:19<00:14,  8.08it/s]Test-loop:  56%|█████▌    | 149/268 [00:19<00:14,  8.04it/s]Test-loop:  56%|█████▋    | 151/268 [00:19<00:14,  7.98it/s]Test-loop:  57%|█████▋    | 153/268 [00:19<00:14,  8.07it/s]Test-loop:  58%|█████▊    | 155/268 [00:20<00:13,  8.09it/s]Test-loop:  59%|█████▊    | 157/268 [00:20<00:13,  8.12it/s]Test-loop:  59%|█████▉    | 159/268 [00:20<00:13,  8.10it/s]Test-loop:  60%|██████    | 161/268 [00:20<00:13,  8.05it/s]Test-loop:  61%|██████    | 163/268 [00:21<00:13,  7.93it/s]Test-loop:  62%|██████▏   | 165/268 [00:21<00:13,  7.70it/s]Test-loop:  62%|██████▏   | 167/268 [00:21<00:13,  7.69it/s]Test-loop:  63%|██████▎   | 169/268 [00:22<00:13,  7.50it/s]Test-loop:  64%|██████▍   | 171/268 [00:22<00:12,  7.47it/s]Test-loop:  65%|██████▍   | 173/268 [00:22<00:12,  7.63it/s]Test-loop:  65%|██████▌   | 175/268 [00:22<00:12,  7.67it/s]Test-loop:  66%|██████▌   | 177/268 [00:23<00:11,  7.78it/s]Test-loop:  67%|██████▋   | 179/268 [00:23<00:11,  7.74it/s]Test-loop:  68%|██████▊   | 181/268 [00:23<00:11,  7.85it/s]Test-loop:  68%|██████▊   | 183/268 [00:23<00:10,  7.82it/s]Test-loop:  69%|██████▉   | 185/268 [00:24<00:10,  7.93it/s]Test-loop:  70%|██████▉   | 187/268 [00:24<00:09,  8.12it/s]Test-loop:  71%|███████   | 189/268 [00:24<00:09,  8.18it/s]Test-loop:  71%|███████▏  | 191/268 [00:24<00:09,  8.13it/s]Test-loop:  72%|███████▏  | 193/268 [00:25<00:09,  8.12it/s]Test-loop:  73%|███████▎  | 195/268 [00:25<00:09,  8.02it/s]Test-loop:  74%|███████▎  | 197/268 [00:25<00:08,  7.91it/s]Test-loop:  74%|███████▍  | 199/268 [00:25<00:08,  8.00it/s]Test-loop:  75%|███████▌  | 201/268 [00:26<00:08,  8.13it/s]Test-loop:  76%|███████▌  | 203/268 [00:26<00:07,  8.18it/s]Test-loop:  76%|███████▋  | 205/268 [00:26<00:07,  8.29it/s]Test-loop:  77%|███████▋  | 207/268 [00:26<00:07,  8.62it/s]Test-loop:  78%|███████▊  | 209/268 [00:26<00:06,  8.87it/s]Test-loop:  79%|███████▊  | 211/268 [00:27<00:06,  8.59it/s]Test-loop:  79%|███████▉  | 213/268 [00:27<00:06,  8.61it/s]Test-loop:  80%|████████  | 215/268 [00:27<00:06,  8.25it/s]Test-loop:  81%|████████  | 217/268 [00:27<00:06,  8.11it/s]Test-loop:  82%|████████▏ | 219/268 [00:28<00:06,  8.04it/s]Test-loop:  82%|████████▏ | 221/268 [00:28<00:05,  7.91it/s]Test-loop:  83%|████████▎ | 223/268 [00:28<00:05,  8.07it/s]Test-loop:  84%|████████▍ | 225/268 [00:28<00:05,  8.03it/s]Test-loop:  85%|████████▍ | 227/268 [00:29<00:05,  7.94it/s]Test-loop:  85%|████████▌ | 229/268 [00:29<00:04,  7.99it/s]Test-loop:  86%|████████▌ | 231/268 [00:29<00:04,  7.98it/s]Test-loop:  87%|████████▋ | 233/268 [00:29<00:04,  7.91it/s]Test-loop:  88%|████████▊ | 235/268 [00:30<00:04,  7.99it/s]Test-loop:  88%|████████▊ | 237/268 [00:30<00:03,  8.03it/s]Test-loop:  89%|████████▉ | 239/268 [00:30<00:03,  8.06it/s]Test-loop:  90%|████████▉ | 241/268 [00:30<00:03,  8.27it/s]Test-loop:  91%|█████████ | 243/268 [00:31<00:03,  8.32it/s]Test-loop:  91%|█████████▏| 245/268 [00:31<00:02,  8.25it/s]Test-loop:  92%|█████████▏| 247/268 [00:31<00:02,  8.12it/s]Test-loop:  93%|█████████▎| 249/268 [00:31<00:02,  8.18it/s]Test-loop:  94%|█████████▎| 251/268 [00:32<00:02,  8.14it/s]Test-loop:  94%|█████████▍| 253/268 [00:32<00:01,  8.07it/s]Test-loop:  95%|█████████▌| 255/268 [00:32<00:01,  7.88it/s]Test-loop:  96%|█████████▌| 257/268 [00:32<00:01,  8.04it/s]Test-loop:  97%|█████████▋| 259/268 [00:33<00:01,  8.08it/s]Test-loop:  97%|█████████▋| 261/268 [00:33<00:00,  8.00it/s]Test-loop:  98%|█████████▊| 263/268 [00:33<00:00,  8.07it/s]Test-loop:  99%|█████████▉| 265/268 [00:33<00:00,  8.00it/s]Test-loop: 100%|█████████▉| 267/268 [00:34<00:00,  8.12it/s]Test-loop: 100%|██████████| 268/268 [00:34<00:00,  7.83it/s]
Global seed set to 42
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:796: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:799: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id , self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:836: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:840: FutureWarning: The default value of numeric_only in DataFrameGroupBy.mean is deprecated. In a future version, numeric_only will default to False. Either specify numeric_only or select only columns which should be valid for the function.
  df_per_patient = df.groupby([self.col_name_patient_id, self.col_name_gender]).mean()
../../detecting_causes_of_gender_bias_chest_xrays/dataloader/dataloader.py:646: DtypeWarning: Columns (24) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(self.csv_file_img, header=0)
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:   5%|▍         | 837/17098 [00:00<00:01, 8363.43it/s]Loading Data:  10%|▉         | 1681/17098 [00:00<00:01, 8407.91it/s]Loading Data:  15%|█▍        | 2522/17098 [00:00<00:01, 8362.02it/s]Loading Data:  20%|█▉        | 3361/17098 [00:00<00:01, 8369.28it/s]Loading Data:  25%|██▍       | 4202/17098 [00:00<00:01, 8382.78it/s]Loading Data:  30%|██▉       | 5045/17098 [00:00<00:01, 8395.43it/s]Loading Data:  34%|███▍      | 5885/17098 [00:00<00:01, 8394.57it/s]Loading Data:  39%|███▉      | 6726/17098 [00:00<00:01, 8399.43it/s]Loading Data:  44%|████▍     | 7570/17098 [00:00<00:01, 8409.68it/s]Loading Data:  49%|████▉     | 8416/17098 [00:01<00:01, 8423.95it/s]Loading Data:  54%|█████▍    | 9259/17098 [00:01<00:00, 8382.06it/s]Loading Data:  59%|█████▉    | 10098/17098 [00:01<00:00, 8378.14it/s]Loading Data:  64%|██████▍   | 10946/17098 [00:01<00:00, 8405.67it/s]Loading Data:  69%|██████▉   | 11788/17098 [00:01<00:00, 8407.66it/s]Loading Data:  74%|███████▍  | 12633/17098 [00:01<00:00, 8420.23it/s]Loading Data:  79%|███████▉  | 13476/17098 [00:01<00:00, 8421.25it/s]Loading Data:  84%|████████▎ | 14319/17098 [00:01<00:00, 8412.23it/s]Loading Data:  89%|████████▊ | 15164/17098 [00:01<00:00, 8421.55it/s]Loading Data:  94%|█████████▎| 16009/17098 [00:01<00:00, 8429.47it/s]Loading Data:  99%|█████████▊| 16852/17098 [00:02<00:00, 8423.14it/s]Loading Data: 100%|██████████| 17098/17098 [00:02<00:00, 8401.89it/s]
Loading Data:   0%|          | 0/2849 [00:00<?, ?it/s]Loading Data:  30%|██▉       | 841/2849 [00:00<00:00, 8408.12it/s]Loading Data:  59%|█████▉    | 1687/2849 [00:00<00:00, 8433.38it/s]Loading Data:  89%|████████▉ | 2533/2849 [00:00<00:00, 8444.38it/s]Loading Data: 100%|██████████| 2849/2849 [00:00<00:00, 8439.69it/s]
Loading Data:   0%|          | 0/17098 [00:00<?, ?it/s]Loading Data:   5%|▍         | 840/17098 [00:00<00:01, 8392.02it/s]Loading Data:  10%|▉         | 1683/17098 [00:00<00:01, 8411.41it/s]Loading Data:  15%|█▍        | 2526/17098 [00:00<00:01, 8415.70it/s]Loading Data:  20%|█▉        | 3369/17098 [00:00<00:01, 8420.21it/s]Loading Data:  25%|██▍       | 4212/17098 [00:00<00:01, 8415.62it/s]Loading Data:  30%|██▉       | 5054/17098 [00:00<00:01, 8413.17it/s]Loading Data:  34%|███▍      | 5896/17098 [00:00<00:01, 8383.47it/s]Loading Data:  39%|███▉      | 6735/17098 [00:00<00:01, 8361.44it/s]Loading Data:  44%|████▍     | 7572/17098 [00:00<00:01, 8347.23it/s]Loading Data:  49%|████▉     | 8412/17098 [00:01<00:01, 8360.56it/s]Loading Data:  54%|█████▍    | 9249/17098 [00:01<00:00, 8362.07it/s]Loading Data:  59%|█████▉    | 10086/17098 [00:01<00:00, 8359.72it/s]Loading Data:  64%|██████▍   | 10927/17098 [00:01<00:00, 8374.55it/s]Loading Data:  69%|██████▉   | 11765/17098 [00:01<00:00, 8367.34it/s]Loading Data:  74%|███████▎  | 12602/17098 [00:01<00:00, 8363.82it/s]Loading Data:  79%|███████▊  | 13439/17098 [00:01<00:00, 8362.48it/s]Loading Data:  83%|████████▎ | 14276/17098 [00:01<00:00, 8363.18it/s]Loading Data:  88%|████████▊ | 15113/17098 [00:01<00:00, 8364.79it/s]Loading Data:  93%|█████████▎| 15955/17098 [00:01<00:00, 8378.76it/s]Loading Data:  98%|█████████▊| 16793/17098 [00:02<00:00, 8371.21it/s]Loading Data: 100%|██████████| 17098/17098 [00:02<00:00, 8375.68it/s]
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
Lossy conversion from float32 to uint8. Range [0, 1]. Convert image to uint8 prior to saving to suppress this warning.
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:474: LightningDeprecationWarning: Setting `Trainer(gpus=1)` is deprecated in v1.7 and will be removed in v2.0. Please use `Trainer(accelerator='gpu', devices=1)` instead.
  rank_zero_deprecation(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type               | Params
--------------------------------------------------
0 | model      | ResNet             | 23.5 M
1 | loss_func  | BCELoss            | 0     
2 | accu_func  | MultilabelAccuracy | 0     
3 | auroc_func | MultilabelAUROC    | 0     
--------------------------------------------------
23.5 M    Trainable params
0         Non-trainable params
23.5 M    Total params
94.130    Total estimated model params size (MB)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No negative samples in targets, false positive value should be meaningless. Returning zero tensor in false positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
/zhome/0f/f/154252/chexpert_env/lib/python3.8/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 24 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
